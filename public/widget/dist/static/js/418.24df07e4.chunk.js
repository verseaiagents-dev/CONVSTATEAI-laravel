/*! For license information please see 418.24df07e4.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkconvstateai_widget=self.webpackChunkconvstateai_widget||[]).push([[418],{418:function(e,n,a){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function r(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,n||"default");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}function s(e,n,a){return(n=r(n))in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function i(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),a.push.apply(a,t)}return a}function o(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?i(Object(a),!0).forEach(function(n){s(e,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))})}return e}function c(e,n,a,t){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}c=function(e,n,a,t){function s(n,a){c(e,n,function(e){return this._invoke(n,a,e)})}n?r?r(e,n,{value:a,enumerable:!t,configurable:!t,writable:!t}):e[n]=a:(s("next",0),s("throw",1),s("return",2))},c(e,n,a,t)}function l(){var e,n,a="function"==typeof Symbol?Symbol:{},t=a.iterator||"@@iterator",r=a.toStringTag||"@@toStringTag";function s(a,t,r,s){var l=t&&t.prototype instanceof o?t:o,d=Object.create(l.prototype);return c(d,"_invoke",function(a,t,r){var s,o,c,l=0,d=r||[],u=!1,m={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,a){return s=n,o=0,c=e,m.n=a,i}};function p(a,t){for(o=a,c=t,n=0;!u&&l&&!r&&n<d.length;n++){var r,s=d[n],p=m.p,h=s[2];a>3?(r=h===t)&&(c=s[(o=s[4])?5:(o=3,3)],s[4]=s[5]=e):s[0]<=p&&((r=a<2&&p<s[1])?(o=0,m.v=t,m.n=s[1]):p<h&&(r=a<3||s[0]>t||t>h)&&(s[4]=a,s[5]=t,m.n=h,o=0))}if(r||a>1)return i;throw u=!0,t}return function(r,d,h){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&p(d,h),o=d,c=h;(n=o<2?e:c)||!u;){s||(o?o<3?(o>1&&(m.n=-1),p(o,c)):m.n=c:m.v=c);try{if(l=2,s){if(o||(r="next"),n=s[r]){if(!(n=n.call(s,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,o<2&&(o=0)}else 1===o&&(n=s.return)&&n.call(s),o<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),o=1);s=e}else if((n=(u=m.n<0)?c:a.call(t,m))!==i)break}catch(n){s=e,o=1,c=n}finally{l=1}}return{value:n,done:u}}}(a,r,s),!0),d}var i={};function o(){}function d(){}function u(){}n=Object.getPrototypeOf;var m=[][t]?n(n([][t]())):(c(n={},t,function(){return this}),n),p=u.prototype=o.prototype=Object.create(m);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,c(e,r,"GeneratorFunction")),e.prototype=Object.create(p),e}return d.prototype=u,c(p,"constructor",u),c(u,"constructor",d),d.displayName="GeneratorFunction",c(u,r,"GeneratorFunction"),c(p),c(p,r,"Generator"),c(p,t,function(){return this}),c(p,"toString",function(){return"[object Generator]"}),(l=function(){return{w:s,m:h}})()}function d(e,n,a,t,r,s,i){try{var o=e[s](i),c=o.value}catch(e){return void a(e)}o.done?n(c):Promise.resolve(c).then(t,r)}function u(e){return function(){var n=this,a=arguments;return new Promise(function(t,r){var s=e.apply(n,a);function i(e){d(s,t,r,i,o,"next",e)}function o(e){d(s,t,r,i,o,"throw",e)}i(void 0)})}}function m(e,n){(null==n||n>e.length)&&(n=e.length);for(var a=0,t=Array(n);a<n;a++)t[a]=e[a];return t}function p(e,n){if(e){if("string"==typeof e)return m(e,n);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?m(e,n):void 0}}function h(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var t,r,s,i,o=[],c=!0,l=!1;try{if(s=(a=a.call(e)).next,0===n){if(Object(a)!==a)return;c=!1}else for(;!(c=(t=s.call(a)).done)&&(o.push(t.value),o.length!==n);c=!0);}catch(e){l=!0,r=e}finally{try{if(!c&&null!=a.return&&(i=a.return(),Object(i)!==i))return}finally{if(l)throw r}}return o}}(e,n)||p(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}a.r(n),a.d(n,{default:function(){return oe}});var f=a(221),v=function(){var e,n="production";return console.log("API Config: Environment detected:",n),console.log("API Config: REACT_APP_ENV:","production"),console.log("API Config: NODE_ENV:","production"),console.log("API Config: REACT_APP_API_BASE_URL:",{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_API_BASE_URL),e="https://convstateai.com",console.log("API Config: Final base URL:",e),{BASE_URL:e,TIMEOUT:parseInt({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_API_TIMEOUT||"10000"),ENDPOINTS:{CHAT:"/api/chat",CAMPAIGNS:"/api/campaigns",FAQS:"/api/faqs",PRODUCTS:"/api/products",WIDGET_CUSTOMIZATION:"/api/widget-customization",FEEDBACK:"/api/feedback",PRODUCT_CLICK:"/api/product-click",CARGO_TRACKING:"/api/cargo-tracking",ADD_TOKEN:"/api/add-token",EXHAUST_TOKEN:"/api/exhaust-token",USAGE:"/api/subscription/usage",PLANS:"/api/subscription/plans",BILLING_HISTORY:"/api/subscription/billing-history"},DEFAULT_AI_NAME:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_DEFAULT_AI_NAME||"ConvState AI",DEFAULT_WELCOME_MESSAGE:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_DEFAULT_WELCOME_MESSAGE||"Merhaba ben Kadir, senin dijital asistan\u0131n\u0131m. Sana nas\u0131l yard\u0131mc\u0131 olabilirim?",SESSION_STORAGE_KEY:"chat_session_id",MAX_PRODUCTS_TO_SHOW:6,PRODUCT_IMAGE_PATH:e+"/imgs/",TYPING_DELAY:1e3,MAX_MESSAGE_LENGTH:1e3,ENABLE_TTS:"true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_ENABLE_TTS,ENABLE_PRODUCT_RECOMMENDATIONS:"true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_ENABLE_PRODUCT_RECOMMENDATIONS,ENABLE_CAMPAIGN_TAB:"true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_ENABLE_CAMPAIGN_TAB,ENABLE_FAQ_TAB:"true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_ENABLE_FAQ_TAB}}(),x=function(e){return v.BASE_URL+e},j=function(e){return v.ENDPOINTS[e]},y=function(e){var n=v.BASE_URL;return"".concat(n,"/imgs/").concat(e)},k=function(){return{small:y("ai-conversion-logo-small.svg"),large:y("ai-conversion-logo.svg")}},b=function(e,n){var a="string"===typeof e?parseFloat(e):e;if(isNaN(a))return"0";var t=n||"TL";if("TL"===t.toUpperCase()||"\u20ba"===t)return"".concat(a,"\u20ba");var r=N(t);return"".concat(r).concat(a)},N=function(e){return{USD:"$",EUR:"\u20ac",GBP:"\xa3",JPY:"\xa5",CAD:"C$",AUD:"A$",CHF:"CHF",CNY:"\xa5",INR:"\u20b9",BRL:"R$",RUB:"\u20bd",KRW:"\u20a9",MXN:"$",SGD:"S$",HKD:"HK$",NOK:"kr",SEK:"kr",DKK:"kr",PLN:"z\u0142",CZK:"K\u010d",HUF:"Ft",TRY:"\u20ba",TL:"\u20ba"}[e.toUpperCase()]||e},_=function(e){return{amount:e.price||e.price_amount||0,currency:e.currency||e.price_currency||"TL"}},w=(a(535),a(97)),S=function(e){var n,a,t,r,s=e.message,i=e.onProductClick,o=e.onFeedback,c=e.onAddMessage,d=e.onSendMessage,m=s.products||(null===(n=s.data)||void 0===n?void 0:n.products)||[],p=g((0,f.useState)(!1),2),h=p[0],j=p[1],y=(0,f.useRef)(null);(0,f.useEffect)(function(){var e="feedback_".concat(s.id);localStorage.getItem(e)&&j(!0)},[s.id]),(0,f.useEffect)(function(){var e=y.current;e&&(e.style.overflowX="auto",e.style.overflowY="hidden")},[m.length]);var k=function(){var e=u(l().m(function e(n,a){var t,r,s,i,o;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,t=localStorage.getItem("chat_session_id")||"unknown",e.n=1,fetch(x("/api/product-interaction"),{method:"POST",headers:{"Content-Type":"application/json","X-IP-Based-Session":"true"},body:JSON.stringify({session_id:t,browser_uuid:t,product_id:n.id,action:a,timestamp:(new Date).toISOString(),source:"chat_widget",metadata:{product_name:n.name,product_category:n.category,product_brand:n.brand,action_source:"chat_widget"}})});case 1:if(!(r=e.v).ok){e.n=3;break}return e.n=2,r.json();case 2:(s=e.v).message&&c&&(i=s.isDevelopment?"development":"general",c(s.message,"agent",[n],{type:i,isDevelopment:s.isDevelopment,action:s.action,product:n})),"view"===a?c&&c("\ud83d\udce6 **".concat(n.name,"** \xfcr\xfcn detaylar\u0131 y\xfckleniyor..."),"agent",[n],{type:"product_detail",product:n,action:"view",widget:"ProductDetailMessage"}):"compare"===a&&c&&N(n,c),e.n=5;break;case 3:return e.n=4,r.json();case 4:(o=e.v).show_notification&&o.message||o.message?c&&c(o.message,"agent",[n]):c&&c("Bir hata olu\u015ftu. L\xfctfen tekrar deneyin.","agent",[n]);case 5:e.n=7;break;case 6:e.p=6,e.v;case 7:return e.a(2)}},e,null,[[0,6]])}));return function(n,a){return e.apply(this,arguments)}}(),N=function(){var e=u(l().m(function e(n,a){var t,r,s,i,o;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,t=localStorage.getItem("chat_session_id")||"unknown",e.n=1,fetch(x("/api/price-comparison"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:t,product_id:n.id,product_name:n.name,product_price:n.price,product_category:n.category,comparison_type:"similar_products"})});case 1:if(!(r=e.v).ok){e.n=3;break}return e.n=2,r.json();case 2:(s=e.v).success?a("\ud83d\udcb0 Fiyat Kar\u015f\u0131la\u015ft\u0131rmas\u0131: ".concat(n.name),"agent",void 0,{type:"price_comparison_result",action:"price_comparison_result",product:n,data:s.data}):a("\u274c Fiyat kar\u015f\u0131la\u015ft\u0131rmas\u0131 yap\u0131lamad\u0131: ".concat(s.message),"agent"),e.n=4;break;case 3:i="",i=500===r.status?"Sunucu hatas\u0131 olu\u015ftu. L\xfctfen daha sonra tekrar deneyin.":404===r.status?"Fiyat kar\u015f\u0131la\u015ft\u0131rmas\u0131 servisi bulunamad\u0131.":429===r.status?"\xc7ok fazla istek g\xf6nderildi. L\xfctfen bekleyin.":"Sunucu hatas\u0131 (".concat(r.status,"). L\xfctfen daha sonra tekrar deneyin."),a("\u274c Fiyat kar\u015f\u0131la\u015ft\u0131rmas\u0131 hatas\u0131: ".concat(i),"agent");case 4:e.n=6;break;case 5:e.p=5,o=e.v,console.error("Price comparison error:",o),a("\u274c Fiyat kar\u015f\u0131la\u015ft\u0131rmas\u0131 yap\u0131l\u0131rken bir hata olu\u015ftu.","agent");case 6:return e.a(2)}},e,null,[[0,5]])}));return function(n,a){return e.apply(this,arguments)}}(),S=function(e){var n="feedback_".concat(s.id);localStorage.setItem(n,JSON.stringify({isHelpful:e,timestamp:(new Date).toISOString()})),j(!0),o({messageId:s.id,isHelpful:e,comment:""})};return(0,w.jsxs)("div",{className:"message agent-message",children:[(0,w.jsxs)("div",{className:"message-content-wrapper",children:[(0,w.jsx)("h4",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"8px"},children:(null===(a=s.data)||void 0===a?void 0:a.title)||"Senin i\xe7in \xf6nerdi\u011fim \xfcr\xfcnler:"}),m&&m.length>0?(0,w.jsx)("div",{className:"products-scroll-container",ref:y,children:(0,w.jsx)("div",{className:"products-wrapper",children:m.map(function(e,n){return(0,w.jsxs)("div",{className:"product-card",children:[(0,w.jsx)("div",{className:"product-image",children:(0,w.jsx)("img",{src:e.image||v.PRODUCT_IMAGE_PATH+"default-product.svg",alt:e.name,onError:function(e){var n=e.currentTarget.src;n.includes("default-product.svg")?e.currentTarget.src=v.PRODUCT_IMAGE_PATH+"default-product.jpg":n.includes("default-product.jpg")&&(e.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjkwIiB2aWV3Qm94PSIwIDAgMTUwIDkwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxNTAiIGhlaWdodD0iOTAiIGZpbGw9IiNmM2Y0ZjYiLz48dGV4dCB4PSI3NSIgeT0iNDUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5YTNhZiIgdGV4dC1hbmNob3I9Im1pZGRsZSI+5Yqg6L295LitLi4uPC90ZXh0Pjwvc3ZnPg=="),e.currentTarget.onerror=null}})}),(0,w.jsxs)("div",{className:"product-info",children:[(0,w.jsx)("h4",{children:e.name}),(0,w.jsx)("p",{className:"product-category",children:e.brand||"Bilinmeyen"}),(0,w.jsx)("p",{className:"product-price",children:b(_(e).amount,_(e).currency)}),(0,w.jsxs)("div",{className:"product-rating",children:[(0,w.jsx)("span",{className:"product-rating-label",children:"Rating:"}),(0,w.jsxs)("span",{className:"product-rating-value",children:["\u2605 ",e.rating||"4"]})]}),(0,w.jsxs)("div",{className:"product-buttons-container",children:[(0,w.jsx)("button",{className:"product-button primary",onClick:function(n){n.stopPropagation(),null===i||void 0===i||i(e)},children:"Detaylar"}),(0,w.jsx)("button",{className:"product-button secondary",onClick:function(n){n.stopPropagation(),k(e,"compare")},children:"Kar\u015f\u0131la\u015ft\u0131r"})]})]})]},"".concat(e.id,"-").concat(n))})})}):(0,w.jsxs)("div",{className:"no-products-message",children:[(0,w.jsx)("div",{className:"no-products-icon",children:"\ud83d\udd0d"}),(0,w.jsx)("p",{children:s.content||"\xdcr\xfcn bulunamad\u0131."}),(null===(t=s.data)||void 0===t?void 0:t.suggestions)&&s.data.suggestions.length>0&&(0,w.jsxs)("div",{className:"suggestions",children:[(0,w.jsx)("p",{className:"suggestions-title",children:"Size \u015funlar\u0131 \xf6nerebilirim:"}),(0,w.jsx)("div",{className:"suggestion-buttons",children:s.data.suggestions.map(function(e,n){return(0,w.jsx)("button",{className:"suggestion-button",onClick:function(){var n="".concat(e," \xf6ner");d?d(n):c&&c(n,"user")},children:e},n)})})]})]}),m.length>0&&(0,w.jsxs)("div",{className:"ai-note",children:[(0,w.jsx)("span",{className:"ai-icon",children:"AI"}),(null===(r=s.data)||void 0===r?void 0:r.ai_note)||"Tercihlerinize g\xf6re \xf6nerilen \xfcr\xfcnler."]})]}),!h&&(0,w.jsxs)("div",{className:"feedback-container",children:[(0,w.jsx)("button",{className:"feedback-button",onClick:function(){return S(!0)},children:"\ud83d\udc4d Yararl\u0131"}),(0,w.jsx)("button",{className:"feedback-button negative",onClick:function(){return S(!1)},children:"\ud83d\udc4e Yarars\u0131z"})]}),h&&(0,w.jsx)("div",{className:"feedback-thanks",children:(0,w.jsx)("span",{style:{fontSize:"12px",color:"#10B981",fontStyle:"italic"},children:"\u2713 Feedback'iniz i\xe7in te\u015fekk\xfcrler!"})})]})},C=function(e){var n,a,t=e.message,r=(e.onProductClick,e.onAddMessage,g((0,f.useState)(!1),2)),s=r[0],i=r[1],o=g((0,f.useState)(null),2),c=o[0],d=o[1],m=g((0,f.useState)(null),2),p=m[0],h=m[1],v=(null===(n=t.data)||void 0===n?void 0:n.product)||(null===(a=t.products)||void 0===a?void 0:a[0]);(0,f.useEffect)(function(){v&&!c&&j()},[v]);var j=function(){var e=u(l().m(function e(){var n,a,t,r,s;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(v){e.n=1;break}return e.a(2);case 1:return i(!0),h(null),e.p=2,n=localStorage.getItem("chat_session_id")||"unknown",e.n=3,fetch(x("/api/product-details"),{method:"POST",headers:{"Content-Type":"application/json","X-IP-Based-Session":"true"},body:JSON.stringify({session_id:n,browser_uuid:n,product_id:v.id,product_name:v.name,product_description:v.description,product_price:v.price,product_category:v.category,action:"get_details"})});case 3:if((a=e.v).ok){e.n=7;break}if(404!==a.status){e.n=4;break}throw new Error("\xdcr\xfcn detaylar\u0131 bulunamad\u0131. L\xfctfen daha sonra tekrar deneyin.");case 4:if(429!==a.status){e.n=5;break}throw new Error("G\xfcnl\xfck g\xf6r\xfcnt\xfcleme limitiniz doldu. Yar\u0131n tekrar deneyin.");case 5:if(500!==a.status){e.n=6;break}throw new Error("Sunucu hatas\u0131 olu\u015ftu. L\xfctfen daha sonra tekrar deneyin.");case 6:throw new Error("Sunucu hatas\u0131 (".concat(a.status,"). L\xfctfen daha sonra tekrar deneyin."));case 7:return e.n=8,a.json();case 8:if(!(t=e.v).success){e.n=9;break}d(t.data),e.n=12;break;case 9:if("Session not found"!==t.message){e.n=10;break}throw new Error("Oturum bulunamad\u0131. L\xfctfen sayfay\u0131 yenileyin.");case 10:if("Daily view limit reached"!==t.message){e.n=11;break}throw new Error("G\xfcnl\xfck g\xf6r\xfcnt\xfcleme limitiniz doldu. Yar\u0131n tekrar deneyin.");case 11:throw new Error(t.message||"\xdcr\xfcn detaylar\u0131 y\xfcklenirken bir hata olu\u015ftu.");case 12:e.n=14;break;case 13:e.p=13,s=e.v,console.error("Error fetching product details:",s),r="\xdcr\xfcn detaylar\u0131 y\xfcklenirken bir hata olu\u015ftu.",s instanceof Error&&(r=s.message.includes("Failed to fetch")||s.message.includes("NetworkError")?"\u0130nternet ba\u011flant\u0131n\u0131z\u0131 kontrol edin ve tekrar deneyin.":s.message.includes("timeout")?"\u0130stek zaman a\u015f\u0131m\u0131na u\u011frad\u0131. L\xfctfen tekrar deneyin.":s.message),h(r);case 14:return e.p=14,i(!1),e.f(14);case 15:return e.a(2)}},e,null,[[2,13,14,15]])}));return function(){return e.apply(this,arguments)}}();if(s)return(0,w.jsx)("div",{className:"product-detail-message",children:(0,w.jsxs)("div",{className:"product-detail-loading",children:[(0,w.jsx)("div",{className:"loading-spinner"}),(0,w.jsx)("p",{children:"\xdcr\xfcn detaylar\u0131 y\xfckleniyor..."})]})});if(p)return(0,w.jsx)("div",{className:"product-detail-message",children:(0,w.jsxs)("div",{className:"product-detail-error",children:[(0,w.jsx)("div",{className:"error-icon",children:(0,w.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,w.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"#ef4444",strokeWidth:"2"}),(0,w.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15",stroke:"#ef4444",strokeWidth:"2"}),(0,w.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15",stroke:"#ef4444",strokeWidth:"2"})]})}),(0,w.jsxs)("div",{className:"error-content",children:[(0,w.jsx)("h4",{children:"\xdcr\xfcn Detaylar\u0131 Y\xfcklenemedi"}),(0,w.jsx)("p",{children:p}),(0,w.jsxs)("div",{className:"error-actions",children:[(0,w.jsxs)("button",{onClick:j,className:"retry-button",children:[(0,w.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,w.jsx)("path",{d:"M1 4v6h6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,w.jsx)("path",{d:"M23 20v-6h-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,w.jsx)("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Tekrar Dene"]}),(0,w.jsxs)("button",{onClick:function(){return h(null)},className:"dismiss-button",children:[(0,w.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,w.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,w.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Kapat"]})]})]})]})});if(!v)return(0,w.jsx)("div",{className:"product-detail-message",children:(0,w.jsxs)("div",{className:"product-detail-error warning",children:[(0,w.jsx)("div",{className:"error-icon",children:(0,w.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,w.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"#f59e0b",strokeWidth:"2"}),(0,w.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12",stroke:"#f59e0b",strokeWidth:"2",strokeLinecap:"round"}),(0,w.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16",stroke:"#f59e0b",strokeWidth:"2",strokeLinecap:"round"})]})}),(0,w.jsxs)("div",{className:"error-content",children:[(0,w.jsx)("h4",{children:"\xdcr\xfcn Bilgisi Bulunamad\u0131"}),(0,w.jsx)("p",{children:"Bu \xfcr\xfcn i\xe7in detay bilgisi mevcut de\u011fil. L\xfctfen farkl\u0131 bir \xfcr\xfcn se\xe7in."})]})]})});var y=c||{};return(0,w.jsx)("div",{className:"product-detail-message",children:(0,w.jsxs)("div",{className:"product-detail-container",children:[(0,w.jsxs)("div",{className:"product-detail-header",children:[(0,w.jsx)("div",{className:"product-detail-image",children:(0,w.jsx)("img",{src:v.image||"/imgs/default-product.svg",alt:v.name,onError:function(e){e.currentTarget.src="/imgs/default-product.svg"}})}),(0,w.jsxs)("div",{className:"product-detail-info",children:[(0,w.jsx)("h3",{className:"product-detail-title",children:v.name}),(0,w.jsx)("div",{className:"product-detail-price",children:v.price&&(0,w.jsx)("span",{className:"price",children:b(_(v).amount,_(v).currency)})})]})]}),y.ai_description&&(0,w.jsxs)("div",{className:"product-detail-ai-content",children:[(0,w.jsxs)("div",{className:"ai-header",children:[(0,w.jsx)("img",{src:"http://127.0.0.1:8000/imgs/ai-conversion-logo.svg",alt:"ConvState AI",className:"ai-logo"}),(0,w.jsx)("h4",{children:"ConvState AI Analizi"})]}),(0,w.jsx)("div",{className:"ai-description",children:y.ai_description})]}),y.features&&y.features.length>0&&(0,w.jsxs)("div",{className:"product-detail-features",children:[(0,w.jsx)("h4",{children:"\u2728 \xd6zellikler"}),(0,w.jsx)("ul",{className:"features-list",children:y.features.map(function(e,n){return(0,w.jsx)("li",{children:e},n)})})]}),y.usage_scenarios&&y.usage_scenarios.length>0&&(0,w.jsxs)("div",{className:"product-detail-usage",children:[(0,w.jsx)("h4",{children:"\ud83c\udfaf Kullan\u0131m Alanlar\u0131"}),(0,w.jsx)("ul",{className:"usage-list",children:y.usage_scenarios.map(function(e,n){return(0,w.jsx)("li",{children:e},n)})})]}),y.specifications&&Object.keys(y.specifications).length>0&&(0,w.jsxs)("div",{className:"product-detail-specs",children:[(0,w.jsx)("h4",{children:"\u2699\ufe0f Teknik \xd6zellikler"}),(0,w.jsx)("div",{className:"specs-grid",children:Object.entries(y.specifications).map(function(e){var n=g(e,2),a=n[0],t=n[1];return(0,w.jsxs)("div",{className:"spec-item",children:[(0,w.jsxs)("span",{className:"spec-key",children:[a,":"]}),(0,w.jsx)("span",{className:"spec-value",children:t})]},a)})})]}),y.recommendations&&y.recommendations.length>0&&(0,w.jsxs)("div",{className:"product-detail-recommendations",children:[(0,w.jsx)("h4",{children:"\ud83d\udca1 \xd6neriler"}),(0,w.jsx)("ul",{className:"recommendations-list",children:y.recommendations.map(function(e,n){return(0,w.jsx)("li",{children:e},n)})})]})]})})},E=function(e){var n,a=e.message,t=e.onProductClick,r=(null===(n=a.data)||void 0===n?void 0:n.comparison_data)||a.data;if(!r)return(0,w.jsx)("div",{className:"price-comparison-message",children:(0,w.jsxs)("div",{className:"comparison-container error-state",children:[(0,w.jsxs)("div",{className:"comparison-header",children:[(0,w.jsx)("h3",{children:"En \u0130yi \xdcr\xfcn Kar\u015f\u0131la\u015ft\u0131rmas\u0131"}),(0,w.jsx)("div",{className:"error-badge",children:(0,w.jsx)("span",{children:"Hata"})})]}),(0,w.jsxs)("div",{className:"error-content",children:[(0,w.jsx)("div",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,w.jsxs)("div",{className:"error-details",children:[(0,w.jsx)("h4",{children:"Veri Y\xfcklenemedi"}),(0,w.jsx)("p",{children:"Fiyat kar\u015f\u0131la\u015ft\u0131rmas\u0131 yap\u0131l\u0131rken bir hata olu\u015ftu. L\xfctfen daha sonra tekrar deneyin."}),(0,w.jsx)("div",{className:"error-actions",children:(0,w.jsx)("button",{className:"retry-button",onClick:function(){return window.location.reload()},children:"\ud83d\udd04 Tekrar Dene"})})]})]})]})});var s=r.main_product,i=r.similar_products,o=r.price_analysis,c=r.ai_comparison,l=r.comparison_summary;if(!s||!s.name||!s.price)return(0,w.jsx)("div",{className:"price-comparison-message",children:(0,w.jsxs)("div",{className:"comparison-container default-data",children:[(0,w.jsxs)("div",{className:"comparison-header",children:[(0,w.jsx)("h3",{children:"En \u0130yi \xdcr\xfcn Kar\u015f\u0131la\u015ft\u0131rmas\u0131"}),(0,w.jsx)("div",{className:"default-badge",children:(0,w.jsx)("span",{children:"Varsay\u0131lan Veri"})})]}),(0,w.jsxs)("div",{className:"default-content",children:[(0,w.jsx)("div",{className:"default-icon",children:"\ud83d\udcca"}),(0,w.jsxs)("div",{className:"default-details",children:[(0,w.jsx)("h4",{children:"\xd6rnek Fiyat Kar\u015f\u0131la\u015ft\u0131rmas\u0131"}),(0,w.jsx)("p",{children:"Ger\xe7ek \xfcr\xfcn verisi bulunamad\u0131\u011f\u0131 i\xe7in \xf6rnek bir kar\u015f\u0131la\u015ft\u0131rma g\xf6steriyoruz."}),(0,w.jsxs)("div",{className:"sample-comparison",children:[(0,w.jsx)("div",{className:"sample-product",children:(0,w.jsxs)("div",{className:"product-info",children:[(0,w.jsx)("h5",{children:"\xd6rnek \xdcr\xfcn"}),(0,w.jsxs)("div",{className:"price-info",children:[(0,w.jsx)("span",{className:"price",children:"299.99"}),(0,w.jsx)("span",{className:"currency",children:"\u20ba"})]}),(0,w.jsx)("div",{className:"category",children:"Elektronik"})]})}),(0,w.jsxs)("div",{className:"sample-analysis",children:[(0,w.jsxs)("div",{className:"analysis-item",children:[(0,w.jsx)("span",{className:"label",children:"Fiyat Pozisyonu:"}),(0,w.jsx)("span",{className:"value",children:"Ortalama"})]}),(0,w.jsxs)("div",{className:"analysis-item",children:[(0,w.jsx)("span",{className:"label",children:"De\u011ferlendirme:"}),(0,w.jsx)("span",{className:"value good",children:"\u0130yi De\u011fer"})]})]})]})]})]})]})});if(!i||0===i.length)return(0,w.jsx)("div",{className:"price-comparison-message",children:(0,w.jsxs)("div",{className:"comparison-container no-data",children:[(0,w.jsxs)("div",{className:"comparison-header",children:[(0,w.jsx)("h3",{children:"En \u0130yi \xdcr\xfcn Kar\u015f\u0131la\u015ft\u0131rmas\u0131"}),(0,w.jsx)("div",{className:"no-data-badge",children:(0,w.jsx)("span",{children:"Veri Bulunamad\u0131"})})]}),(0,w.jsxs)("div",{className:"main-product-only",children:[(0,w.jsxs)("div",{className:"product-card main",children:[(0,w.jsx)("div",{className:"product-image",children:(0,w.jsx)("img",{src:"/imgs/default-product.svg",alt:s.name,onError:function(e){e.currentTarget.src="/imgs/default-product.svg"}})}),(0,w.jsxs)("div",{className:"product-details",children:[(0,w.jsx)("h4",{children:s.name}),(0,w.jsxs)("div",{className:"price-info",children:[(0,w.jsx)("span",{className:"price",children:s.price}),(0,w.jsx)("span",{className:"currency",children:"\u20ba"})]}),(0,w.jsx)("div",{className:"category",children:s.category})]})]}),(0,w.jsxs)("div",{className:"no-comparison-info",children:[(0,w.jsx)("div",{className:"info-icon",children:"\u2139\ufe0f"}),(0,w.jsxs)("div",{className:"info-content",children:[(0,w.jsx)("h4",{children:"Kar\u015f\u0131la\u015ft\u0131rma Yap\u0131lamad\u0131"}),(0,w.jsx)("p",{children:"Bu \xfcr\xfcn i\xe7in benzer \xfcr\xfcnler bulunamad\u0131. Fiyat kar\u015f\u0131la\u015ft\u0131rmas\u0131 yapabilmek i\xe7in daha fazla \xfcr\xfcn verisi gereklidir."})]})]}),c&&c.analysis&&(0,w.jsxs)("div",{className:"ai-suggestion",children:[(0,w.jsxs)("div",{className:"ai-header",children:[(0,w.jsx)("img",{src:"/imgs/ai-conversion-logo.svg",alt:"AI",className:"ai-logo"}),(0,w.jsx)("span",{children:"ConvStateAI Analizi"})]}),(0,w.jsx)("div",{className:"ai-content",children:(0,w.jsx)("p",{children:c.analysis})})]})]})]})});return(0,w.jsx)("div",{className:"price-comparison-message",children:(0,w.jsxs)("div",{className:"comparison-container",children:[(0,w.jsxs)("div",{className:"comparison-header",children:[(0,w.jsx)("h3",{children:"En \u0130yi \xdcr\xfcn Kar\u015f\u0131la\u015ft\u0131rmas\u0131"}),(0,w.jsxs)("div",{className:"comparison-summary",children:[(0,w.jsxs)("span",{className:"total-products",children:[l.total_products_compared," \xfcr\xfcn kar\u015f\u0131la\u015ft\u0131r\u0131ld\u0131"]}),(0,w.jsxs)("span",{className:"price-position",children:[function(e){switch(e){case"lowest":return"\ud83d\udfe2";case"highest":return"\ud83d\udd34";case"below_average":return"\ud83d\udfe1";case"above_average":return"\ud83d\udfe0";default:return"\u26aa"}}(o.price_position)," ",l.price_position]})]})]}),(0,w.jsxs)("div",{className:"main-product-section",children:[(0,w.jsx)("h4",{children:"\ud83c\udfaf Ana \xdcr\xfcn"}),(0,w.jsx)("div",{className:"main-product-card",children:(0,w.jsxs)("div",{className:"product-info",children:[(0,w.jsx)("h5",{children:s.name}),(0,w.jsx)("div",{className:"price-info",children:b(_(s).amount,_(s).currency)}),(0,w.jsx)("div",{className:"price-rating",children:(0,w.jsx)("span",{className:"rating-badge",style:{backgroundColor:function(e){switch(e){case"excellent":return"#10b981";case"good":return"#3b82f6";case"fair":return"#f59e0b";case"expensive":return"#ef4444";default:return"#6b7280"}}(o.price_rating)},children:function(e){switch(e){case"excellent":return"M\xfckemmel";case"good":return"\u0130yi";case"fair":return"Orta";case"expensive":return"Pahal\u0131";default:return"Bilinmiyor"}}(o.price_rating)})})]})})]}),(0,w.jsxs)("div",{className:"price-analysis-section",children:[(0,w.jsx)("h4",{children:"\ud83d\udcca Fiyat Analizi"}),(0,w.jsxs)("div",{className:"analysis-grid",children:[(0,w.jsxs)("div",{className:"analysis-item",children:[(0,w.jsx)("span",{className:"label",children:"Ortalama Fiyat:"}),(0,w.jsx)("span",{className:"value",children:b(o.average_price,"TL")})]}),(0,w.jsxs)("div",{className:"analysis-item",children:[(0,w.jsx)("span",{className:"label",children:"En D\xfc\u015f\xfck:"}),(0,w.jsx)("span",{className:"value",children:b(o.min_price,"TL")})]}),(0,w.jsxs)("div",{className:"analysis-item",children:[(0,w.jsx)("span",{className:"label",children:"En Y\xfcksek:"}),(0,w.jsx)("span",{className:"value",children:b(o.max_price,"TL")})]}),(0,w.jsxs)("div",{className:"analysis-item",children:[(0,w.jsx)("span",{className:"label",children:"Fark:"}),(0,w.jsxs)("span",{className:"value ".concat(o.price_difference>=0?"positive":"negative"),children:[o.price_difference>=0?"+":"",b(o.price_difference,"TL")]})]})]})]}),i&&i.length>0&&(0,w.jsxs)("div",{className:"similar-products-section",children:[(0,w.jsx)("h4",{children:"\ud83d\udd04 Benzer \xdcr\xfcnler"}),(0,w.jsx)("div",{className:"products-grid",children:i.map(function(e,n){var a,r;return(0,w.jsxs)("div",{className:"product-card",onClick:function(){return null===t||void 0===t?void 0:t(e)},children:[(0,w.jsx)("div",{className:"product-image",children:(0,w.jsx)("img",{src:e.image||"/imgs/default-product.svg",alt:e.name,onError:function(e){e.currentTarget.src="/imgs/default-product.svg"}})}),(0,w.jsxs)("div",{className:"product-details",children:[(0,w.jsx)("h6",{children:e.name}),(0,w.jsx)("p",{className:"product-category",children:e.brand||"Bilinmeyen"}),(0,w.jsx)("div",{className:"product-price",children:b(_(e).amount,_(e).currency)}),(0,w.jsxs)("div",{className:"product-rating",children:[(0,w.jsx)("span",{className:"product-rating-label",children:"Rating:"}),(0,w.jsxs)("span",{className:"product-rating-value",children:["\u2605 ","object"===typeof e.rating?(null===(a=e.rating)||void 0===a?void 0:a.rate)||(null===(r=e.rating)||void 0===r?void 0:r.count)||"4":e.rating||"4"]})]}),(0,w.jsxs)("div",{className:"product-buttons-container",children:[(0,w.jsx)("button",{className:"product-button primary",onClick:function(n){n.stopPropagation(),null===t||void 0===t||t(e)},children:"Detaylar"}),(0,w.jsx)("button",{className:"product-button secondary",onClick:function(e){e.stopPropagation()},children:"Kar\u015f\u0131la\u015ft\u0131r"})]})]})]},n)})})]}),c&&(0,w.jsxs)("div",{className:"ai-analysis-section",children:[(0,w.jsx)("h4",{children:"\ud83e\udd16 ConvState Analizi"}),(0,w.jsxs)("div",{className:"ai-content",children:[(0,w.jsx)("div",{className:"ai-analysis",children:(0,w.jsx)("p",{children:c.analysis})}),(0,w.jsxs)("div",{className:"ai-recommendation",children:[(0,w.jsx)("strong",{children:"\ud83d\udca1 \xd6neri:"})," ",c.recommendation]})]})]}),l.best_value_product&&(0,w.jsxs)("div",{className:"best-value-section",children:[(0,w.jsx)("h4",{children:"\ud83c\udfc6 Platform \xd6nerisi"}),(0,w.jsx)("div",{className:"best-value-card",children:(0,w.jsxs)("div",{className:"product-info",children:[(0,w.jsx)("h5",{children:l.best_value_product.name}),(0,w.jsxs)("div",{className:"price-info",children:[(0,w.jsx)("span",{className:"price",children:l.best_value_product.price}),(0,w.jsx)("span",{className:"currency",children:"\u20ba"})]}),(0,w.jsx)("div",{className:"value-badge",children:"\ud83c\udfc6 En \u0130yi De\u011fer"})]})})]})]})})},T=function(e){var n=e.message,a=e.onFeedback,t=function(e){a({messageId:n.id,isHelpful:e,comment:""})};return(0,w.jsxs)("div",{className:"message agent-message",children:[(0,w.jsx)("div",{className:"message-content-wrapper",children:(0,w.jsx)("p",{children:n.content||n.message||"Feedback mesaj\u0131 bulunamad\u0131."})}),(0,w.jsxs)("div",{className:"feedback-container",children:[(0,w.jsx)("button",{className:"feedback-button",onClick:function(){return t(!0)},children:"\ud83d\udc4d Evet, yard\u0131mc\u0131 oldu"}),(0,w.jsx)("button",{className:"feedback-button negative",onClick:function(){return t(!1)},children:"\ud83d\udc4e Hay\u0131r, yard\u0131mc\u0131 olmad\u0131"})]})]})},A=function(e){var n=e.message,a=e.onFeedback,t=function(e){a({messageId:n.id,isHelpful:e,comment:""})};return(0,w.jsxs)("div",{className:"message agent-message",children:[(0,w.jsx)("div",{className:"message-content-wrapper",children:(0,w.jsx)("p",{children:n.content||n.message||"Mesaj i\xe7eri\u011fi bulunamad\u0131."})}),(0,w.jsxs)("div",{className:"feedback-container",children:[(0,w.jsx)("button",{className:"feedback-button",onClick:function(){return t(!0)},children:"\ud83d\udc4d Yararl\u0131"}),(0,w.jsx)("button",{className:"feedback-button negative",onClick:function(){return t(!1)},children:"\ud83d\udc4e Yarars\u0131z"})]})]})},I=function(e){var n=e.message,a=e.onFeedback,t=g((0,f.useState)(""),2),r=t[0],s=t[1],i=g((0,f.useState)(!1),2),o=i[0],c=i[1],d=g((0,f.useState)(!1),2),m=d[0],p=d[1],h=g((0,f.useState)(null),2),v=h[0],j=h[1],y=g((0,f.useState)(null),2),k=y[0],b=y[1],N=function(e){a({messageId:n.id,isHelpful:e,comment:""})},_=function(){var e=u(l().m(function e(){var n,a,t,s,i,o,d;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!r.trim()){e.n=8;break}if(e.p=1,a=window.widgetConfig,t=null===a||void 0===a||null===(n=a.apiEndpoints)||void 0===n?void 0:n.orderTracking,s=null===a||void 0===a?void 0:a.isOrderEnabled,t&&s){e.n=2;break}return j({order_id:r,status:"feature_disabled",order_date:(new Date).toISOString(),items:[],shipping:{courier:"N/A",tracking_number:"N/A",last_update:"N/A",location:"N/A",estimated_delivery:"N/A"},message:"Bu \xf6zellik yak\u0131nda a\xe7\u0131lacak"}),c(!0),e.a(2);case 2:return e.n=3,fetch(x("/api/cargo/track/".concat(encodeURIComponent(r))),{method:"GET",headers:{"Content-Type":"application/json"}});case 3:if(!(i=e.v).ok){e.n=5;break}return e.n=4,i.json();case 4:(d=e.v).success&&d.data?(b(d.data),p(!0)):null!==(o=d.data)&&void 0!==o&&o.feature_disabled?(j({order_id:r,status:"feature_disabled",order_date:(new Date).toISOString(),items:[],shipping:{courier:"N/A",tracking_number:"N/A",last_update:"N/A",location:"N/A",estimated_delivery:"N/A"},message:"Bu \xf6zellik yak\u0131nda a\xe7\u0131lacak"}),c(!0)):(j({order_id:r,status:"not_found",order_date:(new Date).toISOString(),items:[],shipping:{courier:"N/A",tracking_number:r,last_update:"N/A",location:"N/A",estimated_delivery:"N/A"},message:"Kargo numaras\u0131 ile kargo bulunamad\u0131"}),c(!0)),e.n=6;break;case 5:j({order_id:r,status:"error",order_date:(new Date).toISOString(),items:[],shipping:{courier:"N/A",tracking_number:r,last_update:"N/A",location:"N/A",estimated_delivery:"N/A"},message:"Kargo takip s\u0131ras\u0131nda hata olu\u015ftu"}),c(!0);case 6:e.n=8;break;case 7:e.p=7,e.v,j({order_id:r,status:"error",order_date:(new Date).toISOString(),items:[],shipping:{courier:"N/A",tracking_number:r,last_update:"N/A",location:"N/A",estimated_delivery:"N/A"},message:"Ba\u011flant\u0131 hatas\u0131 olu\u015ftu"}),c(!0);case 8:return e.a(2)}},e,null,[[1,7]])}));return function(){return e.apply(this,arguments)}}(),S=function(e){return new Date(e).toLocaleDateString("tr-TR")},C=function(e){return new Date(e).toLocaleString("tr-TR")};if("order_tracking"===n.intent&&!o&&!m)return(0,w.jsxs)("div",{className:"message agent-message",children:[(0,w.jsxs)("div",{className:"message-content-wrapper",children:[(0,w.jsx)("p",{children:"Kargo takip numaran\u0131z\u0131 veya sipari\u015f numaran\u0131z\u0131 girin:"}),(0,w.jsxs)("div",{className:"order-input-container",children:[(0,w.jsx)("input",{type:"text",placeholder:"Sipari\u015f/Kargo numaras\u0131 girin...",value:r,onChange:function(e){return s(e.target.value)},className:"order-number-input"}),(0,w.jsx)("button",{onClick:_,className:"track-order-button",disabled:!r.trim(),children:"Takip Et"})]})]}),(0,w.jsxs)("div",{className:"feedback-container",children:[(0,w.jsx)("button",{className:"feedback-button",onClick:function(){return N(!0)},children:"\ud83d\udc4d Yararl\u0131"}),(0,w.jsx)("button",{className:"feedback-button negative",onClick:function(){return N(!1)},children:"\ud83d\udc4e Yarars\u0131z"})]})]});if(m&&k){var E="in_transit"===k.status?"Yolda":"delivered"===k.status?"Teslim Edildi":"pending"===k.status?"Haz\u0131rlan\u0131yor":k.status;return(0,w.jsxs)("div",{className:"message agent-message",children:[(0,w.jsx)("div",{className:"message-content-wrapper",children:(0,w.jsxs)("div",{className:"cargo-tracking-simple",children:[(0,w.jsx)("h3",{children:"Kargo Takip Bilgileri"}),(0,w.jsxs)("div",{className:"cargo-info-grid",children:[(0,w.jsxs)("div",{className:"cargo-info-item",children:[(0,w.jsx)("strong",{children:"Sipari\u015f No:"}),(0,w.jsx)("span",{children:k.order_id})]}),(0,w.jsxs)("div",{className:"cargo-info-item",children:[(0,w.jsx)("strong",{children:"Durum:"}),(0,w.jsx)("span",{className:"status-badge ".concat(k.status),children:E})]}),(0,w.jsxs)("div",{className:"cargo-info-item",children:[(0,w.jsx)("strong",{children:"Kargo Firmas\u0131:"}),(0,w.jsx)("span",{children:k.courier})]}),(0,w.jsxs)("div",{className:"cargo-info-item",children:[(0,w.jsx)("strong",{children:"Takip Numaras\u0131:"}),(0,w.jsx)("span",{className:"tracking-number",children:k.tracking_number})]}),(0,w.jsxs)("div",{className:"cargo-info-item",children:[(0,w.jsx)("strong",{children:"Son G\xfcncelleme:"}),(0,w.jsx)("span",{children:C(k.last_update)})]}),(0,w.jsxs)("div",{className:"cargo-info-item",children:[(0,w.jsx)("strong",{children:"Tahmini Teslim:"}),(0,w.jsx)("span",{children:S(k.estimated_delivery)})]})]})]})}),(0,w.jsxs)("div",{className:"feedback-container",children:[(0,w.jsx)("button",{className:"feedback-button",onClick:function(){return N(!0)},children:"\ud83d\udc4d Yararl\u0131"}),(0,w.jsx)("button",{className:"feedback-button negative",onClick:function(){return N(!1)},children:"\ud83d\udc4e Yarars\u0131z"})]})]})}return o&&v?(0,w.jsxs)("div",{className:"message agent-message",children:[(0,w.jsx)("div",{className:"message-content-wrapper",children:(0,w.jsx)("div",{className:"order-tracking-details",children:"feature_disabled"===v.status?(0,w.jsxs)("div",{className:"feature-disabled-message",children:[(0,w.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px",textAlign:"center"},children:"\ud83d\udea7"}),(0,w.jsx)("h3",{style:{textAlign:"center",color:"#92400E",marginBottom:"16px"},children:"Bu \xf6zellik yak\u0131nda a\xe7\u0131lacak"}),(0,w.jsx)("p",{style:{textAlign:"center",color:"#92400E",fontSize:"14px",margin:0},children:"Sipari\u015f takip \xf6zelli\u011fi geli\u015ftirme a\u015famas\u0131nda"})]}):"not_found"===v.status?(0,w.jsxs)("div",{className:"cargo-not-found-message",children:[(0,w.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px",textAlign:"center"},children:"\ud83d\udce6"}),(0,w.jsx)("h3",{style:{textAlign:"center",color:"#DC2626",marginBottom:"16px"},children:"Kargo bulunamad\u0131"}),(0,w.jsx)("p",{style:{textAlign:"center",color:"#DC2626",fontSize:"14px",margin:0},children:v.message}),(0,w.jsx)("div",{style:{textAlign:"center",marginTop:"16px"},children:(0,w.jsx)("button",{onClick:function(){c(!1),s("")},style:{padding:"8px 16px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Tekrar Dene"})})]}):"error"===v.status?(0,w.jsxs)("div",{className:"cargo-error-message",children:[(0,w.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px",textAlign:"center"},children:"\u26a0\ufe0f"}),(0,w.jsx)("h3",{style:{textAlign:"center",color:"#DC2626",marginBottom:"16px"},children:"Hata olu\u015ftu"}),(0,w.jsx)("p",{style:{textAlign:"center",color:"#DC2626",fontSize:"14px",margin:0},children:v.message}),(0,w.jsx)("div",{style:{textAlign:"center",marginTop:"16px"},children:(0,w.jsx)("button",{onClick:function(){c(!1),s("")},style:{padding:"8px 16px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Tekrar Dene"})})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("h3",{children:"Sipari\u015f Takip Bilgileri"}),(0,w.jsxs)("div",{className:"order-header",children:[(0,w.jsxs)("div",{className:"order-id",children:["Sipari\u015f No: ",v.order_id]}),(0,w.jsxs)("div",{className:"order-status",children:["Durum: ","shipped"===v.status?"Kargoya Verildi":v.status]}),(0,w.jsxs)("div",{className:"order-date",children:["Sipari\u015f Tarihi: ",S(v.order_date)]})]}),(0,w.jsxs)("div",{className:"order-items",children:[(0,w.jsx)("h4",{children:"Sipari\u015f Edilen \xdcr\xfcnler:"}),v.items.map(function(e,n){return(0,w.jsxs)("div",{className:"order-item",children:[(0,w.jsx)("span",{className:"item-name",children:e.name}),(0,w.jsxs)("span",{className:"item-quantity",children:["x",e.quantity]}),(0,w.jsx)("span",{className:"item-price",children:e.price})]},n)})]}),(0,w.jsxs)("div",{className:"shipping-info",children:[(0,w.jsx)("h4",{children:"Kargo Bilgileri:"}),(0,w.jsxs)("div",{className:"shipping-detail",children:[(0,w.jsx)("strong",{children:"Kargo Firmas\u0131:"})," ",v.shipping.courier]}),(0,w.jsxs)("div",{className:"shipping-detail",children:[(0,w.jsx)("strong",{children:"Takip Numaras\u0131:"})," ",v.shipping.tracking_number]}),(0,w.jsxs)("div",{className:"shipping-detail",children:[(0,w.jsx)("strong",{children:"Son G\xfcncelleme:"})," ",C(v.shipping.last_update)]}),(0,w.jsxs)("div",{className:"shipping-detail",children:[(0,w.jsx)("strong",{children:"Konum:"})," ",v.shipping.location]}),(0,w.jsxs)("div",{className:"shipping-detail",children:[(0,w.jsx)("strong",{children:"Tahmini Teslim:"})," ",S(v.shipping.estimated_delivery)]})]}),(0,w.jsx)("div",{className:"order-message",children:(0,w.jsx)("p",{children:v.message})})]})})}),(0,w.jsxs)("div",{className:"feedback-container",children:[(0,w.jsx)("button",{className:"feedback-button",onClick:function(){return N(!0)},children:"\ud83d\udc4d Yararl\u0131"}),(0,w.jsx)("button",{className:"feedback-button negative",onClick:function(){return N(!1)},children:"\ud83d\udc4e Yarars\u0131z"})]})]}):(0,w.jsxs)("div",{className:"message agent-message",children:[(0,w.jsx)("div",{className:"message-content-wrapper",children:(0,w.jsx)("p",{children:n.content||n.message||"Sipari\u015f mesaj\u0131 bulunamad\u0131."})}),(0,w.jsxs)("div",{className:"feedback-container",children:[(0,w.jsx)("button",{className:"feedback-button",onClick:function(){return N(!0)},children:"\ud83d\udc4d Yararl\u0131"}),(0,w.jsx)("button",{className:"feedback-button negative",onClick:function(){return N(!1)},children:"\ud83d\udc4e Yarars\u0131z"})]})]})},D=function(e){var n=e.message,a=e.onFeedback,t=g((0,f.useState)(""),2),r=t[0],s=t[1],i=g((0,f.useState)(!1),2),o=i[0],c=i[1],d=g((0,f.useState)(null),2),m=d[0],p=d[1],h=g((0,f.useState)(!1),2),v=h[0],x=h[1];f.useEffect(function(){var e="feedback_".concat(n.id);localStorage.getItem(e)&&x(!0)},[n.id]);var j=function(e){var t="feedback_".concat(n.id);localStorage.setItem(t,JSON.stringify({isHelpful:e,timestamp:(new Date).toISOString()})),x(!0),a({messageId:n.id,isHelpful:e,comment:""})},y=function(){var e=u(l().m(function e(){var n,a,t,s,i,o;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r.trim()){e.n=1;break}return e.a(2);case 1:if(c(!0),e.p=2,a=window.widgetConfig,t=null===a||void 0===a||null===(n=a.apiEndpoints)||void 0===n?void 0:n.cargoTracking,s=null===a||void 0===a?void 0:a.isCargoEnabled,t&&s){e.n=3;break}return p({error:"Bu \xf6zellik yak\u0131nda a\xe7\u0131lacak",feature_disabled:!0}),c(!1),e.a(2);case 3:return e.n=4,fetch("".concat(t,"?cargo_number=").concat(encodeURIComponent(r)),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});case 4:if(!(i=e.v).ok){e.n=6;break}return e.n=5,i.json();case 5:o=e.v,p(o.data),e.n=7;break;case 6:p({error:"Kargo takip bilgisi al\u0131namad\u0131"});case 7:e.n=9;break;case 8:e.p=8,e.v,p({error:"Ba\u011flant\u0131 hatas\u0131"});case 9:return e.p=9,c(!1),e.f(9);case 10:return e.a(2)}},e,null,[[2,8,9,10]])}));return function(){return e.apply(this,arguments)}}();return(0,w.jsxs)("div",{className:"message agent-message",children:[(0,w.jsxs)("div",{className:"message-content-wrapper",children:[(0,w.jsx)("p",{style:{marginBottom:"16px"},children:n.message||"Kargo takip numaran\u0131z\u0131 girerek kargo durumunuzu \xf6\u011frenebilirsiniz."}),(0,w.jsxs)("div",{className:"cargo-tracking-input",style:{marginBottom:"16px"},children:[(0,w.jsx)("input",{id:"cargo-number",type:"text",value:r,onChange:function(e){return s(e.target.value)},placeholder:"Kargo takip numaras\u0131 giriniz...",style:{width:"100%",padding:"8px 12px",border:"1px solid #D1D5DB",borderRadius:"6px",fontSize:"14px",outline:"none",marginBottom:"8px"},onKeyPress:function(e){return"Enter"===e.key&&y()}}),(0,w.jsxs)("button",{onClick:y,disabled:o||!r.trim(),style:{width:"100%",padding:"8px 10px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontSize:"14px",fontWeight:"500",opacity:o||!r.trim()?.6:1},children:[o?"Takip Ediliyor...":"Takip Et",(0,w.jsx)("span",{style:{fontSize:"14px"},children:"\u2192"})]})]}),m&&(0,w.jsx)("div",{className:"cargo-tracking-result",style:{backgroundColor:m.feature_disabled?"#FEF3C7":"#F9FAFB",padding:"16px",borderRadius:"8px",border:"1px solid ".concat(m.feature_disabled?"#F59E0B":"#E5E7EB"),marginBottom:"16px"},children:m.error?(0,w.jsx)("div",{style:{textAlign:"center"},children:m.feature_disabled?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{style:{fontSize:"48px",marginBottom:"8px"},children:"\ud83d\udea7"}),(0,w.jsx)("p",{style:{color:"#92400E",margin:"0 0 8px 0",fontWeight:"600"},children:"Bu \xf6zellik yak\u0131nda a\xe7\u0131lacak"}),(0,w.jsx)("p",{style:{color:"#92400E",margin:0,fontSize:"14px"},children:"Kargo takip \xf6zelli\u011fi geli\u015ftirme a\u015famas\u0131nda"})]}):(0,w.jsx)("p",{style:{color:"#DC2626",margin:0},children:m.error})}):(0,w.jsxs)("div",{children:[(0,w.jsx)("h4",{style:{fontSize:"16px",fontWeight:"600",margin:"0 0 12px 0",color:"#111827"},children:"\ud83d\udce6 Kargo Takip Bilgisi"}),(0,w.jsxs)("div",{style:{display:"grid",gap:"8px"},children:[(0,w.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,w.jsx)("span",{style:{fontSize:"14px",color:"#6B7280"},children:"Takip No:"}),(0,w.jsx)("span",{style:{fontSize:"14px",fontWeight:"500"},children:m.cargo_number})]}),(0,w.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,w.jsx)("span",{style:{fontSize:"14px",color:"#6B7280"},children:"Durum:"}),(0,w.jsx)("span",{style:{fontSize:"14px",fontWeight:"500",color:"#059669"},children:m.status})]}),(0,w.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,w.jsx)("span",{style:{fontSize:"14px",color:"#6B7280"},children:"Konum:"}),(0,w.jsx)("span",{style:{fontSize:"14px",fontWeight:"500"},children:m.current_location})]}),(0,w.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,w.jsx)("span",{style:{fontSize:"14px",color:"#6B7280"},children:"Tahmini Teslimat:"}),(0,w.jsx)("span",{style:{fontSize:"14px",fontWeight:"500"},children:m.estimated_delivery})]}),(0,w.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,w.jsx)("span",{style:{fontSize:"14px",color:"#6B7280"},children:"Son G\xfcncelleme:"}),(0,w.jsx)("span",{style:{fontSize:"14px",fontWeight:"500"},children:m.last_update})]})]}),m.tracking_url&&(0,w.jsx)("div",{style:{marginTop:"12px",textAlign:"center"},children:(0,w.jsx)("a",{href:m.tracking_url,target:"_blank",rel:"noopener noreferrer",style:{color:"#3B82F6",textDecoration:"none",fontSize:"14px",fontWeight:"500"},children:"\ud83d\udccd Detayl\u0131 Takip Sayfas\u0131"})})]})})]}),!v&&(0,w.jsxs)("div",{className:"feedback-container",children:[(0,w.jsx)("button",{className:"feedback-button",onClick:function(){return j(!0)},children:"\ud83d\udc4d Yararl\u0131"}),(0,w.jsx)("button",{className:"feedback-button negative",onClick:function(){return j(!1)},children:"\ud83d\udc4e Yarars\u0131z"})]}),v&&(0,w.jsx)("div",{className:"feedback-thanks",children:(0,w.jsx)("span",{style:{fontSize:"12px",color:"#10B981",fontStyle:"italic"},children:"\u2713 Feedback'iniz i\xe7in te\u015fekk\xfcrler!"})})]})},P=function(e){var n=e.type,a=void 0===n?"general":n;return(0,w.jsxs)("div",{className:"message agent-message shimmer-message",children:[(0,w.jsx)("div",{className:"message-content-wrapper",children:function(){switch(a){case"product":return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"shimmer shimmer-title",style:{width:"60%",height:"16px",marginBottom:"12px"}}),(0,w.jsx)("div",{className:"products-scroll-container",children:(0,w.jsx)("div",{className:"products-wrapper",children:[1,2,3].map(function(e){return(0,w.jsxs)("div",{className:"product-card shimmer-card",children:[(0,w.jsx)("div",{className:"shimmer shimmer-image",style:{width:"100%",height:"80px"}}),(0,w.jsxs)("div",{className:"product-info",children:[(0,w.jsx)("div",{className:"shimmer shimmer-text",style:{width:"80%",height:"14px",marginBottom:"8px"}}),(0,w.jsx)("div",{className:"shimmer shimmer-text",style:{width:"60%",height:"12px",marginBottom:"4px"}}),(0,w.jsx)("div",{className:"shimmer shimmer-price",style:{width:"40%",height:"16px",marginBottom:"8px"}}),(0,w.jsx)("div",{className:"shimmer shimmer-button",style:{width:"100%",height:"24px"}})]})]},e)})})})]});case"cargo":return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"shimmer shimmer-text",style:{width:"90%",height:"16px",marginBottom:"16px"}}),(0,w.jsx)("div",{className:"shimmer shimmer-input",style:{width:"100%",height:"36px",marginBottom:"8px"}}),(0,w.jsx)("div",{className:"shimmer shimmer-button",style:{width:"100%",height:"36px"}})]});case"order":return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"shimmer shimmer-text",style:{width:"85%",height:"16px",marginBottom:"16px"}}),(0,w.jsx)("div",{className:"shimmer shimmer-input",style:{width:"100%",height:"36px",marginBottom:"8px"}}),(0,w.jsx)("div",{className:"shimmer shimmer-button",style:{width:"100%",height:"36px"}})]});case"feedback":return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"shimmer shimmer-text",style:{width:"80%",height:"16px",marginBottom:"16px"}}),(0,w.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,w.jsx)("div",{className:"shimmer shimmer-button",style:{width:"80px",height:"32px"}}),(0,w.jsx)("div",{className:"shimmer shimmer-button",style:{width:"80px",height:"32px"}})]})]});default:return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"shimmer shimmer-text",style:{width:"90%",height:"16px",marginBottom:"12px"}}),Math.random()>.5&&(0,w.jsx)("div",{className:"action-buttons",children:(0,w.jsx)("div",{className:"action-buttons-scroll-container",children:(0,w.jsx)("div",{className:"action-buttons-wrapper",children:[1,2,3].map(function(e){return(0,w.jsx)("div",{className:"shimmer shimmer-suggestion",style:{width:"80px",height:"28px"}},e)})})})})]})}}()}),(0,w.jsxs)("div",{className:"feedback-container",children:[(0,w.jsx)("div",{className:"shimmer shimmer-feedback",style:{width:"70px",height:"28px"}}),(0,w.jsx)("div",{className:"shimmer shimmer-feedback",style:{width:"70px",height:"28px"}})]})]})},O=function(e){var n,a=e.message,t=e.onFeedback,r=g(f.useState(!1),2),s=r[0],i=r[1],o=function(e){var n,r;if(!s){var o={messageId:a.id,isHelpful:e,comment:"Search: ".concat((null===(n=a.data)||void 0===n?void 0:n.search_query)||"",", Intent: ").concat(a.intent||"product_search",", Results: ").concat((null===(r=a.data)||void 0===r?void 0:r.total_found)||0)};t(o),i(!0),localStorage.setItem("feedback_".concat(a.id),JSON.stringify(o))}};return(0,w.jsx)("div",{className:"message bot-message",children:(0,w.jsxs)("div",{className:"message-content",children:[(0,w.jsx)("div",{className:"",children:(0,w.jsxs)("div",{className:"no-data-content",children:[(0,w.jsx)("h4",{className:"no-data-title",children:a.message||"\u015eu anda bilgi taban\u0131nda bilgi olmad\u0131\u011f\u0131 i\xe7in g\xf6r\xfcnt\xfcleyemiyoruz"}),(0,w.jsx)("p",{className:"no-data-description",children:"L\xfctfen bilgi taban\u0131n\u0131z\u0131 g\xfcncelleyiniz"}),(null===(n=a.data)||void 0===n?void 0:n.search_query)&&(0,w.jsxs)("div",{className:"search-details",children:[(0,w.jsx)("span",{className:"search-label",children:"Arama:"}),(0,w.jsxs)("span",{className:"search-query",children:['"',a.data.search_query,'"']}),(0,w.jsxs)("span",{className:"search-results",children:["(",a.data.total_found||0," sonu\xe7)"]})]})]})}),(0,w.jsxs)("div",{className:"feedback-section",children:[(0,w.jsx)("p",{className:"feedback-question",children:"Bu bilgi faydal\u0131 m\u0131yd\u0131?"}),(0,w.jsxs)("div",{className:"feedback-buttons",children:[(0,w.jsx)("button",{onClick:function(){return o(!0)},disabled:s,className:"feedback-btn helpful ".concat(s?"disabled":"hover:bg-green-600"),children:"\ud83d\udc4d Faydal\u0131"}),(0,w.jsx)("button",{onClick:function(){return o(!1)},disabled:s,className:"feedback-btn not-helpful ".concat(s?"disabled":"hover:bg-red-600"),children:"\ud83d\udc4e Faydal\u0131 De\u011fil"})]}),s&&(0,w.jsx)("p",{className:"feedback-thanks",children:"Te\u015fekk\xfcrler! Geri bildiriminiz kaydedildi."})]})]})})},R=function(e){var n=e.message,a=n.data||{},t=a.error||"UNKNOWN_ERROR",r="Bir hata olu\u015ftu";!1===a.success&&n.message?r=n.message:a.message?r=a.message:n.message&&(r=n.message);var s=a.redirect,i=function(){switch(t){case"NO_USAGE_TOKENS":return"Token Bulunamad\u0131";case"USAGE_TOKENS_EXPIRED":return"Token S\xfcresi Dolmu\u015f";case"INSUFFICIENT_TOKENS":return"Yetersiz Token";case"INVALID_PROJECT":return"Ge\xe7ersiz veya aktif olmayan proje";default:return"Hata"}},o=function(){switch(t){case"NO_USAGE_TOKENS":return"Kullan\u0131m token'\u0131n\u0131z bulunmuyor. \xdcr\xfcn\xfc kullanmak i\xe7in sat\u0131n alman\u0131z gerekiyor.";case"USAGE_TOKENS_EXPIRED":return"Abonelik s\xfcreniz dolmu\u015f. \xdcr\xfcn\xfc kullanmak i\xe7in sat\u0131n alman\u0131z gerekiyor.";case"INSUFFICIENT_TOKENS":return"Yetersiz kullan\u0131m token'\u0131. L\xfctfen \xfcr\xfcn kullan\u0131m\u0131 i\xe7in token sat\u0131n alman\u0131z gerekiyor.";default:return r}};return(0,w.jsxs)("div",{className:"error-message",children:[(0,w.jsxs)("div",{className:"error-header",children:[(0,w.jsx)("div",{className:"error-icon",children:function(){switch(t){case"NO_USAGE_TOKENS":return"\ud83d\udd11";case"USAGE_TOKENS_EXPIRED":return"\u23f0";case"INSUFFICIENT_TOKENS":return"\ud83d\udcb3";case"INVALID_PROJECT":return"\ud83d\udeab";default:return"\u26a0\ufe0f"}}()}),(0,w.jsx)("h3",{className:"error-title",children:i()}),(0,w.jsx)("div",{className:"error-content",children:i()!==o()&&(0,w.jsx)("p",{className:"error-description",children:o()})})]}),"INSUFFICIENT_TOKENS"===t&&void 0!==a.tokens_remaining?(0,w.jsxs)("div",{className:"token-info",children:[(0,w.jsxs)("div",{className:"token-stats",children:[(0,w.jsxs)("div",{className:"token-stat",children:[(0,w.jsx)("span",{className:"label",children:"Kalan Token:"}),(0,w.jsx)("span",{className:"value",children:a.tokens_remaining})]}),(0,w.jsxs)("div",{className:"token-stat",children:[(0,w.jsx)("span",{className:"label",children:"Kullan\u0131lan:"}),(0,w.jsx)("span",{className:"value",children:a.tokens_used})]}),(0,w.jsxs)("div",{className:"token-stat",children:[(0,w.jsx)("span",{className:"label",children:"Toplam:"}),(0,w.jsx)("span",{className:"value",children:a.tokens_total})]})]}),(0,w.jsx)("div",{className:"usage-bar",children:(0,w.jsx)("div",{className:"usage-fill",style:{width:"".concat(a.usage_percentage||0,"%")}})})]}):null,s&&(0,w.jsx)("div",{className:"error-actions",children:(0,w.jsx)("button",{className:"upgrade-button",onClick:function(){s&&window.open(s,"_blank")},children:"Plan\u0131 G\xfcncelle"})})]})},B=function(e){var n,a,t,r=e.message,s=(e.onFeedback,(null===(n=r.data)||void 0===n?void 0:n.isDevelopment)||!1),i=(null===(a=r.data)||void 0===a?void 0:a.action)||"unknown",o=null===(t=r.data)||void 0===t?void 0:t.product;if(!s)return null;return(0,w.jsxs)("div",{className:"development-message",children:[(0,w.jsxs)("div",{className:"development-header",children:[(0,w.jsx)("div",{className:"development-icon",children:function(){switch(i){case"compare":return"\ud83d\udd04";case"wishlist":return"\u2764\ufe0f";case"price_comparison":return"\ud83d\udcb0";default:return"\ud83d\udea7"}}()}),(0,w.jsx)("div",{className:"development-title",children:function(){switch(i){case"compare":return"\xdcr\xfcn Kar\u015f\u0131la\u015ft\u0131rma";case"wishlist":return"Favori Listesi";case"price_comparison":return"Fiyat Kar\u015f\u0131la\u015ft\u0131rma";default:return"Geli\u015ftirilmekte Olan \xd6zellik"}}()})]}),(0,w.jsxs)("div",{className:"development-content",children:[(0,w.jsx)("div",{className:"development-description",children:function(){switch(i){case"compare":return"\xdcr\xfcnleri detayl\u0131 olarak kar\u015f\u0131la\u015ft\u0131rabilme \xf6zelli\u011fi yak\u0131nda kullan\u0131ma sunulacak. Bu \xf6zellik ile farkl\u0131 \xfcr\xfcnlerin \xf6zelliklerini, fiyatlar\u0131n\u0131 ve de\u011ferlendirmelerini yan yana g\xf6rebileceksiniz.";case"wishlist":return"Favori \xfcr\xfcnlerinizi kaydedebilme \xf6zelli\u011fi geli\u015ftirilme a\u015famas\u0131nda. Yak\u0131nda be\u011fendi\u011finiz \xfcr\xfcnleri kolayca takip edebileceksiniz.";case"price_comparison":return"Farkl\u0131 sat\u0131c\u0131lardan fiyat kar\u015f\u0131la\u015ft\u0131rmas\u0131 yapabilme \xf6zelli\u011fi yak\u0131nda eklenecek. En uygun fiyatlar\u0131 bulman\u0131z\u0131 sa\u011flayacak.";default:return"Bu \xf6zellik aktif olarak geli\u015ftirilmektedir. Yak\u0131nda kullan\u0131ma sunulacak."}}()}),o&&(0,w.jsxs)("div",{className:"development-product-info",children:[(0,w.jsx)("div",{className:"development-product-name",children:(0,w.jsx)("strong",{children:o.name})}),o.brand&&(0,w.jsx)("div",{className:"development-product-brand",children:o.brand})]}),(0,w.jsx)("div",{className:"development-status",children:(0,w.jsxs)("div",{className:"development-status-badge",children:[(0,w.jsx)("span",{className:"status-icon",children:"\ud83d\udea7"}),(0,w.jsx)("span",{className:"status-text",children:"Geli\u015ftirilme A\u015famas\u0131nda"})]})}),(0,w.jsxs)("div",{className:"development-cta",children:[(0,w.jsx)("div",{className:"development-cta-text",children:"Bu \xf6zellik hakk\u0131nda bilgi almak i\xe7in bize ula\u015fabilirsiniz."}),(0,w.jsx)("button",{className:"development-contact-btn",onClick:function(){console.log("Contact clicked for development feature:",i)},children:"Bilgi Al"})]})]})]})},L=function(e){var n=e.message,a=e.onProductClick,t=e.onFeedback,r=e.onAddMessage,s=e.onSendMessage,i="user"===n.role;if(i)return(0,w.jsx)("div",{className:"message-group user",children:(0,w.jsx)("div",{className:"message user-message",children:(0,w.jsx)("div",{className:"message-content-wrapper",children:n.content})})});var c=k();return(0,w.jsxs)("div",{className:"message-group",children:[(0,w.jsx)("div",{className:"agent-avatar",children:(0,w.jsx)("img",{src:c.small,alt:"AI Conversion Agent"})}),function(){if(i)return null;switch(n.type||n.intent||"general"){case"product_recommendation":case"product_inquiry":case"category_browse":case"order_inquiry":case"smart_recommendation":case"trend_products":case"contextual_recommendation":case"category_recommendation":return(0,w.jsx)(S,{message:n,onProductClick:a,onFeedback:t,onAddMessage:r,onSendMessage:s});case"product_detail":return(0,w.jsx)(C,{message:n,onProductClick:a,onAddMessage:r});case"price_comparison_result":return(0,w.jsx)(E,{message:n,onProductClick:a});case"product_link":return(0,w.jsx)("div",{className:"message agent-message",children:(0,w.jsx)("div",{className:"message-content-wrapper",children:(0,w.jsx)("div",{className:"product-link-message",style:{padding:"12px 16px",backgroundColor:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",margin:"8px 0"},children:(0,w.jsx)("div",{style:{fontSize:"14px",lineHeight:"1.5",color:"#E5E7EB"},dangerouslySetInnerHTML:{__html:n.content.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" style="color: #60A5FA; text-decoration: underline; font-weight: 500;">$1</a>').replace(/\*\*([^*]+)\*\*/g,'<strong style="color: #F3F4F6;">$1</strong>')}})})})});case"product_search":var e;return 0===(n.products||(null===(e=n.data)||void 0===e?void 0:e.products)||[]).length?(0,w.jsx)(O,{message:n,onFeedback:t}):(0,w.jsx)(S,{message:n,onProductClick:a,onFeedback:t,onAddMessage:r,onSendMessage:s});case"feedback":return(0,w.jsx)(T,{message:n,onFeedback:t});case"order_tracking":return(0,w.jsx)(I,{message:n,onFeedback:t});case"cargo_tracking":return(0,w.jsx)(D,{message:n,onFeedback:t});case"campaign_inquiry":default:return(0,w.jsx)(A,{message:n,onFeedback:t});case"shimmer":return(0,w.jsx)(P,{type:n.shimmerType});case"development":if(n.data&&n.data.isDevelopment)return(0,w.jsx)(B,{message:o(o({},n),{},{timestamp:n.timestamp instanceof Date?n.timestamp.toISOString():n.timestamp}),onFeedback:t});break;case"greeting":case"help_request":case"price_inquiry":case"general":case"capabilities_inquiry":case"contact_request":case"project_info":case"conversion_guidance":case"pricing_guidance":case"demo_request":case"product_recommendations":break;case"error":case"token_error":if(n.data&&n.data.error)return(0,w.jsx)(R,{message:n})}}()]})},z=function(e){var n=e.text,a=e.isUser,t=void 0!==a&&a,r=e.className,s=void 0===r?"":r,i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=g((0,f.useState)(!1),2),a=n[0],t=n[1],r=g((0,f.useState)(""),2),s=r[0],i=r[1],c=(0,f.useRef)(null),l=(0,f.useMemo)(function(){return o({lang:"tr-TR",rate:.9,pitch:1,volume:1},e)},[e]),d=(0,f.useCallback)(function(e){if(c.current&&(speechSynthesis.cancel(),c.current=null),"speechSynthesis"in window){var n=new SpeechSynthesisUtterance(e);n.lang=l.lang,n.rate=l.rate,n.pitch=l.pitch,n.volume=l.volume,i(e),t(!0),n.onstart=function(){},n.onend=function(){t(!1),i(""),c.current=null},n.onerror=function(e){t(!1),i(""),c.current=null},c.current=n,speechSynthesis.speak(n)}else alert("Bu taray\u0131c\u0131da text-to-speech desteklenmiyor.")},[l]),u=(0,f.useCallback)(function(){c.current&&(speechSynthesis.cancel(),c.current=null,t(!1),i(""))},[]),m=(0,f.useCallback)(function(e){return a&&s===e},[a,s]);return{speak:d,stop:u,isPlaying:a,currentText:s,isCurrentlyPlaying:m}}(),c=i.speak,l=i.stop,d=i.isCurrentlyPlaying,u=d(n);return(0,w.jsx)("button",{className:"tts-button ".concat(t?"user":""," ").concat(u?"playing":""," ").concat(s),onClick:function(e){e.stopPropagation(),d(n)?l():c(n)},title:u?"Sesi Durdur":"Metni Seslendir",children:(0,w.jsx)("span",{className:"tts-icon"})})},U=function(e){var n=e.welcomeText,a=e.agentName,t=e.logoUrl||k().small;return(0,w.jsxs)("div",{className:"welcome-message-container",children:[(0,w.jsx)("div",{className:"welcome-logo",children:(0,w.jsx)("img",{src:t,alt:a})}),(0,w.jsx)("div",{className:"welcome-agent-name",children:a}),(0,w.jsx)("div",{className:"welcome-text",children:n}),(0,w.jsx)("div",{className:"welcome-tts",children:(0,w.jsx)(z,{text:n})})]})};function F(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function K(e,n){for(var a=0;a<n.length;a++){var t=n[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,r(t.key),t)}}function M(e,n,a){return n&&K(e.prototype,n),a&&K(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}var H=function(){function e(){F(this,e),this.config={prefix:"browser_",storageKey:"convstateai_browser_uuid",expiryHours:72}}return M(e,[{key:"getBrowserUuid",value:function(){try{var e=this.getStoredUuid();if(e&&this.isUuidValid(e))return e.uuid;var n=this.generateUuid();return this.storeUuid(n),n}catch(a){return this.generateUuid()}}},{key:"generateUuid",value:function(){var e=Date.now(),n=Math.random().toString(36).substr(2,9),a=this.getBrowserFingerprint();return"".concat(this.config.prefix).concat(e,"_").concat(n,"_").concat(a)}},{key:"getBrowserFingerprint",value:function(){try{var e=document.createElement("canvas"),n=e.getContext("2d");n&&(n.textBaseline="top",n.font="14px Arial",n.fillText("Browser fingerprint",2,2));for(var a=[navigator.userAgent,navigator.language,window.screen.width+"x"+window.screen.height,(new Date).getTimezoneOffset(),e.toDataURL().slice(-10)].join("|"),t=0,r=0;r<a.length;r++){t=(t<<5)-t+a.charCodeAt(r),t&=t}return Math.abs(t).toString(36).substr(0,8)}catch(s){return Math.random().toString(36).substr(2,8)}}},{key:"getStoredUuid",value:function(){try{var e=localStorage.getItem(this.config.storageKey);if(!e)return null;var n=JSON.parse(e);return{uuid:n.uuid,timestamp:n.timestamp}}catch(a){return null}}},{key:"storeUuid",value:function(e){try{var n={uuid:e,timestamp:Date.now()};localStorage.setItem(this.config.storageKey,JSON.stringify(n))}catch(a){}}},{key:"isUuidValid",value:function(e){var n=Date.now(),a=60*this.config.expiryHours*60*1e3,t=n-e.timestamp<a;return t}},{key:"refreshUuid",value:function(){var e=this.generateUuid();return this.storeUuid(e),e}},{key:"clearUuid",value:function(){try{localStorage.removeItem(this.config.storageKey)}catch(e){}}},{key:"getUuidInfo",value:function(){var e=this.getStoredUuid();if(!e)return null;var n=new Date(e.timestamp),a=new Date(e.timestamp+60*this.config.expiryHours*60*1e3),t=this.isUuidValid(e);return{uuid:e.uuid,created:n,expires:a,isValid:t}}},{key:"getDebugInfo",value:function(){return null}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}])}();H.instance=void 0;var G=H.getInstance(),W=function(){function e(){F(this,e),this.token=null,this.userId=null,this.projectId=null,this.config=null,this.usageToken=null}return M(e,[{key:"setConfig",value:function(e){this.config=e,this.projectId=e.projectId,e.auth&&(this.token=e.auth.token||null,this.userId=e.auth.userId||null),e.customizationToken&&(this.token=e.customizationToken)}},{key:"setCredentials",value:function(e,n){this.token=e,this.userId=n}},{key:"getAuthHeaders",value:function(){var e={"Content-Type":"application/json",Accept:"application/json"};return this.projectId&&(e["X-Project-ID"]=this.projectId),this.token&&(e.Authorization="Bearer ".concat(this.token)),this.userId&&(e["X-User-ID"]=this.userId),e}},{key:"isAuthenticated",value:function(){return!(!this.token||!this.userId)}},{key:"getProjectId",value:function(){return this.projectId}},{key:"getUserId",value:function(){return this.userId}},{key:"getToken",value:function(){return this.token}},{key:"getConfig",value:function(){return this.config}},{key:"clearAuth",value:function(){this.token=null,this.userId=null,this.usageToken=null}},{key:"setUsageToken",value:function(e){this.usageToken=e}},{key:"getUsageToken",value:function(){return this.usageToken}},{key:"canUseToken",value:function(){return!!this.usageToken&&(this.usageToken.can_use_token&&!this.usageToken.is_expired)}},{key:"isTokenExpired",value:function(){return!this.usageToken||this.usageToken.is_expired}},{key:"getRemainingTokens",value:function(){var e;return(null===(e=this.usageToken)||void 0===e?void 0:e.tokens_remaining)||0}},{key:"getUsagePercentage",value:function(){var e;return(null===(e=this.usageToken)||void 0===e?void 0:e.usage_percentage)||0}},{key:"getTokenResetDate",value:function(){var e;return(null===(e=this.usageToken)||void 0===e?void 0:e.reset_date)||null}},{key:"getDaysUntilReset",value:function(){var e;return(null===(e=this.usageToken)||void 0===e?void 0:e.days_until_reset)||0}},{key:"getTokenStatus",value:function(){var e,n;return{canUse:this.canUseToken(),isExpired:this.isTokenExpired(),remaining:this.getRemainingTokens(),used:(null===(e=this.usageToken)||void 0===e?void 0:e.tokens_used)||0,total:(null===(n=this.usageToken)||void 0===n?void 0:n.tokens_total)||0,percentage:this.getUsagePercentage(),resetDate:this.getTokenResetDate(),daysUntilReset:this.getDaysUntilReset()}}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}])}();W.instance=void 0;var q=function(){function e(){F(this,e),this.errorHandlers=[]}return M(e,[{key:"onError",value:function(e){var n=this;return this.errorHandlers.push(e),function(){var a=n.errorHandlers.indexOf(e);a>-1&&n.errorHandlers.splice(a,1)}}},{key:"handleAPIError",value:function(e,n){var a=this.parseError(e,n);return this.notifyError(a),a}},{key:"parseError",value:function(e,n){var a,t=Date.now();if(e instanceof TypeError&&e.message.includes("fetch"))return{type:"network",message:"Ba\u011flant\u0131 hatas\u0131. \u0130nternet ba\u011flant\u0131n\u0131z\u0131 kontrol edin.",details:{originalError:e.message,context:n},timestamp:t};if(e.status||e.response&&e.response.status){var r=e.status||e.response.status;return{type:"server",status:r,message:this.getStatusMessage(r),details:{originalError:e,context:n},timestamp:t}}return"AbortError"===e.name||null!==(a=e.message)&&void 0!==a&&a.includes("timeout")?{type:"timeout",message:"\u0130stek zaman a\u015f\u0131m\u0131na u\u011frad\u0131. L\xfctfen tekrar deneyin.",details:{originalError:e,context:n},timestamp:t}:e.status>=400&&e.status<500?{type:"client",status:e.status,message:this.getClientErrorMessage(e),details:{originalError:e,context:n},timestamp:t}:{type:"unknown",message:e.message||"Bilinmeyen bir hata olu\u015ftu.",details:{originalError:e,context:n},timestamp:t}}},{key:"getStatusMessage",value:function(e){switch(e){case 400:return"Ge\xe7ersiz istek. L\xfctfen verilerinizi kontrol edin.";case 401:return"Yetkilendirme hatas\u0131. L\xfctfen giri\u015f yap\u0131n.";case 403:return"Bu i\u015flem i\xe7in yetkiniz bulunmuyor.";case 404:return"\u0130stenen kaynak bulunamad\u0131.";case 408:return"\u0130stek zaman a\u015f\u0131m\u0131na u\u011frad\u0131.";case 429:return"\xc7ok fazla istek g\xf6nderildi. L\xfctfen bekleyin.";case 500:return"Sunucu hatas\u0131. L\xfctfen daha sonra tekrar deneyin.";case 502:return"Sunucu ge\xe7ici olarak kullan\u0131lam\u0131yor.";case 503:return"Hizmet ge\xe7ici olarak kullan\u0131lam\u0131yor.";case 504:return"Sunucu yan\u0131t vermiyor.";default:return"Sunucu hatas\u0131 (".concat(e,"). L\xfctfen daha sonra tekrar deneyin.")}}},{key:"getClientErrorMessage",value:function(e){var n;return null!==(n=e.data)&&void 0!==n&&n.message?e.data.message:e.message?e.message:this.getStatusMessage(e.status)}},{key:"notifyError",value:function(e){this.errorHandlers.forEach(function(n){try{n(e)}catch(a){console.error("Error handler failed:",a)}})}},{key:"getErrorWidgetConfig",value:function(e){switch(e.type){case"network":case"timeout":return{showRetry:!0,showDetails:!1,autoHide:!1,hideDelay:0};case"client":return 401===e.status||403===e.status?{showRetry:!1,showDetails:!1,autoHide:!1,hideDelay:0,redirectUrl:"/login"}:{showRetry:!0,showDetails:!0,autoHide:!0,hideDelay:5e3};case"server":return{showRetry:!0,showDetails:!0,autoHide:!0,hideDelay:8e3};default:return{showRetry:!0,showDetails:!1,autoHide:!0,hideDelay:5e3}}}},{key:"createErrorMessage",value:function(e){return{id:"error_".concat(e.timestamp),role:"agent",content:e.message,type:"error",message:e.message,timestamp:new Date(e.timestamp),data:{error:e.type.toUpperCase(),status:e.status,details:e.details,config:this.getErrorWidgetConfig(e)}}}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}])}();q.instance=void 0;var V=q.getInstance(),Y=function(){function e(){F(this,e),this.authService=W.getInstance(),this.baseUrl=v.BASE_URL,this.baseUrl=v.BASE_URL,console.log("ApiService: Initialized with base URL:",this.baseUrl),console.log("ApiService: Environment:","production")}return M(e,[{key:"setBaseUrl",value:function(e){this.baseUrl=e,console.log("ApiService: Base URL updated to:",e)}},{key:"getBaseUrl",value:function(){return this.baseUrl}},{key:"makeRequest",value:function(){var e=u(l().m(function e(n){var a,t,r,s,i,c,d,u=arguments;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return a=u.length>1&&void 0!==u[1]?u[1]:{},e.p=1,t=x(n),r=o(o({},this.authService.getAuthHeaders()),a.headers),e.n=2,fetch(t,o(o({},a),{},{headers:r}));case 2:if((s=e.v).ok){e.n=3;break}throw i={status:s.status,statusText:s.statusText,url:t,endpoint:n},V.handleAPIError(i,"API Request: ".concat(n)),new Error("HTTP error! status: ".concat(s.status));case 3:return e.n=4,s.json();case 4:return c=e.v,e.a(2,c);case 5:return e.p=5,d=e.v,V.handleAPIError(d,"API Request: ".concat(n)),e.a(2,{success:!1,error:d instanceof Error?d.message:"Unknown error"})}},e,this,[[1,5]])}));return function(n){return e.apply(this,arguments)}}()},{key:"sendMessage",value:function(){var e=u(l().m(function e(n){var a,t,r=arguments;return l().w(function(e){for(;;)if(0===e.n)return a=r.length>1&&void 0!==r[1]?r[1]:1,t=G.getBrowserUuid(),e.a(2,this.makeRequest("/chat",{method:"POST",headers:{"X-Browser-UUID":t,"X-IP-Based-Session":"true"},body:JSON.stringify({message:n,project_id:a,browser_uuid:t,session_id:t})}))},e,this)}));return function(n){return e.apply(this,arguments)}}()},{key:"trackCargo",value:function(){var e=u(l().m(function e(n){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/cargo/track",{method:"POST",body:JSON.stringify({tracking_number:n})}))},e,this)}));return function(n){return e.apply(this,arguments)}}()},{key:"getWidgetCustomization",value:function(){var e=u(l().m(function e(){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/widget-customization",{method:"GET"}))},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"testEndpoint",value:function(){var e=u(l().m(function e(n){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/test-endpoint",{method:"POST",body:JSON.stringify({endpoint:n})}))},e,this)}));return function(n){return e.apply(this,arguments)}}()},{key:"getBrowserUuid",value:function(){return G.getBrowserUuid()}},{key:"refreshBrowserUuid",value:function(){return G.refreshUuid()}},{key:"getUuidDebugInfo",value:function(){return null}},{key:"addTokens",value:function(){var e=u(l().m(function e(n,a){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/add-token",{method:"POST",body:JSON.stringify({user_id:n,tokens:a})}))},e,this)}));return function(n,a){return e.apply(this,arguments)}}()},{key:"exhaustTokens",value:function(){var e=u(l().m(function e(n){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/exhaust-token",{method:"POST",body:JSON.stringify({user_id:n})}))},e,this)}));return function(n){return e.apply(this,arguments)}}()},{key:"getUsage",value:function(){var e=u(l().m(function e(){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/subscription/usage",{method:"GET"}))},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getPlans",value:function(){var e=u(l().m(function e(){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/subscription/plans",{method:"GET"}))},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getBillingHistory",value:function(){var e=u(l().m(function e(){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/subscription/billing-history",{method:"GET"}))},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleAPIError",value:function(e){if(null!==e&&void 0!==e&&e.error)switch(e.error){case"NO_ACTIVE_PLAN":return"Aktif plan\u0131n\u0131z bulunmuyor. L\xfctfen bir plan sat\u0131n al\u0131n.";case"USAGE_TOKENS_EXPIRED":return"Kullan\u0131m token'lar\u0131n\u0131z\u0131n s\xfcresi dolmu\u015f. L\xfctfen plan\u0131n\u0131z\u0131 yenileyin.";case"INSUFFICIENT_TOKENS":return"Yetersiz kullan\u0131m token'\u0131. L\xfctfen daha fazla token sat\u0131n al\u0131n.";case"TOKEN_VALIDATION_ERROR":return"Token do\u011frulama hatas\u0131. L\xfctfen tekrar deneyin.";case"MISSING_PROJECT_ID":return"Proje ID eksik. L\xfctfen proje ayarlar\u0131n\u0131z\u0131 kontrol edin.";case"PROJECT_NOT_FOUND":return"Proje bulunamad\u0131. L\xfctfen proje ayarlar\u0131n\u0131z\u0131 kontrol edin.";case"USER_NOT_FOUND":return"Kullan\u0131c\u0131 bulunamad\u0131. L\xfctfen giri\u015f yap\u0131n.";default:return e.message||"Bilinmeyen bir hata olu\u015ftu."}return(null===e||void 0===e?void 0:e.message)||"Bilinmeyen bir hata olu\u015ftu."}},{key:"checkTokenStatus",value:function(){var e=u(l().m(function e(){var n,a;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.getUsage();case 1:if((n=e.v).success){e.n=2;break}return e.a(2,{canUse:!1,error:this.handleAPIError(n)});case 2:return a=n.data,e.a(2,{canUse:a.can_use_token&&!a.is_expired,usage:a,error:a.can_use_token?void 0:"Yetersiz token veya s\xfcresi dolmu\u015f"});case 3:return e.p=3,e.v,e.a(2,{canUse:!1,error:"Token durumu kontrol edilemedi"})}},e,this,[[0,3]])}));return function(){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}])}();Y.instance=void 0;var J=function(e,n){var a=g((0,f.useState)([]),2),t=a[0],r=a[1],s=g((0,f.useState)(!1),2),i=s[0],c=s[1],d=g((0,f.useState)(!1),2),m=d[0],p=d[1],v=g((0,f.useState)(""),2),y=v[0],k=v[1],b=g((0,f.useState)(null),2),N=b[0],_=b[1],w=(0,f.useRef)(null),S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=g((0,f.useState)(!1),2),a=n[0],t=n[1],r=g((0,f.useState)(null),2),s=r[0],i=r[1],o=Y.getInstance(),c=(0,f.useCallback)(function(){return G.getBrowserUuid()},[]),d=(0,f.useCallback)(function(e,n){return{type:"error",message:"API ba\u011flant\u0131s\u0131 kurulamad\u0131. L\xfctfen daha sonra tekrar deneyin.",products:[],intent:"error",confidence:0,suggestions:["Tekrar dene","Yard\u0131m al"]}},[]),m=(0,f.useCallback)(function(){var n=u(l().m(function n(a,r){var s,u,m,p,h,g,f,v,y,k,b,N,_,w,S;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,t(!0),i(null),h=c(),g=x(j("CHAT")),n.n=1,fetch(g,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Browser-UUID":h,"X-Project-ID":(null===(s=e.projectId)||void 0===s?void 0:s.toString())||"1401","X-IP-Based-Session":"true"},body:JSON.stringify({message:a,project_id:e.projectId||"1401",browser_uuid:h,session_id:h,context:r})});case 1:return f=n.v,n.n=2,f.json();case 2:if(v=n.v,console.log("API Response:",v),console.log("Products in response:",v.products),console.log("Data.products in response:",null===(u=v.data)||void 0===u?void 0:u.products),f.ok&&!1!==v.success){n.n=4;break}if(!v.error||!["NO_ACTIVE_PLAN","USAGE_TOKENS_EXPIRED","INSUFFICIENT_TOKENS","TOKEN_VALIDATION_ERROR"].includes(v.error)){n.n=3;break}return k=o.handleAPIError(v),b={type:"token_error",message:k,products:[],intent:"error",confidence:0,suggestions:["Plan sat\u0131n al","Token sat\u0131n al","Yard\u0131m al"],session_id:v.session_id||h,data:{error:v.error,redirect:v.redirect,tokens_remaining:v.tokens_remaining,tokens_used:v.tokens_used,tokens_total:v.tokens_total,usage_percentage:v.usage_percentage,reset_date:v.reset_date}},n.a(2,b);case 3:return N={type:v.type||"error",message:v.message||"Bir hata olu\u015ftu",products:(null===(y=v.data)||void 0===y?void 0:y.products)||v.products||[],intent:v.intent||v.type||"error",confidence:v.confidence||0,suggestions:[],session_id:v.session_id||h,data:v.data||v},n.a(2,N);case 4:return(_={type:v.type||"general",message:v.message||(null===(m=v.data)||void 0===m?void 0:m.message)||"\xdczg\xfcn\xfcm, \u015fu anda yan\u0131t veremiyorum.",products:(null===(p=v.data)||void 0===p?void 0:p.products)||v.products||[],intent:v.intent||v.type||"general",confidence:v.confidence||.8,suggestions:[],session_id:v.session_id||h,data:v.data||{}}).message&&""!==_.message.trim()||(_.message="\xdczg\xfcn\xfcm, \u015fu anda yan\u0131t veremiyorum."),_.products&&_.products.length>0&&("product_search"!==_.type&&"category_browse"!==_.type||(_.type="product_recommendation")),_.products&&_.products.length>0&&("product_search"===_.type||"category_browse"===_.type)&&(_.type="product_recommendation"),n.a(2,_);case 5:return n.p=5,S=n.v,w=V.handleAPIError(S,"AI Service"),i(w.message),n.a(2,d(a,r));case 6:return n.p=6,t(!1),n.f(6);case 7:return n.a(2)}},n,null,[[0,5,6,7]])}));return function(e,a){return n.apply(this,arguments)}}(),[c,d,e.projectId,o]),p=(0,f.useCallback)(function(){var e=u(l().m(function e(n,a){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,m(n,{sessionId:a}))},e)}));return function(n,a){return e.apply(this,arguments)}}(),[m]),h=(0,f.useCallback)(function(){var e=u(l().m(function e(n){var a,t;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch(x(j("FEEDBACK")),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)});case 1:if((a=e.v).ok){e.n=2;break}throw new Error("Feedback API Error: ".concat(a.status));case 2:return e.n=3,a.json();case 3:return e.a(2,e.v);case 4:e.p=4,t=e.v,V.handleAPIError(t,"Feedback Service"),i("Feedback g\xf6nderilemedi");case 5:return e.a(2)}},e,null,[[0,4]])}));return function(n){return e.apply(this,arguments)}}(),[]),v=(0,f.useCallback)(function(){var e=u(l().m(function e(n){var a,t;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch(x(j("PRODUCT_CLICK")),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)});case 1:if((a=e.v).ok){e.n=2;break}throw new Error("Product Click API Error: ".concat(a.status));case 2:return e.n=3,a.json();case 3:return e.a(2,e.v);case 4:e.p=4,t=e.v,V.handleAPIError(t,"Product Click Service"),i("\xdcr\xfcn t\u0131klama kaydedilemedi");case 5:return e.a(2)}},e,null,[[0,4]])}));return function(n){return e.apply(this,arguments)}}(),[]),y=(0,f.useCallback)(function(){var e=u(l().m(function e(n){var a,t;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch(x(j("CARGO_TRACKING")),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)});case 1:if((a=e.v).ok){e.n=2;break}throw new Error("Cargo Tracking API Error: ".concat(a.status));case 2:return e.n=3,a.json();case 3:return e.a(2,e.v);case 4:e.p=4,t=e.v,V.handleAPIError(t,"Cargo Tracking Service"),i("Kargo takip bilgisi al\u0131namad\u0131");case 5:return e.a(2)}},e,null,[[0,4]])}));return function(n){return e.apply(this,arguments)}}(),[]),k=(0,f.useCallback)(u(l().m(function e(){var n;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,o.checkTokenStatus();case 1:return e.a(2,e.v);case 2:return e.p=2,n=e.v,V.handleAPIError(n,"Token Status Check"),i("Token durumu kontrol edilemedi"),e.a(2,{canUse:!1,error:"Token durumu kontrol edilemedi"})}},e,null,[[0,2]])})),[o]),b=(0,f.useCallback)(u(l().m(function e(){var n;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,o.getUsage();case 1:return e.a(2,e.v);case 2:return e.p=2,n=e.v,V.handleAPIError(n,"Usage Information"),i("Kullan\u0131m bilgileri al\u0131namad\u0131"),e.a(2,{success:!1,error:"Kullan\u0131m bilgileri al\u0131namad\u0131"})}},e,null,[[0,2]])})),[o]),N=(0,f.useCallback)(u(l().m(function e(){var n;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,o.getPlans();case 1:return e.a(2,e.v);case 2:return e.p=2,n=e.v,V.handleAPIError(n,"Plans List"),i("Plan listesi al\u0131namad\u0131"),e.a(2,{success:!1,error:"Plan listesi al\u0131namad\u0131"})}},e,null,[[0,2]])})),[o]);return{generateResponse:p,generateAIResponse:m,sendFeedback:h,sendProductClick:v,sendCargoTracking:y,checkTokenStatus:k,getUsage:b,getPlans:N,isLoading:a,error:s,clearError:function(){return i(null)}}}({apiKey:e,projectId:n}),C=S.generateAIResponse,E=S.sendFeedback,T=S.isLoading,A=(0,f.useCallback)(function(){var e=G.refreshUuid();k(e);var n=G.getUuidInfo();n&&_(n.expires)},[]);(0,f.useEffect)(function(){var e=G.getBrowserUuid();k(e);var n=G.getUuidInfo();n&&_(n.expires)},[]),(0,f.useEffect)(function(){if(N){var e=setInterval(function(){new Date>=N&&A()},6e4);return function(){return clearInterval(e)}}},[N,A]);var I=(0,f.useCallback)(function(){var e=G.getUuidInfo();e&&e.isValid?_(e.expires):A()},[A]),D=(0,f.useCallback)(function(){G.clearUuid(),k(""),_(null)},[]),P=(0,f.useCallback)(function(e){var n=e.toLowerCase();return n.includes("\xfcr\xfcn")||n.includes("product")||n.includes("sat\u0131n al")?"product":n.includes("kargo")||n.includes("cargo")||n.includes("kargom")||n.includes("takip")||n.includes("tracking")?"cargo":n.includes("sipari\u015f")||n.includes("order")||n.includes("sipari\u015fim")?"order":n.includes("feedback")||n.includes("geri bildirim")?"feedback":"general"},[]),O=(0,f.useCallback)(function(e,n,a,s){if(console.log("addMessage called with:",{text:e,role:n,products:a,additionalData:s}),"agent"===n){var i=Date.now();if(t.slice(-3).some(function(a){return i-a.timestamp.getTime()<1e3&&a.content===e&&a.role===n}))return void console.log("Duplicate message prevented")}var c=o({id:"".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),content:e,role:n,timestamp:new Date,products:a||[]},s);"user"===n&&(c.protected=!0,c.protectionExpiry=new Date(Date.now()+1e4)),console.log("Setting messages, current count:",t.length,"new message:",c),r(function(e){var n=[].concat(h(e),[c]);return console.log("Updated messages count:",n.length),n}),p(!0)},[]),R=(0,f.useCallback)(function(){var e=u(l().m(function e(n){var a,t,s,i,o,d,u,m,p;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return c(!0),I(),a=P(n),t={id:"shimmer_".concat(Date.now()),role:"agent",content:"",type:"shimmer",shimmerType:a,timestamp:new Date},r(function(e){return[].concat(h(e),[t])}),e.p=1,o=1e3*Math.random()+1500,e.n=2,new Promise(function(e){return setTimeout(e,o)});case 2:return e.n=3,C(n);case 3:return d=e.v,console.log("AI Response:",d),console.log("AI Response products:",d.products),console.log("AI Response data.products:",null===(s=d.data)||void 0===s?void 0:s.products),d.products&&0!==d.products.length||d.data&&d.data.products&&d.data.products.length>0&&(d.products=d.data.products),u={type:d.type||"general",intent:d.intent||d.type||"general",suggestions:d.suggestions||[],data:d.data||{},session_id:y},m=d.products||(null===(i=d.data)||void 0===i?void 0:i.products)||[],e.n=4,new Promise(function(e){return setTimeout(e,300)});case 4:r(function(e){return e.filter(function(e){return"shimmer"!==e.type&&(e.protected&&e.protectionExpiry&&(e.protectionExpiry,new Date),!0)})}),p=d.message||d.type||"\xdczg\xfcn\xfcm, \u015fu anda yan\u0131t veremiyorum.",console.log("Adding message:",p,"Role: agent"),O(p,"agent",m,u),e.n=6;break;case 5:e.p=5,e.v,r(function(e){return e.filter(function(e){return"shimmer"!==e.type&&(e.protected&&e.protectionExpiry&&(e.protectionExpiry,new Date),!0)})}),O("\xdczg\xfcn\xfcm, \u015fu anda yan\u0131t \xfcretemiyorum. L\xfctfen daha sonra tekrar deneyin.","agent");case 6:return e.p=6,c(!1),e.f(6);case 7:return e.a(2)}},e,null,[[1,5,6,7]])}));return function(n){return e.apply(this,arguments)}}(),[C,O,y,I,P]),B=(0,f.useCallback)(function(){var e=u(l().m(function e(n){return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n.trim()){e.n=1;break}return e.a(2);case 1:return O(n,"user"),e.n=2,new Promise(function(e){return setTimeout(e,100)});case 2:return e.p=2,e.n=3,R(n);case 3:e.n=5;break;case 4:e.p=4,e.v;case 5:return e.a(2)}},e,null,[[2,4]])}));return function(n){return e.apply(this,arguments)}}(),[O,R]),L=(0,f.useCallback)(function(e){O('"'.concat(e.name,'" \xfcr\xfcn\xfcn\xfcn detaylar\u0131n\u0131 g\xf6r\xfcnt\xfcl\xfcyorsunuz.'),"agent",[e],{type:"product_detail",product:e})},[O]),z=(0,f.useCallback)(function(e){E(e)},[E]),U=(0,f.useCallback)(function(e){},[]);return(0,f.useEffect)(function(){m&&w.current&&(w.current.scrollTop=w.current.scrollHeight,p(!1))},[m,t]),(0,f.useEffect)(function(){w.current&&(w.current.scrollTop=w.current.scrollHeight)},[t]),(0,f.useEffect)(function(){U(i)},[i,U]),{messages:t,isTyping:i,aiLoading:T,chatContentRef:w,sendMessage:B,handleProductClick:L,handleFeedback:z,addMessage:O,generateAIResponse:R,browserUuid:y,sessionExpiry:N,refreshBrowserUuid:A,refreshSession:I,clearSession:D}},X=function(e){var n=e.messages,a=e.onProductClick,t=e.onFeedback,r=e.welcomeMessage,s=e.widgetCustomization,i=e.onAddMessage,o=e.onSendMessage,c=J().chatContentRef,l=(null===s||void 0===s?void 0:s.ai_name)||"ConvState AI",d="Merhaba ben ".concat(l,", sizin tercihlerinize g\xf6re \xfcr\xfcn \xf6nerileri sunuyorum. Size nas\u0131l yard\u0131mc\u0131 olabilirim?"),u=r||d;return(0,w.jsxs)("div",{className:"chat-content",ref:c,children:[(0,w.jsx)(U,{welcomeText:u,agentName:l,logoUrl:k().small}),n.map(function(e){return(0,w.jsx)(L,{message:e,onProductClick:a,onFeedback:t,onAddMessage:i,onSendMessage:o},e.id)})]})},Z=!1,$=null,Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e3;return{canSend:(0,f.useCallback)(function(){return!Z},[]),startCooldown:(0,f.useCallback)(function(){return!Z&&(Z=!0,$&&clearTimeout($),$=setTimeout(function(){Z=!1},e),!0)},[e]),getRemainingTime:(0,f.useCallback)(function(){return Z?e:0},[e]),isOnCooldown:Z}},ee=function(e){var n=e.onSendMessage,a=e.disabled,t=void 0!==a&&a,r=e.placeholder,s=void 0===r?"Message...":r,i=e.setMessage,c=g((0,f.useState)(""),2),l=c[0],d=c[1],u=g((0,f.useState)(!1),2),m=u[0],p=u[1],h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=g((0,f.useState)(!1),2),a=n[0],t=n[1],r=g((0,f.useState)(""),2),s=r[0],i=r[1],c=g((0,f.useState)(null),2),l=c[0],d=c[1],u=(0,f.useRef)(null);return{isListening:a,transcript:s,error:l,startListening:(0,f.useCallback)(function(n){var a=o({lang:"tr-TR",continuous:!1,interimResults:!1},e);if("webkitSpeechRecognition"in window||"SpeechRecognition"in window)try{var r=new(window.SpeechRecognition||window.webkitSpeechRecognition);r.lang=a.lang,r.continuous=a.continuous,r.interimResults=a.interimResults,u.current=r,r.onstart=function(){t(!0),d(null),i("")},r.onresult=function(e){for(var a="",t="",r=e.resultIndex;r<e.results.length;r++){var s=e.results[r][0].transcript;e.results[r].isFinal?a+=s:t+=s}i(a||t),n&&a&&n(a)},r.onend=function(){t(!1),u.current=null},r.onerror=function(e){d("Ses tan\u0131ma hatas\u0131: ".concat(e.error)),t(!1),u.current=null},r.start()}catch(s){d("Ses tan\u0131ma ba\u015flat\u0131lamad\u0131.")}else d("Bu taray\u0131c\u0131da speech-to-text desteklenmiyor.")},[e]),stopListening:(0,f.useCallback)(function(){u.current&&(u.current.stop(),u.current=null),t(!1)},[]),reset:(0,f.useCallback)(function(){i(""),d(null),t(!1),u.current&&(u.current.stop(),u.current=null)},[])}}(),v=h.isListening,x=h.startListening,j=h.stopListening,y=h.error,k=Q(3e3),b=k.canSend,N=k.startCooldown,_=k.isOnCooldown,S=function(e){d(e),i&&i(e)},C=function(){if(l.trim()&&!t&&b()){if(!N())return;p(!0),n(l.trim()),d(""),setTimeout(function(){p(!1)},3e3)}};return(0,w.jsxs)("div",{className:"input-area",children:[(0,w.jsxs)("div",{className:"input-wrapper",children:[(0,w.jsx)("input",{type:"text",value:l,onChange:function(e){return S(e.target.value)},onKeyPress:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),C())},placeholder:s,disabled:t,id:"messageInput"}),(0,w.jsx)("button",{onClick:C,disabled:t||!l.trim()||m||_,className:"send-button ".concat(m?"sending":""),title:m?"G\xf6nderiliyor...":_?"L\xfctfen bekleyin...":"Mesaj G\xf6nder",children:(0,w.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[(0,w.jsx)("path",{d:"M22 2L11 13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,w.jsx)("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})]}),y&&(0,w.jsx)("div",{className:"voice-error",style:{color:"#ef4444",fontSize:"0.75rem",marginBottom:"4px"},children:y}),(0,w.jsx)("button",{className:"voice-button ".concat(v?"recording":""),onClick:function(){v?j():x(function(e){var n=l.trim(),a=n?"".concat(n," ").concat(e):e;S(a)})},title:v?"Ses Kayd\u0131n\u0131 Durdur":"Sesli Mesaj Kaydet",children:v?(0,w.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,w.jsxs)("rect",{x:"2",y:"12",width:"2",height:"2",fill:"currentColor",className:"voice-wave wave-1",children:[(0,w.jsx)("animate",{attributeName:"height",values:"2;8;2",dur:"0.6s",repeatCount:"indefinite"}),(0,w.jsx)("animate",{attributeName:"y",values:"12;8;12",dur:"0.6s",repeatCount:"indefinite"})]}),(0,w.jsxs)("rect",{x:"6",y:"10",width:"2",height:"6",fill:"currentColor",className:"voice-wave wave-2",children:[(0,w.jsx)("animate",{attributeName:"height",values:"6;12;6",dur:"0.8s",repeatCount:"indefinite"}),(0,w.jsx)("animate",{attributeName:"y",values:"10;6;10",dur:"0.8s",repeatCount:"indefinite"})]}),(0,w.jsxs)("rect",{x:"10",y:"8",width:"2",height:"8",fill:"currentColor",className:"voice-wave wave-3",children:[(0,w.jsx)("animate",{attributeName:"height",values:"8;16;8",dur:"0.7s",repeatCount:"indefinite"}),(0,w.jsx)("animate",{attributeName:"y",values:"8;4;8",dur:"0.7s",repeatCount:"indefinite"})]}),(0,w.jsxs)("rect",{x:"14",y:"10",width:"2",height:"6",fill:"currentColor",className:"voice-wave wave-4",children:[(0,w.jsx)("animate",{attributeName:"height",values:"6;12;6",dur:"0.9s",repeatCount:"indefinite"}),(0,w.jsx)("animate",{attributeName:"y",values:"10;6;10",dur:"0.9s",repeatCount:"indefinite"})]}),(0,w.jsxs)("rect",{x:"18",y:"12",width:"2",height:"2",fill:"currentColor",className:"voice-wave wave-5",children:[(0,w.jsx)("animate",{attributeName:"height",values:"2;8;2",dur:"0.65s",repeatCount:"indefinite"}),(0,w.jsx)("animate",{attributeName:"y",values:"12;8;12",dur:"0.65s",repeatCount:"indefinite"})]})]}):(0,w.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,w.jsx)("path",{d:"M12 1C11.2044 1 10.4413 1.31607 9.87868 1.87868C9.31607 2.44129 9 3.20435 9 4V12C9 12.7956 9.31607 13.5587 9.87868 14.1213C10.4413 14.6839 11.2044 15 12 15C12.7956 15 13.5587 14.6839 14.1213 14.1213C14.6839 13.5587 15 12.7956 15 12V4C15 3.20435 14.6839 2.44129 14.1213 1.87868C13.5587 1.31607 12.7956 1 12 1Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,w.jsx)("path",{d:"M19 10V12C19 13.8565 18.2625 15.637 16.9497 16.9497C15.637 18.2625 13.8565 19 12 19C10.1435 19 8.36301 18.2625 7.05025 16.9497C5.7375 15.637 5 13.8565 5 12V10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,w.jsx)("path",{d:"M12 19V23",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,w.jsx)("path",{d:"M8 23H16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})]})},ne=function(e){var n=e.onAction,a=g((0,f.useState)(!1),2),t=a[0],r=a[1],s=Q(3e3),i=s.canSend,o=s.startCooldown,c=s.isOnCooldown,l=(0,f.useRef)(null),d=g((0,f.useState)(!1),2),u=d[0],m=d[1],p=g((0,f.useState)(0),2),h=p[0],v=p[1],x=g((0,f.useState)(0),2),j=x[0],y=x[1];return(0,f.useEffect)(function(){var e=function(){m(!1)};return document.addEventListener("mouseup",e),function(){document.removeEventListener("mouseup",e)}},[]),(0,w.jsx)("div",{className:"action-buttons",children:(0,w.jsx)("div",{className:"action-buttons-scroll-container",ref:l,onMouseDown:function(e){l.current&&(m(!0),v(e.pageX-l.current.offsetLeft),y(l.current.scrollLeft),e.preventDefault())},onMouseMove:function(e){if(u&&l.current){var n=2*(e.pageX-l.current.offsetLeft-h);l.current.scrollLeft=j-n}},onMouseUp:function(){m(!1)},onMouseLeave:function(){m(!1)},style:{cursor:u?"grabbing":"grab"},children:(0,w.jsx)("div",{className:"action-buttons-wrapper",children:["Rastgele bir \xfcr\xfcn \xf6ner.","Kargom nerede?","Sipari\u015fim nerede?"].map(function(e,a){return(0,w.jsx)("button",{className:"secondary-button ".concat(t?"processing":""),onClick:function(){return function(e){i()&&o()&&(r(!0),n(e),setTimeout(function(){r(!1)},3e3))}(e)},disabled:t||c,title:t?"\u0130\u015fleniyor...":c?"L\xfctfen bekleyin...":e,children:e},a)})})})})},ae=function(){return(0,w.jsxs)("div",{className:"chat-footer",children:[(0,w.jsx)("a",{href:"https://convstateai.com",target:"_blank",rel:"noopener noreferrer",className:"privacy-link",children:"ConvState AI"}),(0,w.jsx)("span",{className:"separator",children:"\u2022"}),(0,w.jsx)("span",{className:"footer-text",children:"Sizin dijital asistan\u0131n\u0131z"})]})},te=function(e){var n=e.isVisible,a=e.onClose,t=g((0,f.useState)([]),2),r=t[0],s=t[1],i=g((0,f.useState)(!0),2),o=i[0],c=i[1],d=g((0,f.useState)(null),2),m=d[0],p=d[1];(0,f.useEffect)(function(){n&&h()},[n]);var h=function(){var e=u(l().m(function e(){var n,a,t,r,i,o;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,c(!0),p(null),n=x("/api"),a="undefined"!==typeof window&&window.WIDGET_PROJECT_ID||"1",e.n=1,fetch("".concat(n,"/campaigns?project_id=").concat(a),{headers:{Accept:"application/json","Content-Type":"application/json"}});case 1:if((t=e.v).ok){e.n=3;break}if(404!==t.status){e.n=2;break}return s([]),p(null),e.a(2);case 2:throw new Error("Kampanyalar y\xfcklenirken hata olu\u015ftu: ".concat(t.status));case 3:return e.n=4,t.text();case 4:r=e.v,e.p=5,i=JSON.parse(r),e.n=7;break;case 6:throw e.p=6,e.v,new Error("API response JSON format\u0131nda de\u011fil");case 7:i.success?s(i.data||[]):p(i.message||"Kampanyalar y\xfcklenemedi"),e.n=9;break;case 8:e.p=8,o=e.v,p(o instanceof Error?o.message:"Bilinmeyen hata olu\u015ftu");case 9:return e.p=9,c(!1),e.f(9);case 10:return e.a(2)}},e,null,[[5,6],[0,8,9,10]])}));return function(){return e.apply(this,arguments)}}(),v=function(e){if(!e)return"S\xfcrekli";try{return new Date(e).toLocaleDateString("tr-TR")}catch(n){return"Ge\xe7ersiz tarih"}};return o?(0,w.jsx)("div",{className:"campaign-tab-content",children:(0,w.jsxs)("div",{className:"campaign-content",children:[(0,w.jsxs)("div",{className:"campaign-item shimmer",children:[(0,w.jsxs)("div",{className:"campaign-item-header",children:[(0,w.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,w.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]}),(0,w.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full mb-2"}),(0,w.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]}),(0,w.jsxs)("div",{className:"campaign-item shimmer",children:[(0,w.jsxs)("div",{className:"campaign-item-header",children:[(0,w.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-2"}),(0,w.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/3"})]}),(0,w.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full mb-2"}),(0,w.jsx)("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]})}):m?(0,w.jsxs)("div",{className:"campaign-tab-content",children:[(0,w.jsx)("div",{className:"campaign-content",children:(0,w.jsxs)("div",{className:"campaign-item error-state",children:[(0,w.jsxs)("div",{className:"campaign-item-header",children:[(0,w.jsx)("h4",{className:"text-red-600",children:"\u26a0\ufe0f Hata Olu\u015ftu"}),(0,w.jsx)("span",{className:"campaign-category error-category",children:"Sistem Hatas\u0131"})]}),(0,w.jsx)("p",{className:"campaign-description text-red-500",children:m}),(0,w.jsx)("div",{className:"campaign-item-footer",children:(0,w.jsx)("span",{className:"campaign-validity",children:"\u015eimdi"})}),(0,w.jsx)("div",{className:"campaign-details",children:(0,w.jsx)("button",{onClick:h,className:"campaign-retry-btn",children:"\ud83d\udd04 Tekrar Dene"})})]})}),(0,w.jsx)("div",{className:"campaign-footer",children:(0,w.jsx)("button",{className:"campaign-action-btn",onClick:a,children:"\ud83d\udcac Chat'e D\xf6n"})})]}):r&&0!==r.length?(0,w.jsxs)("div",{className:"campaign-tab-content",children:[(0,w.jsx)("div",{className:"campaign-content",children:r.map(function(e){return(0,w.jsxs)("div",{className:"campaign-item",children:[(0,w.jsxs)("div",{className:"campaign-item-header",children:[(0,w.jsx)("h4",{children:e.title}),(0,w.jsx)("span",{className:"campaign-category",children:e.category})]}),(0,w.jsx)("p",{className:"campaign-description",children:e.description.replace(/\\n\\n/g," ").trim()}),(0,w.jsx)("div",{className:"campaign-item-footer",children:(0,w.jsxs)("span",{className:"campaign-validity",children:["Ge\xe7erli: ",v(e.end_date)]})}),e.minimum_order_amount&&(0,w.jsx)("div",{className:"campaign-details",children:(0,w.jsxs)("small",{className:"text-gray-500",children:["Min. Sipari\u015f: ",e.minimum_order_amount," TL"]})})]},e.id)})}),(0,w.jsx)("div",{className:"campaign-footer",children:(0,w.jsx)("button",{className:"campaign-action-btn",onClick:a,children:"\ud83d\udcac Chat'e D\xf6n"})})]}):(0,w.jsxs)("div",{className:"campaign-tab-content",children:[(0,w.jsx)("div",{className:"campaign-content",children:(0,w.jsx)("div",{className:"campaign-item empty-state",children:(0,w.jsxs)("div",{className:"text-center py-8",children:[(0,w.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:"\ud83d\udce2"}),(0,w.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Hen\xfcz Kampanya Yok"}),(0,w.jsx)("p",{className:"text-gray-500",children:"Bu site i\xe7in hen\xfcz aktif kampanya bulunmuyor. Y\xf6netici panelinden kampanya eklenebilir."})]})})}),(0,w.jsx)("div",{className:"campaign-footer",children:(0,w.jsx)("button",{className:"campaign-action-btn",onClick:a,children:"\ud83d\udcac Chat'e D\xf6n"})})]})},re=function(e){var n=e.isVisible,a=e.onClose,t=g((0,f.useState)(null),2),r=t[0],s=t[1],i=g((0,f.useState)([]),2),c=i[0],d=i[1],m=g((0,f.useState)(!0),2),p=m[0],h=m[1],v=g((0,f.useState)(null),2),j=v[0],y=v[1];(0,f.useEffect)(function(){n&&k()},[n]);var k=function(){var e=u(l().m(function e(){var n,a,t,r,s,i;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,h(!0),y(null),n=x("/api"),a="undefined"!==typeof window&&window.WIDGET_PROJECT_ID||"1",e.n=1,fetch("".concat(n,"/faqs?project_id=").concat(a),{headers:{Accept:"application/json","Content-Type":"application/json"}});case 1:if((t=e.v).ok){e.n=3;break}if(404!==t.status){e.n=2;break}return d([]),y(null),e.a(2);case 2:throw new Error("SSS y\xfcklenirken hata olu\u015ftu: ".concat(t.status));case 3:return e.n=4,t.text();case 4:r=e.v,e.p=5,s=JSON.parse(r),e.n=7;break;case 6:throw e.p=6,e.v,new Error("API response JSON format\u0131nda de\u011fil");case 7:s.success?d(s.data||[]):y(s.message||"SSS y\xfcklenemedi"),e.n=9;break;case 8:e.p=8,i=e.v,y(i instanceof Error?i.message:"Bilinmeyen hata olu\u015ftu");case 9:return e.p=9,h(!1),e.f(9);case 10:return e.a(2)}},e,null,[[5,6],[0,8,9,10]])}));return function(){return e.apply(this,arguments)}}(),b=function(){var e=u(l().m(function e(n){var a;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,a=x("/api"),e.n=1,fetch("".concat(a,"/faqs/").concat(n,"/helpful"),{method:"POST",headers:{"Content-Type":"application/json"}});case 1:d(function(e){return e.map(function(e){return e.id===n?o(o({},e),{},{helpful_count:e.helpful_count+1}):e})}),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(n){return e.apply(this,arguments)}}(),N=function(){var e=u(l().m(function e(n){var a;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,a=x("/api"),e.n=1,fetch("".concat(a,"/faqs/").concat(n,"/not-helpful"),{method:"POST",headers:{"Content-Type":"application/json"}});case 1:d(function(e){return e.map(function(e){return e.id===n?o(o({},e),{},{not_helpful_count:e.not_helpful_count+1}):e})}),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(n){return e.apply(this,arguments)}}();return p?(0,w.jsx)("div",{className:"campaign-tab-content",children:(0,w.jsxs)("div",{className:"campaign-content",children:[(0,w.jsxs)("div",{className:"campaign-item shimmer",children:[(0,w.jsxs)("div",{className:"campaign-item-header",children:[(0,w.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,w.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]}),(0,w.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full mb-2"}),(0,w.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]}),(0,w.jsxs)("div",{className:"campaign-item shimmer",children:[(0,w.jsxs)("div",{className:"campaign-item-header",children:[(0,w.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-2"}),(0,w.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/3"})]}),(0,w.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full mb-2"}),(0,w.jsx)("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]})}):j?(0,w.jsxs)("div",{className:"campaign-tab-content",children:[(0,w.jsx)("div",{className:"campaign-content",children:(0,w.jsxs)("div",{className:"campaign-item error-state",children:[(0,w.jsxs)("div",{className:"campaign-item-header",children:[(0,w.jsx)("h4",{className:"text-red-600",children:"\u26a0\ufe0f Hata Olu\u015ftu"}),(0,w.jsx)("span",{className:"campaign-category error-category",children:"Sistem Hatas\u0131"})]}),(0,w.jsx)("p",{className:"campaign-description text-red-500",children:j}),(0,w.jsx)("div",{className:"campaign-item-footer",children:(0,w.jsx)("span",{className:"campaign-validity",children:"\u015eimdi"})}),(0,w.jsx)("div",{className:"campaign-details",children:(0,w.jsx)("button",{onClick:k,className:"campaign-retry-btn",children:"\ud83d\udd04 Tekrar Dene"})})]})}),(0,w.jsx)("div",{className:"campaign-footer",children:(0,w.jsx)("button",{className:"campaign-action-btn",onClick:a,children:"\ud83d\udcac Chat'e D\xf6n"})})]}):c&&0!==c.length?(0,w.jsxs)("div",{className:"campaign-tab-content",children:[(0,w.jsx)("div",{className:"campaign-content",children:c.map(function(e){return(0,w.jsxs)("div",{className:"campaign-item",onClick:function(){return n=e.id,void s(r===n?null:n);var n},children:[(0,w.jsxs)("div",{className:"campaign-item-header",children:[(0,w.jsx)("h4",{children:e.title}),(0,w.jsx)("span",{className:"campaign-category",children:e.category})]}),(0,w.jsx)("p",{className:"campaign-description",children:e.description.replace(/\\n\\n/g," ").trim()}),(0,w.jsx)("div",{className:"campaign-item-footer",children:(0,w.jsx)("span",{className:"campaign-validity",children:r===e.id?"Detaylar A\xe7\u0131k":"Detaylar i\xe7in t\u0131klay\u0131n"})}),r===e.id&&(0,w.jsx)("div",{className:"faq-answer-expanded",children:(0,w.jsxs)("div",{className:"faq-answer-content",children:[(0,w.jsx)("p",{children:e.answer}),(0,w.jsx)("div",{className:"faq-feedback mt-4 pt-4 border-t border-gray-200",children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsx)("div",{className:"text-sm text-gray-500",children:"Bu bilgi faydal\u0131 m\u0131yd\u0131?"}),(0,w.jsxs)("div",{className:"faq-feedback-buttons",children:[(0,w.jsxs)("button",{onClick:function(n){n.stopPropagation(),b(e.id)},className:"faq-helpful-btn helpful",children:["\ud83d\udc4d Faydal\u0131 (",e.helpful_count,")"]}),(0,w.jsxs)("button",{onClick:function(n){n.stopPropagation(),N(e.id)},className:"faq-helpful-btn not-helpful",children:["\ud83d\udc4e Faydal\u0131 De\u011fil (",e.not_helpful_count,")"]})]})]})})]})})]},e.id)})}),(0,w.jsx)("div",{className:"campaign-footer",children:(0,w.jsx)("button",{className:"campaign-action-btn",onClick:a,children:"\ud83d\udcac Chat'e D\xf6n"})})]}):(0,w.jsxs)("div",{className:"campaign-tab-content",children:[(0,w.jsx)("div",{className:"campaign-content",children:(0,w.jsx)("div",{className:"campaign-item empty-state",children:(0,w.jsxs)("div",{className:"text-center py-8",children:[(0,w.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:"\u2753"}),(0,w.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Hen\xfcz SSS Yok"}),(0,w.jsx)("p",{className:"text-gray-500",children:"Bu site i\xe7in hen\xfcz s\u0131k sorulan soru eklenmemi\u015f. Y\xf6netici panelinden SSS eklenebilir."})]})})}),(0,w.jsx)("div",{className:"campaign-footer",children:(0,w.jsx)("button",{className:"campaign-action-btn",onClick:a,children:"\ud83d\udcac Chat'e D\xf6n"})})]})},se=function(e){var n=e.isVisible,a=e.onClose,t=e.onOpenChat,r=e.settings,s=g((0,f.useState)(!1),2),i=s[0],o=s[1],c=g((0,f.useState)(!1),2),l=c[0],d=c[1],u=(0,f.useCallback)(function(){d(!0),setTimeout(function(){a(),d(!1),o(!1)},300)},[a]);(0,f.useEffect)(function(){n&&r&&o(!0)},[n,r,u]);if(!n||!r)return null;return(0,w.jsx)("div",{className:"notification-widget ".concat(l?"notification-widget-closing":i?"notification-widget-".concat(r.animation_type):""),onClick:function(){t&&t(),u()},children:(0,w.jsxs)("div",{className:"notification-speech-bubble",children:[(0,w.jsxs)("div",{className:"notification-content",children:[(0,w.jsx)("div",{className:"notification-header",children:(0,w.jsx)("span",{className:"notification-sender",children:(null===r||void 0===r?void 0:r.ai_name)||"ConvState AI"})}),(0,w.jsx)("div",{className:"notification-message",children:r.message_text})]}),r.show_close_button&&(0,w.jsx)("button",{className:"notification-close-btn",onClick:function(e){e.stopPropagation(),u()},title:"Kapat",children:"\xd7"})]})})},ie=function(e){var n,a=e.message,t=e.onRetry,r=e.onDismiss,s=g((0,f.useState)(!0),2),i=s[0],o=s[1],c=g((0,f.useState)(!1),2),l=c[0],d=c[1],u=a.data||{},m={type:(null===(n=u.error)||void 0===n?void 0:n.toLowerCase())||"unknown",status:u.status,message:a.message||a.content||"Unknown error",details:u.details,timestamp:new Date(a.timestamp).getTime()},p=u.config||{showRetry:!0,showDetails:!1,autoHide:!0,hideDelay:5e3};(0,f.useEffect)(function(){if(p.autoHide&&p.hideDelay>0){var e=setTimeout(function(){o(!1),null===r||void 0===r||r()},p.hideDelay);return function(){return clearTimeout(e)}}},[p.autoHide,p.hideDelay,r]);var h=function(){switch(m.type){case"network":return"#3B82F6";case"server":return"#EF4444";case"client":return"#F59E0B";case"timeout":return"#8B5CF6";default:return"#6B7280"}};return i?(0,w.jsxs)("div",{className:"api-error-message",style:{borderLeftColor:h()},children:[(0,w.jsxs)("div",{className:"api-error-header",children:[(0,w.jsx)("div",{className:"api-error-icon",style:{color:h()},children:function(){switch(m.type){case"network":return"\ud83c\udf10";case"server":return"\ud83d\udd27";case"client":return"\u26a0\ufe0f";case"timeout":return"\u23f0";default:return"\u274c"}}()}),(0,w.jsxs)("div",{className:"api-error-content",children:[(0,w.jsx)("h3",{className:"api-error-title",children:function(){switch(m.type){case"network":return"Ba\u011flant\u0131 Hatas\u0131";case"server":return"Sunucu Hatas\u0131";case"client":return"\u0130stek Hatas\u0131";case"timeout":return"Zaman A\u015f\u0131m\u0131";default:return"Hata"}}()}),(0,w.jsx)("p",{className:"api-error-description",children:m.message}),m.status&&(0,w.jsxs)("div",{className:"api-error-status",children:[(0,w.jsx)("span",{className:"status-label",children:"Durum Kodu:"}),(0,w.jsx)("span",{className:"status-code",children:m.status})]})]}),(0,w.jsxs)("div",{className:"api-error-actions",children:[p.showDetails&&m.details&&(0,w.jsx)("button",{className:"api-error-details-btn",onClick:function(){return d(!l)},title:"Detaylar\u0131 g\xf6ster/gizle",children:l?"\ud83d\udc41\ufe0f\u200d\ud83d\udde8\ufe0f":"\ud83d\udc41\ufe0f"}),(0,w.jsx)("button",{className:"api-error-close-btn",onClick:function(){o(!1),null===r||void 0===r||r()},title:"Kapat",children:"\u2715"})]})]}),l&&m.details&&(0,w.jsxs)("div",{className:"api-error-details",children:[(0,w.jsx)("h4",{children:"Hata Detaylar\u0131:"}),(0,w.jsx)("pre",{className:"api-error-details-content",children:JSON.stringify(m.details,null,2)})]}),(0,w.jsxs)("div",{className:"api-error-footer",children:[p.showRetry&&(0,w.jsx)("button",{className:"api-error-retry-btn",onClick:function(){null===t||void 0===t||t(),o(!1)},children:"\ud83d\udd04 Tekrar Dene"}),p.redirectUrl&&(0,w.jsxs)("button",{className:"api-error-redirect-btn",onClick:function(){p.redirectUrl&&(window.location.href=p.redirectUrl)},children:["\ud83d\udd17 ",p.redirectUrl.includes("login")?"Giri\u015f Yap":"Y\xf6nlendir"]}),p.autoHide&&(0,w.jsx)("div",{className:"api-error-auto-hide",children:(0,w.jsxs)("span",{children:["Bu mesaj ",Math.ceil(p.hideDelay/1e3)," saniye sonra kapanacak"]})})]})]}):null},oe=function(e){var n,a=e.config,t=e.onEvent,r=(e.onFeedback,e.onToggleChat,g((0,f.useState)(!0),2)),s=r[0],i=r[1],c=g((0,f.useState)(!1),2),d=c[0],m=c[1],p=g((0,f.useState)(!1),2),v=p[0],j=p[1],y=g((0,f.useState)(!1),2),b=y[0],N=y[1],_=g((0,f.useState)(!1),2),S=_[0],C=_[1],E=g((0,f.useState)(!1),2),T=E[0],A=E[1],I=g((0,f.useState)(null),2),D=I[0],P=I[1],O=g((0,f.useState)({campaigns:!1,faqs:!1,loading:!0}),2),R=O[0],B=O[1],L=g((0,f.useState)([]),2),z=L[0],U=L[1],F=g((0,f.useState)({ai_name:"ConvState AI",welcome_message:"Merhaba ben Kadir, senin dijital asistan\u0131n\u0131m. Sana nas\u0131l yard\u0131mc\u0131 olabilirim?",ai_personality:"friendly",theme_color:"#3B82F6",font_family:"Inter",primary_color:"#3B82F6",secondary_color:"#6B7280",language:"tr",rate_limit_per_minute:10,api_timeout_seconds:10,max_retry_attempts:2,enable_typing_indicator:!0,enable_sound_notifications:!1}),2),K=F[0],M=F[1],H=J(void 0,null===a||void 0===a?void 0:a.projectId),G=H.messages,W=H.sendMessage,q=H.handleProductClick,Y=H.handleFeedback,Z=H.addMessage,$=(0,f.useCallback)(function(){if("undefined"!==typeof document){var e=document.documentElement;e.style.setProperty("--widget-primary-color",K.primary_color),e.style.setProperty("--widget-secondary-color",K.secondary_color),e.style.setProperty("--widget-theme-color",K.theme_color),e.style.setProperty("--widget-font-family",K.font_family),K.logo_url&&e.style.setProperty("--widget-logo-url","url(".concat(K.logo_url,")"))}},[K]);(0,f.useEffect)(function(){$()},[$]),(0,f.useEffect)(function(){return V.onError(function(e){var n=V.createErrorMessage(e);U(function(e){return[].concat(h(e),[n])})})},[]);var Q=(0,f.useCallback)(u(l().m(function e(){var n,t,r,s,i,o,c,d,u,m;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n=x("/api"),t=(null===a||void 0===a?void 0:a.projectId)||"1",e.n=1,Promise.allSettled([fetch("".concat(n,"/campaigns/check-availability?project_id=").concat(t),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","X-Project-ID":t}}),fetch("".concat(n,"/faqs/check-availability?project_id=").concat(t),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","X-Project-ID":t}})]);case 1:if(r=e.v,s=g(r,2),i=s[0],o=s[1],c=!1,d=!1,"fulfilled"!==i.status||!i.value.ok){e.n=3;break}return e.n=2,i.value.json();case 2:u=e.v,c=u.success&&u.has_campaigns;case 3:if("fulfilled"!==o.status||!o.value.ok){e.n=5;break}return e.n=4,o.value.json();case 4:m=e.v,d=m.success&&m.has_faqs;case 5:B({campaigns:c,faqs:d,loading:!1}),e.n=7;break;case 6:e.p=6,e.v,B({campaigns:!1,faqs:!1,loading:!1});case 7:return e.a(2)}},e,null,[[0,6]])})),[]),oe=function(){var e=u(l().m(function e(){var n,a,t,r,s,i,c,d,u,m,p,h,g,f,v;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n="undefined"!==typeof window&&window.WIDGET_CONFIG?window.WIDGET_CONFIG:{DEFAULT_AI_NAME:"ConvState AI",DEFAULT_WELCOME_MESSAGE:"Merhaba! Size nas\u0131l yard\u0131mc\u0131 olabilirim?"},e.p=1,r=(null===(a=window.convstateaiConfig)||void 0===a?void 0:a.projectId)||(null===n||void 0===n?void 0:n.projectId)||"2",s=(null===(t=window.convstateaiConfig)||void 0===t?void 0:t.customizationToken)||(null===n||void 0===n?void 0:n.customizationToken)){e.n=2;break}throw new Error("Customization token not found");case 2:return i=x("/api/widget-customization?projectId=".concat(r,"&customizationToken=").concat(s)),e.n=3,fetch(i,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json","X-Project-ID":r}});case 3:if(!(c=e.v).ok){e.n=6;break}return e.n=4,c.json();case 4:if(!(d=e.v).success||!d.data){e.n=5;break}return u=d.data.widgetCustomization||d.data,m=d.data.apiEndpoints||{},p=d.data.isCargoEnabled||!1,h=d.data.isOrderEnabled||!1,g=u.customization_data,f={ai_personality:"friendly",theme_color:"#3B82F6",font_family:"Inter",primary_color:"#3B82F6",secondary_color:"#6B7280",language:"tr",rate_limit_per_minute:10,api_timeout_seconds:10,max_retry_attempts:2,enable_typing_indicator:!0,enable_sound_notifications:!1},v=g&&"object"===typeof g?o(o({},f),g):f,console.log("Convstateai ba\u015flat\u0131l\u0131yor"),M({ai_name:u.ai_name||n.DEFAULT_AI_NAME,welcome_message:u.welcome_message||n.DEFAULT_WELCOME_MESSAGE,ai_personality:v.ai_personality,theme_color:u.theme_color||v.theme_color,font_family:u.font_family||v.font_family,primary_color:u.primary_color||v.primary_color,secondary_color:u.secondary_color||v.secondary_color,language:u.language||v.language,rate_limit_per_minute:v.rate_limit_per_minute,api_timeout_seconds:v.api_timeout_seconds,max_retry_attempts:v.max_retry_attempts,enable_typing_indicator:void 0!==u.enable_typing_indicator?u.enable_typing_indicator:v.enable_typing_indicator,enable_sound_notifications:void 0!==u.enable_sound_notifications?u.enable_sound_notifications:v.enable_sound_notifications,cargo_not_found_message:u.cargo_not_found_message,feature_disabled_message:u.feature_disabled_message,error_message_template:u.error_message_template,order_not_found_message:u.order_not_found_message,logo_url:u.logo_url,custom_messages:u.custom_messages}),"undefined"!==typeof window&&(window.widgetConfig=o(o({},window.widgetConfig),{},{apiEndpoints:{cargoTracking:m.cargoTracking||null,orderTracking:m.orderTracking||null},isCargoEnabled:p,isOrderEnabled:h})),e.a(2);case 5:e.n=6;break;case 6:e.n=8;break;case 7:e.p=7,e.v;case 8:M({ai_name:n.DEFAULT_AI_NAME,welcome_message:"Merhaba ben ".concat(n.DEFAULT_AI_NAME,", sizin tercihlerinize g\xf6re \xfcr\xfcn \xf6nerileri sunuyorum. Size nas\u0131l yard\u0131mc\u0131 olabilirim?"),ai_personality:"friendly",theme_color:"#3B82F6",font_family:"Inter",primary_color:"#3B82F6",secondary_color:"#6B7280",language:"tr",rate_limit_per_minute:10,api_timeout_seconds:10,max_retry_attempts:2,enable_typing_indicator:!0,enable_sound_notifications:!1}),e.n=10;break;case 9:e.p=9,e.v,M({ai_name:"ConvState AI",welcome_message:"Merhaba ben ConvState AI, sizin tercihlerinize g\xf6re \xfcr\xfcn \xf6nerileri sunuyorum. Size nas\u0131l yard\u0131mc\u0131 olabilirim?",ai_personality:"friendly",theme_color:"#3B82F6",font_family:"Inter",primary_color:"#3B82F6",secondary_color:"#6B7280",language:"tr",rate_limit_per_minute:10,api_timeout_seconds:10,max_retry_attempts:2,enable_typing_indicator:!0,enable_sound_notifications:!1});case 10:return e.a(2)}},e,null,[[1,7],[0,9]])}));return function(){return e.apply(this,arguments)}}(),ce=(0,f.useCallback)(u(l().m(function e(){var n,r,s,i;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n=x("/api/notification-widget"),r=(null===a||void 0===a?void 0:a.projectId)||"1",e.n=1,fetch("".concat(n,"/check-availability?project_id=").concat(r),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","X-Project-ID":r}});case 1:if(!(s=e.v).ok){e.n=3;break}return e.n=2,s.json();case 2:(i=e.v).success&&i.has_notification?(P(i.data),A(!0),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:"notification_shown",message:i.data.message_text}})):(P({message_text:"Sizin i\xe7in \xfcr\xfcn se\xe7ebilirim",ai_name:"ConvState AI",color_theme:"blue",display_duration:5e3,animation_type:"slide-in",show_close_button:!0,color_theme_css:{primary:"#3B82F6",secondary:"#1D4ED8",gradient:"linear-gradient(135deg, #3B82F6 0%, #1D4ED8 100%)"}}),A(!0)),e.n=3;break;case 3:e.n=5;break;case 4:e.p=4,e.v;case 5:return e.a(2)}},e,null,[[0,4]])})),[null===a||void 0===a?void 0:a.projectId,t]);(0,f.useEffect)(function(){oe(),Q(),ce()},[]);(0,f.useEffect)(function(){var e=G[G.length-1];if(e&&"user"===e.role){var n=e.content.toLowerCase();if(n.includes("kampanyalarda neler var"))return void(null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:"campaign_inquiry",message:n}}));["kampanya","kampanyalar","kampanyalarda","indirim","f\u0131rsat","bedava","\xfccretsiz","taksit","promosyon","teklif","\xf6zel","avantaj"].some(function(e){return n.includes(e)})&&(m(!0),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:"campaign_tab_opened",message:n}}))}},[G,t]);var le=function(){T&&(A(!1),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:"notification_closed_via_avatar"}})),C(!S),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:"chat_toggle",visible:!S}})},de=function(e){("campaign"!==e||R.campaigns)&&("faq"!==e||R.faqs)&&(N(!0),setTimeout(function(){m(!1),j(!1),"campaign"===e&&R.campaigns?m(!0):"faq"===e&&R.faqs&&j(!0),setTimeout(function(){N(!1)},400)},100))};return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("div",{className:"convstateai-widget chat-container ".concat(S?"":"hidden"," ").concat("center"===(null===a||void 0===a||null===(n=a.customization)||void 0===n?void 0:n.position)?"center":""),children:[(0,w.jsxs)("div",{className:"main-header",children:[(0,w.jsxs)("div",{className:"chat-header",children:[(0,w.jsxs)("div",{className:"header-left",children:[(0,w.jsx)("div",{className:"agent-avatar",children:(0,w.jsx)("img",{src:k().small,alt:"AI Conversion Agent"})}),(0,w.jsx)("span",{className:"agent-name",children:K.ai_name||"ConvState AI"})]}),(0,w.jsx)("div",{className:"header-right",children:(0,w.jsx)("button",{className:"icon-button ".concat(s?"sound-enabled":""),onClick:function(){i(!s),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:"sound_toggle",enabled:!s}})},title:s?"Sound On":"Sound Off",children:(0,w.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,w.jsx)("path",{d:"M12 5L8 9H4V15H8L12 19V5Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,w.jsx)("path",{d:"M15.54 8.46C16.4774 9.39764 17.0039 10.6692 17.0039 12C17.0039 13.3308 16.4774 14.6024 15.54 15.54",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})})]}),(R.campaigns||R.faqs)&&(0,w.jsx)("div",{className:"tabs-section",children:(0,w.jsxs)("div",{className:"tab-navigation",children:[(0,w.jsx)("button",{className:"tab-button ".concat(d||v?"":"active"),onClick:function(){return de("chat")},title:"Chat",children:"\ud83d\udcac Chat"}),R.campaigns&&(0,w.jsx)("button",{className:"tab-button ".concat(d?"active":""),onClick:function(){return de("campaign")},title:"Kampanyalar",children:"\ud83c\udfaf Kampanyalar"}),R.faqs&&(0,w.jsx)("button",{className:"tab-button ".concat(v?"active":""),onClick:function(){return de("faq")},title:"S\u0131k Sorulan Sorular",children:"\u2753 SSS"})]})})]}),(0,w.jsxs)("div",{className:"tab-content ".concat(b?"transitioning":""),children:[(0,w.jsx)("div",{className:"tab-panel ".concat(d?"":"active"),children:(0,w.jsxs)("div",{className:"aiagent-container",children:[(0,w.jsxs)("div",{className:"chat-content",children:[z.map(function(e){return(0,w.jsx)(ie,{message:e,onRetry:function(){U(function(n){return n.filter(function(n){return n.id!==e.id})})},onDismiss:function(){U(function(n){return n.filter(function(n){return n.id!==e.id})})}},e.id)}),(0,w.jsx)(X,{messages:G,onProductClick:function(e){q(e),null===t||void 0===t||t({type:"product_clicked",timestamp:new Date,sessionId:"session_id",data:{product:e}})},onFeedback:function(e){Y(e),null===t||void 0===t||t({type:"feedback_received",timestamp:new Date,sessionId:"session_id",data:{feedback:e}})},welcomeMessage:K.welcome_message,widgetCustomization:K,onAddMessage:Z,onSendMessage:W})]}),(0,w.jsx)(ne,{onAction:function(e){W(e),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:e}})}}),(0,w.jsx)(ee,{onSendMessage:function(e){W(e),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{message:e}})}}),(0,w.jsx)(ae,{})]})}),R.campaigns&&(0,w.jsx)("div",{className:"tab-panel ".concat(d?"active":""),children:(0,w.jsx)(te,{isVisible:!0,onClose:function(){m(!1)}})}),R.faqs&&(0,w.jsx)("div",{className:"tab-panel ".concat(v?"active":""),children:(0,w.jsx)(re,{isVisible:!0,onClose:function(){return de("chat")}})})]})]}),(0,w.jsx)("div",{className:"bottom-avatar",onClick:le,children:(0,w.jsx)("img",{src:k().large,alt:"AI Conversion Assistant"})}),(0,w.jsx)(se,{isVisible:T,onClose:function(){A(!1),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:"notification_closed"}})},onOpenChat:le,settings:D})]})}}}]);