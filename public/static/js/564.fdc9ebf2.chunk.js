/*! For license information please see 564.fdc9ebf2.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkconvstateai_widget=self.webpackChunkconvstateai_widget||[]).push([[564],{564:function(e,n,a){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function r(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,n||"default");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}function s(e,n,a){return(n=r(n))in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function i(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),a.push.apply(a,t)}return a}function c(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?i(Object(a),!0).forEach(function(n){s(e,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))})}return e}function o(e,n,a,t){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}o=function(e,n,a,t){function s(n,a){o(e,n,function(e){return this._invoke(n,a,e)})}n?r?r(e,n,{value:a,enumerable:!t,configurable:!t,writable:!t}):e[n]=a:(s("next",0),s("throw",1),s("return",2))},o(e,n,a,t)}function l(){var e,n,a="function"==typeof Symbol?Symbol:{},t=a.iterator||"@@iterator",r=a.toStringTag||"@@toStringTag";function s(a,t,r,s){var l=t&&t.prototype instanceof c?t:c,d=Object.create(l.prototype);return o(d,"_invoke",function(a,t,r){var s,c,o,l=0,d=r||[],u=!1,m={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,a){return s=n,c=0,o=e,m.n=a,i}};function p(a,t){for(c=a,o=t,n=0;!u&&l&&!r&&n<d.length;n++){var r,s=d[n],p=m.p,h=s[2];a>3?(r=h===t)&&(o=s[(c=s[4])?5:(c=3,3)],s[4]=s[5]=e):s[0]<=p&&((r=a<2&&p<s[1])?(c=0,m.v=t,m.n=s[1]):p<h&&(r=a<3||s[0]>t||t>h)&&(s[4]=a,s[5]=t,m.n=h,c=0))}if(r||a>1)return i;throw u=!0,t}return function(r,d,h){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&p(d,h),c=d,o=h;(n=c<2?e:o)||!u;){s||(c?c<3?(c>1&&(m.n=-1),p(c,o)):m.n=o:m.v=o);try{if(l=2,s){if(c||(r="next"),n=s[r]){if(!(n=n.call(s,o)))throw TypeError("iterator result is not an object");if(!n.done)return n;o=n.value,c<2&&(c=0)}else 1===c&&(n=s.return)&&n.call(s),c<2&&(o=TypeError("The iterator does not provide a '"+r+"' method"),c=1);s=e}else if((n=(u=m.n<0)?o:a.call(t,m))!==i)break}catch(n){s=e,c=1,o=n}finally{l=1}}return{value:n,done:u}}}(a,r,s),!0),d}var i={};function c(){}function d(){}function u(){}n=Object.getPrototypeOf;var m=[][t]?n(n([][t]())):(o(n={},t,function(){return this}),n),p=u.prototype=c.prototype=Object.create(m);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,o(e,r,"GeneratorFunction")),e.prototype=Object.create(p),e}return d.prototype=u,o(p,"constructor",u),o(u,"constructor",d),d.displayName="GeneratorFunction",o(u,r,"GeneratorFunction"),o(p),o(p,r,"Generator"),o(p,t,function(){return this}),o(p,"toString",function(){return"[object Generator]"}),(l=function(){return{w:s,m:h}})()}function d(e,n,a,t,r,s,i){try{var c=e[s](i),o=c.value}catch(e){return void a(e)}c.done?n(o):Promise.resolve(o).then(t,r)}function u(e){return function(){var n=this,a=arguments;return new Promise(function(t,r){var s=e.apply(n,a);function i(e){d(s,t,r,i,c,"next",e)}function c(e){d(s,t,r,i,c,"throw",e)}i(void 0)})}}function m(e,n){(null==n||n>e.length)&&(n=e.length);for(var a=0,t=Array(n);a<n;a++)t[a]=e[a];return t}function p(e,n){if(e){if("string"==typeof e)return m(e,n);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?m(e,n):void 0}}function h(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var t,r,s,i,c=[],o=!0,l=!1;try{if(s=(a=a.call(e)).next,0===n){if(Object(a)!==a)return;o=!1}else for(;!(o=(t=s.call(a)).done)&&(c.push(t.value),c.length!==n);o=!0);}catch(e){l=!0,r=e}finally{try{if(!o&&null!=a.return&&(i=a.return(),Object(i)!==i))return}finally{if(l)throw r}}return c}}(e,n)||p(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}a.r(n),a.d(n,{default:function(){return ne}});var f=a(5),v=function(e){if("undefined"!==typeof window&&window.convstateaiConfig){var n=window.convstateaiConfig.baseUrl||x();return"".concat(n,"/widgetcust/imgs/").concat(e)}return"/imgs/".concat(e)},x=function(){return"https://convstateai.com"},j=function(){return{small:v("ai-conversion-logo-small.svg"),large:v("ai-conversion-logo.svg")}},y=(a(191),function(){var e;return{BASE_URL:e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"development"}.REACT_APP_API_BASE_URL||"http://127.0.0.1:8000",TIMEOUT:parseInt({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"development"}.REACT_APP_API_TIMEOUT||"10000"),ENDPOINTS:{CHAT:"/api/chat",CAMPAIGNS:"/api/campaigns",FAQS:"/api/faqs",PRODUCTS:"/api/products",WIDGET_CUSTOMIZATION:"/api/widget-customization",FEEDBACK:"/api/feedback",PRODUCT_CLICK:"/api/product-click",CARGO_TRACKING:"/api/cargo-tracking",ADD_TOKEN:"/api/add-token",EXHAUST_TOKEN:"/api/exhaust-token",USAGE:"/api/subscription/usage",PLANS:"/api/subscription/plans",BILLING_HISTORY:"/api/subscription/billing-history"},DEFAULT_AI_NAME:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"development"}.REACT_APP_DEFAULT_AI_NAME||"ConvState AI",DEFAULT_WELCOME_MESSAGE:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"development"}.REACT_APP_DEFAULT_WELCOME_MESSAGE||"Merhaba ben Kadir, senin dijital asistan\u0131n\u0131m. Sana nas\u0131l yard\u0131mc\u0131 olabilirim?",SESSION_STORAGE_KEY:"chat_session_id",MAX_PRODUCTS_TO_SHOW:6,PRODUCT_IMAGE_PATH:e+"/api/widgetcust/imgs/",TYPING_DELAY:1e3,MAX_MESSAGE_LENGTH:1e3,ENABLE_TTS:"true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"development"}.REACT_APP_ENABLE_TTS,ENABLE_PRODUCT_RECOMMENDATIONS:"true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"development"}.REACT_APP_ENABLE_PRODUCT_RECOMMENDATIONS,ENABLE_CAMPAIGN_TAB:"true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"development"}.REACT_APP_ENABLE_CAMPAIGN_TAB,ENABLE_FAQ_TAB:"true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"development"}.REACT_APP_ENABLE_FAQ_TAB}}()),k=function(e){return y.BASE_URL+e},b=function(e){return y.ENDPOINTS[e]},N=a(689),_=function(e){var n,a,t,r,s=e.message,i=(e.onProductClick,e.onFeedback),c=e.onAddMessage,o=e.onSendMessage,d=s.products||(null===(n=s.data)||void 0===n?void 0:n.products)||[],m=g((0,f.useState)(!1),2),p=m[0],h=m[1],v=(0,f.useRef)(null);(0,f.useEffect)(function(){var e="feedback_".concat(s.id);localStorage.getItem(e)&&h(!0)},[s.id]),(0,f.useEffect)(function(){var e=v.current;e&&(e.style.overflowX="auto",e.style.overflowY="hidden")},[d.length]);var x=function(){var e=u(l().m(function e(n,a){var t,r,s;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,t=localStorage.getItem("chat_session_id")||"unknown",e.n=1,fetch(k("/api/product-interaction"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:t,product_id:n.id,action:a,timestamp:(new Date).toISOString(),source:"chat_widget",metadata:{product_name:n.name,product_category:n.category,product_brand:n.brand,action_source:"chat_widget"}})});case 1:if(!(r=e.v).ok){e.n=3;break}return e.n=2,r.json();case 2:"view"===a?c&&c("\ud83d\udce6 **".concat(n.name,"** \xfcr\xfcn detaylar\u0131 y\xfckleniyor..."),"agent",[n],{type:"product_detail",product:n,action:"view",widget:"ProductDetailMessage"}):"compare"===a&&c&&(s="\ud83d\udd04 **".concat(n.name,"** \xfcr\xfcn\xfcn\xfc kar\u015f\u0131la\u015ft\u0131rmak istiyorsunuz.\n\nBu \xfcr\xfcn\xfc ba\u015fka \xfcr\xfcnlerle kar\u015f\u0131la\u015ft\u0131rmak i\xe7in hangi \xf6zellikleri \xf6nemsiyorsunuz?"),c(s,"agent",[n])),e.n=3;break;case 3:e.n=5;break;case 4:e.p=4,e.v;case 5:return e.a(2)}},e,null,[[0,4]])}));return function(n,a){return e.apply(this,arguments)}}(),j=function(e){var n="feedback_".concat(s.id);localStorage.setItem(n,JSON.stringify({isHelpful:e,timestamp:(new Date).toISOString()})),h(!0),i({messageId:s.id,isHelpful:e,comment:""})};return(0,N.jsxs)("div",{className:"message agent-message",children:[(0,N.jsxs)("div",{className:"message-content-wrapper",children:[(0,N.jsx)("h4",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"8px"},children:(null===(a=s.data)||void 0===a?void 0:a.title)||"Senin i\xe7in \xf6nerdi\u011fim \xfcr\xfcnler:"}),d&&d.length>0?(0,N.jsx)("div",{className:"products-scroll-container",ref:v,children:(0,N.jsx)("div",{className:"products-wrapper",children:d.map(function(e,n){return(0,N.jsxs)("div",{className:"product-card",children:[(0,N.jsx)("div",{className:"product-image",children:(0,N.jsx)("img",{src:e.image||y.PRODUCT_IMAGE_PATH+"default-product.svg",alt:e.name,onError:function(e){var n=e.currentTarget.src;n.includes("default-product.svg")?e.currentTarget.src=y.PRODUCT_IMAGE_PATH+"default-product.jpg":n.includes("default-product.jpg")&&(e.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjkwIiB2aWV3Qm94PSIwIDAgMTUwIDkwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxNTAiIGhlaWdodD0iOTAiIGZpbGw9IiNmM2Y0ZjYiLz48dGV4dCB4PSI3NSIgeT0iNDUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5YTNhZiIgdGV4dC1hbmNob3I9Im1pZGRsZSI+5Yqg6L295LitLi4uPC90ZXh0Pjwvc3ZnPg=="),e.currentTarget.onerror=null}})}),(0,N.jsxs)("div",{className:"product-info",children:[(0,N.jsx)("h4",{children:e.name}),(0,N.jsx)("p",{style:{fontSize:"12px",color:"#6B7280",marginBottom:"4px"},children:e.brand}),(0,N.jsx)("p",{className:"product-price",children:e.price}),(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginBottom:"8px"},children:[(0,N.jsx)("span",{style:{fontSize:"10px",color:"#6B7280"},children:"Rating:"}),(0,N.jsxs)("span",{style:{fontSize:"10px",color:"#F59E0B"},children:["\u2605 ",e.rating]})]}),(0,N.jsxs)("div",{className:"product-buttons-container",style:{display:"flex",gap:"6px"},children:[(0,N.jsx)("button",{className:"product-button primary",onClick:function(n){n.stopPropagation(),x(e,"view")},style:{flex:1,padding:"6px 8px",fontSize:"11px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Detaylar"}),(0,N.jsx)("button",{className:"product-button secondary",onClick:function(n){n.stopPropagation(),x(e,"compare")},style:{flex:1,padding:"6px 8px",fontSize:"11px",backgroundColor:"#F59E0B",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Kar\u015f\u0131la\u015ft\u0131r"})]})]})]},"".concat(e.id,"-").concat(n))})})}):(0,N.jsxs)("div",{className:"no-products-message",children:[(0,N.jsx)("div",{className:"no-products-icon",children:"\ud83d\udd0d"}),(0,N.jsx)("p",{children:s.content||"\xdcr\xfcn bulunamad\u0131."}),(null===(t=s.data)||void 0===t?void 0:t.suggestions)&&s.data.suggestions.length>0&&(0,N.jsxs)("div",{className:"suggestions",children:[(0,N.jsx)("p",{className:"suggestions-title",children:"Size \u015funlar\u0131 \xf6nerebilirim:"}),(0,N.jsx)("div",{className:"suggestion-buttons",children:s.data.suggestions.map(function(e,n){return(0,N.jsx)("button",{className:"suggestion-button",onClick:function(){var n="".concat(e," \xf6ner");o?o(n):c&&c(n,"user")},children:e},n)})})]})]}),d.length>0&&(0,N.jsxs)("div",{className:"ai-note",children:[(0,N.jsx)("span",{className:"ai-icon",children:"AI"}),(null===(r=s.data)||void 0===r?void 0:r.ai_note)||"Tercihlerinize g\xf6re \xf6nerilen \xfcr\xfcnler."]})]}),!p&&(0,N.jsxs)("div",{className:"feedback-container",children:[(0,N.jsx)("button",{className:"feedback-button",onClick:function(){return j(!0)},children:"\ud83d\udc4d Yararl\u0131"}),(0,N.jsx)("button",{className:"feedback-button negative",onClick:function(){return j(!1)},children:"\ud83d\udc4e Yarars\u0131z"})]}),p&&(0,N.jsx)("div",{className:"feedback-thanks",children:(0,N.jsx)("span",{style:{fontSize:"12px",color:"#10B981",fontStyle:"italic"},children:"\u2713 Feedback'iniz i\xe7in te\u015fekk\xfcrler!"})})]})},w=function(e){var n,a,t=e.message,r=(e.onProductClick,e.onAddMessage),s=g((0,f.useState)(!1),2),i=s[0],c=s[1],o=g((0,f.useState)(null),2),d=o[0],m=o[1],p=g((0,f.useState)(null),2),h=p[0],v=p[1],x=(null===(n=t.data)||void 0===n?void 0:n.product)||(null===(a=t.products)||void 0===a?void 0:a[0]);(0,f.useEffect)(function(){x&&!d&&j()},[x]);var j=function(){var e=u(l().m(function e(){var n,a,t,r,s;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(x){e.n=1;break}return e.a(2);case 1:return c(!0),v(null),e.p=2,n=localStorage.getItem("chat_session_id")||"unknown",e.n=3,fetch(k("/api/product-details"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:n,product_id:x.id,product_name:x.name,product_description:x.description,product_price:x.price,product_category:x.category,action:"get_details"})});case 3:if((a=e.v).ok){e.n=7;break}if(404!==a.status){e.n=4;break}throw new Error("\xdcr\xfcn detaylar\u0131 bulunamad\u0131. L\xfctfen daha sonra tekrar deneyin.");case 4:if(429!==a.status){e.n=5;break}throw new Error("G\xfcnl\xfck g\xf6r\xfcnt\xfcleme limitiniz doldu. Yar\u0131n tekrar deneyin.");case 5:if(500!==a.status){e.n=6;break}throw new Error("Sunucu hatas\u0131 olu\u015ftu. L\xfctfen daha sonra tekrar deneyin.");case 6:throw new Error("Sunucu hatas\u0131 (".concat(a.status,"). L\xfctfen daha sonra tekrar deneyin."));case 7:return e.n=8,a.json();case 8:if(!(t=e.v).success){e.n=9;break}m(t.data),e.n=12;break;case 9:if("Session not found"!==t.message){e.n=10;break}throw new Error("Oturum bulunamad\u0131. L\xfctfen sayfay\u0131 yenileyin.");case 10:if("Daily view limit reached"!==t.message){e.n=11;break}throw new Error("G\xfcnl\xfck g\xf6r\xfcnt\xfcleme limitiniz doldu. Yar\u0131n tekrar deneyin.");case 11:throw new Error(t.message||"\xdcr\xfcn detaylar\u0131 y\xfcklenirken bir hata olu\u015ftu.");case 12:e.n=14;break;case 13:e.p=13,s=e.v,console.error("Error fetching product details:",s),r="\xdcr\xfcn detaylar\u0131 y\xfcklenirken bir hata olu\u015ftu.",s instanceof Error&&(r=s.message.includes("Failed to fetch")||s.message.includes("NetworkError")?"\u0130nternet ba\u011flant\u0131n\u0131z\u0131 kontrol edin ve tekrar deneyin.":s.message.includes("timeout")?"\u0130stek zaman a\u015f\u0131m\u0131na u\u011frad\u0131. L\xfctfen tekrar deneyin.":s.message),v(r);case 14:return e.p=14,c(!1),e.f(14);case 15:return e.a(2)}},e,null,[[2,13,14,15]])}));return function(){return e.apply(this,arguments)}}(),y=function(){var e=u(l().m(function e(){var n,a,t,s;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(x&&r){e.n=1;break}return e.a(2);case 1:return e.p=1,n=localStorage.getItem("chat_session_id")||"unknown",e.n=2,fetch(k("/api/price-comparison"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:n,product_id:x.id,product_name:x.name,product_price:x.price,product_category:x.category,comparison_type:"similar_products"})});case 2:if(!(a=e.v).ok){e.n=4;break}return e.n=3,a.json();case 3:(t=e.v).success?r("\ud83d\udcb0 Fiyat Kar\u015f\u0131la\u015ft\u0131rmas\u0131: ".concat(x.name),"agent",void 0,{action:"price_comparison_result",product:x,comparison_data:t.data}):r("\u274c Fiyat kar\u015f\u0131la\u015ft\u0131rmas\u0131 yap\u0131lamad\u0131: ".concat(t.message),"agent"),e.n=5;break;case 4:r("\u274c Fiyat kar\u015f\u0131la\u015ft\u0131rmas\u0131 hatas\u0131: ".concat(a.status),"agent");case 5:e.n=7;break;case 6:e.p=6,s=e.v,console.error("Price comparison error:",s),r("\u274c Fiyat kar\u015f\u0131la\u015ft\u0131rmas\u0131 yap\u0131l\u0131rken bir hata olu\u015ftu.","agent");case 7:return e.a(2)}},e,null,[[1,6]])}));return function(){return e.apply(this,arguments)}}();if(i)return(0,N.jsx)("div",{className:"product-detail-message",children:(0,N.jsxs)("div",{className:"product-detail-loading",children:[(0,N.jsx)("div",{className:"loading-spinner"}),(0,N.jsx)("p",{children:"\xdcr\xfcn detaylar\u0131 y\xfckleniyor..."})]})});if(h)return(0,N.jsx)("div",{className:"product-detail-message",children:(0,N.jsxs)("div",{className:"product-detail-error",children:[(0,N.jsx)("div",{className:"error-icon",children:(0,N.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,N.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"#ef4444",strokeWidth:"2"}),(0,N.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15",stroke:"#ef4444",strokeWidth:"2"}),(0,N.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15",stroke:"#ef4444",strokeWidth:"2"})]})}),(0,N.jsxs)("div",{className:"error-content",children:[(0,N.jsx)("h4",{children:"\xdcr\xfcn Detaylar\u0131 Y\xfcklenemedi"}),(0,N.jsx)("p",{children:h}),(0,N.jsxs)("div",{className:"error-actions",children:[(0,N.jsxs)("button",{onClick:j,className:"retry-button",children:[(0,N.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,N.jsx)("path",{d:"M1 4v6h6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,N.jsx)("path",{d:"M23 20v-6h-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,N.jsx)("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Tekrar Dene"]}),(0,N.jsxs)("button",{onClick:function(){return v(null)},className:"dismiss-button",children:[(0,N.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,N.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,N.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Kapat"]})]})]})]})});if(!x)return(0,N.jsx)("div",{className:"product-detail-message",children:(0,N.jsxs)("div",{className:"product-detail-error warning",children:[(0,N.jsx)("div",{className:"error-icon",children:(0,N.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,N.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"#f59e0b",strokeWidth:"2"}),(0,N.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12",stroke:"#f59e0b",strokeWidth:"2",strokeLinecap:"round"}),(0,N.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16",stroke:"#f59e0b",strokeWidth:"2",strokeLinecap:"round"})]})}),(0,N.jsxs)("div",{className:"error-content",children:[(0,N.jsx)("h4",{children:"\xdcr\xfcn Bilgisi Bulunamad\u0131"}),(0,N.jsx)("p",{children:"Bu \xfcr\xfcn i\xe7in detay bilgisi mevcut de\u011fil. L\xfctfen farkl\u0131 bir \xfcr\xfcn se\xe7in."})]})]})});var b=d||{};return(0,N.jsx)("div",{className:"product-detail-message",children:(0,N.jsxs)("div",{className:"product-detail-container",children:[(0,N.jsxs)("div",{className:"product-detail-header",children:[(0,N.jsx)("div",{className:"product-detail-image",children:(0,N.jsx)("img",{src:x.image||"/imgs/default-product.svg",alt:x.name,onError:function(e){e.currentTarget.src="/imgs/default-product.svg"}})}),(0,N.jsxs)("div",{className:"product-detail-info",children:[(0,N.jsx)("h3",{className:"product-detail-title",children:x.name}),(0,N.jsx)("div",{className:"product-detail-price",children:x.price&&(0,N.jsx)("span",{className:"price",children:"string"===typeof x.price&&x.price.includes("$")?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("span",{className:"currency",children:"$"}),(0,N.jsx)("span",{className:"amount",children:x.price.replace("$","")})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("span",{className:"amount",children:x.price}),(0,N.jsx)("span",{className:"currency",children:"\u20ba"})]})})})]})]}),b.ai_description&&(0,N.jsxs)("div",{className:"product-detail-ai-content",children:[(0,N.jsxs)("div",{className:"ai-header",children:[(0,N.jsx)("img",{src:"http://127.0.0.1:8000/imgs/ai-conversion-logo.svg",alt:"ConvState AI",className:"ai-logo"}),(0,N.jsx)("h4",{children:"ConvState AI Analizi"})]}),(0,N.jsx)("div",{className:"ai-description",children:b.ai_description})]}),b.features&&b.features.length>0&&(0,N.jsxs)("div",{className:"product-detail-features",children:[(0,N.jsx)("h4",{children:"\u2728 \xd6zellikler"}),(0,N.jsx)("ul",{className:"features-list",children:b.features.map(function(e,n){return(0,N.jsx)("li",{children:e},n)})})]}),b.usage_scenarios&&b.usage_scenarios.length>0&&(0,N.jsxs)("div",{className:"product-detail-usage",children:[(0,N.jsx)("h4",{children:"\ud83c\udfaf Kullan\u0131m Alanlar\u0131"}),(0,N.jsx)("ul",{className:"usage-list",children:b.usage_scenarios.map(function(e,n){return(0,N.jsx)("li",{children:e},n)})})]}),b.specifications&&Object.keys(b.specifications).length>0&&(0,N.jsxs)("div",{className:"product-detail-specs",children:[(0,N.jsx)("h4",{children:"\u2699\ufe0f Teknik \xd6zellikler"}),(0,N.jsx)("div",{className:"specs-grid",children:Object.entries(b.specifications).map(function(e){var n=g(e,2),a=n[0],t=n[1];return(0,N.jsxs)("div",{className:"spec-item",children:[(0,N.jsxs)("span",{className:"spec-key",children:[a,":"]}),(0,N.jsx)("span",{className:"spec-value",children:t})]},a)})})]}),b.recommendations&&b.recommendations.length>0&&(0,N.jsxs)("div",{className:"product-detail-recommendations",children:[(0,N.jsx)("h4",{children:"\ud83d\udca1 \xd6neriler"}),(0,N.jsx)("ul",{className:"recommendations-list",children:b.recommendations.map(function(e,n){return(0,N.jsx)("li",{children:e},n)})})]}),(0,N.jsxs)("div",{className:"product-detail-actions",children:[(0,N.jsxs)("div",{className:"action-buttons-row",children:[(0,N.jsx)("button",{className:"action-button primary",onClick:function(){r&&r("Sepete ekle: ".concat(null===x||void 0===x?void 0:x.name),"user",void 0,{action:"add_to_cart",product:x})},children:"\ud83d\uded2 Sepete Ekle"}),(0,N.jsx)("button",{className:"action-button secondary",onClick:function(){r&&r("Sat\u0131n al: ".concat(null===x||void 0===x?void 0:x.name),"user",void 0,{action:"buy_now",product:x})},children:"\ud83d\udcb3 Hemen Sat\u0131n Al"})]}),(0,N.jsx)("button",{className:"action-button tertiary full-width",onClick:y,children:"\ud83d\udcb0 Fiyat Kar\u015f\u0131la\u015ft\u0131r"})]})]})})},S=function(e){var n,a=e.message,t=e.onProductClick,r=null===(n=a.data)||void 0===n?void 0:n.comparison_data;if(!r)return(0,N.jsx)("div",{className:"price-comparison-message",children:(0,N.jsxs)("div",{className:"comparison-container error-state",children:[(0,N.jsxs)("div",{className:"comparison-header",children:[(0,N.jsx)("h3",{children:"\ud83d\udcb0 Fiyat Kar\u015f\u0131la\u015ft\u0131rmas\u0131"}),(0,N.jsx)("div",{className:"error-badge",children:(0,N.jsx)("span",{children:"Hata"})})]}),(0,N.jsxs)("div",{className:"error-content",children:[(0,N.jsx)("div",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,N.jsxs)("div",{className:"error-details",children:[(0,N.jsx)("h4",{children:"Veri Y\xfcklenemedi"}),(0,N.jsx)("p",{children:"Fiyat kar\u015f\u0131la\u015ft\u0131rmas\u0131 yap\u0131l\u0131rken bir hata olu\u015ftu. L\xfctfen daha sonra tekrar deneyin."}),(0,N.jsx)("div",{className:"error-actions",children:(0,N.jsx)("button",{className:"retry-button",onClick:function(){return window.location.reload()},children:"\ud83d\udd04 Tekrar Dene"})})]})]})]})});var s=r.main_product,i=r.similar_products,c=r.price_analysis,o=r.ai_comparison,l=r.comparison_summary;if(!s||!s.name||!s.price)return(0,N.jsx)("div",{className:"price-comparison-message",children:(0,N.jsxs)("div",{className:"comparison-container default-data",children:[(0,N.jsxs)("div",{className:"comparison-header",children:[(0,N.jsx)("h3",{children:"\ud83d\udcb0 Fiyat Kar\u015f\u0131la\u015ft\u0131rmas\u0131"}),(0,N.jsx)("div",{className:"default-badge",children:(0,N.jsx)("span",{children:"Varsay\u0131lan Veri"})})]}),(0,N.jsxs)("div",{className:"default-content",children:[(0,N.jsx)("div",{className:"default-icon",children:"\ud83d\udcca"}),(0,N.jsxs)("div",{className:"default-details",children:[(0,N.jsx)("h4",{children:"\xd6rnek Fiyat Kar\u015f\u0131la\u015ft\u0131rmas\u0131"}),(0,N.jsx)("p",{children:"Ger\xe7ek \xfcr\xfcn verisi bulunamad\u0131\u011f\u0131 i\xe7in \xf6rnek bir kar\u015f\u0131la\u015ft\u0131rma g\xf6steriyoruz."}),(0,N.jsxs)("div",{className:"sample-comparison",children:[(0,N.jsx)("div",{className:"sample-product",children:(0,N.jsxs)("div",{className:"product-info",children:[(0,N.jsx)("h5",{children:"\xd6rnek \xdcr\xfcn"}),(0,N.jsxs)("div",{className:"price-info",children:[(0,N.jsx)("span",{className:"price",children:"299.99"}),(0,N.jsx)("span",{className:"currency",children:"\u20ba"})]}),(0,N.jsx)("div",{className:"category",children:"Elektronik"})]})}),(0,N.jsxs)("div",{className:"sample-analysis",children:[(0,N.jsxs)("div",{className:"analysis-item",children:[(0,N.jsx)("span",{className:"label",children:"Fiyat Pozisyonu:"}),(0,N.jsx)("span",{className:"value",children:"Ortalama"})]}),(0,N.jsxs)("div",{className:"analysis-item",children:[(0,N.jsx)("span",{className:"label",children:"De\u011ferlendirme:"}),(0,N.jsx)("span",{className:"value good",children:"\u0130yi De\u011fer"})]})]})]})]})]})]})});if(!i||0===i.length)return(0,N.jsx)("div",{className:"price-comparison-message",children:(0,N.jsxs)("div",{className:"comparison-container no-data",children:[(0,N.jsxs)("div",{className:"comparison-header",children:[(0,N.jsx)("h3",{children:"\ud83d\udcb0 Fiyat Kar\u015f\u0131la\u015ft\u0131rmas\u0131"}),(0,N.jsx)("div",{className:"no-data-badge",children:(0,N.jsx)("span",{children:"Veri Bulunamad\u0131"})})]}),(0,N.jsxs)("div",{className:"main-product-only",children:[(0,N.jsxs)("div",{className:"product-card main",children:[(0,N.jsx)("div",{className:"product-image",children:(0,N.jsx)("img",{src:"/imgs/default-product.svg",alt:s.name,onError:function(e){e.currentTarget.src="/imgs/default-product.svg"}})}),(0,N.jsxs)("div",{className:"product-details",children:[(0,N.jsx)("h4",{children:s.name}),(0,N.jsxs)("div",{className:"price-info",children:[(0,N.jsx)("span",{className:"price",children:s.price}),(0,N.jsx)("span",{className:"currency",children:"\u20ba"})]}),(0,N.jsx)("div",{className:"category",children:s.category})]})]}),(0,N.jsxs)("div",{className:"no-comparison-info",children:[(0,N.jsx)("div",{className:"info-icon",children:"\u2139\ufe0f"}),(0,N.jsxs)("div",{className:"info-content",children:[(0,N.jsx)("h4",{children:"Kar\u015f\u0131la\u015ft\u0131rma Yap\u0131lamad\u0131"}),(0,N.jsx)("p",{children:"Bu \xfcr\xfcn i\xe7in benzer \xfcr\xfcnler bulunamad\u0131. Fiyat kar\u015f\u0131la\u015ft\u0131rmas\u0131 yapabilmek i\xe7in daha fazla \xfcr\xfcn verisi gereklidir."})]})]}),o&&o.analysis&&(0,N.jsxs)("div",{className:"ai-suggestion",children:[(0,N.jsxs)("div",{className:"ai-header",children:[(0,N.jsx)("img",{src:"/imgs/ai-conversion-logo.svg",alt:"AI",className:"ai-logo"}),(0,N.jsx)("span",{children:"ConvStateAI Analizi"})]}),(0,N.jsx)("div",{className:"ai-content",children:(0,N.jsx)("p",{children:o.analysis})})]})]})]})});return(0,N.jsx)("div",{className:"price-comparison-message",children:(0,N.jsxs)("div",{className:"comparison-container",children:[(0,N.jsxs)("div",{className:"comparison-header",children:[(0,N.jsx)("h3",{children:"\ud83d\udcb0 Fiyat Kar\u015f\u0131la\u015ft\u0131rmas\u0131"}),(0,N.jsxs)("div",{className:"comparison-summary",children:[(0,N.jsxs)("span",{className:"total-products",children:[l.total_products_compared," \xfcr\xfcn kar\u015f\u0131la\u015ft\u0131r\u0131ld\u0131"]}),(0,N.jsxs)("span",{className:"price-position",children:[function(e){switch(e){case"lowest":return"\ud83d\udfe2";case"highest":return"\ud83d\udd34";case"below_average":return"\ud83d\udfe1";case"above_average":return"\ud83d\udfe0";default:return"\u26aa"}}(c.price_position)," ",l.price_position]})]})]}),(0,N.jsxs)("div",{className:"main-product-section",children:[(0,N.jsx)("h4",{children:"\ud83c\udfaf Ana \xdcr\xfcn"}),(0,N.jsx)("div",{className:"main-product-card",children:(0,N.jsxs)("div",{className:"product-info",children:[(0,N.jsx)("h5",{children:s.name}),(0,N.jsxs)("div",{className:"price-info",children:[(0,N.jsx)("span",{className:"price",children:s.price}),(0,N.jsx)("span",{className:"currency",children:"\u20ba"})]}),(0,N.jsx)("div",{className:"price-rating",children:(0,N.jsx)("span",{className:"rating-badge",style:{backgroundColor:function(e){switch(e){case"excellent":return"#10b981";case"good":return"#3b82f6";case"fair":return"#f59e0b";case"expensive":return"#ef4444";default:return"#6b7280"}}(c.price_rating)},children:function(e){switch(e){case"excellent":return"M\xfckemmel";case"good":return"\u0130yi";case"fair":return"Orta";case"expensive":return"Pahal\u0131";default:return"Bilinmiyor"}}(c.price_rating)})})]})})]}),(0,N.jsxs)("div",{className:"price-analysis-section",children:[(0,N.jsx)("h4",{children:"\ud83d\udcca Fiyat Analizi"}),(0,N.jsxs)("div",{className:"analysis-grid",children:[(0,N.jsxs)("div",{className:"analysis-item",children:[(0,N.jsx)("span",{className:"label",children:"Ortalama Fiyat:"}),(0,N.jsxs)("span",{className:"value",children:[c.average_price," \u20ba"]})]}),(0,N.jsxs)("div",{className:"analysis-item",children:[(0,N.jsx)("span",{className:"label",children:"En D\xfc\u015f\xfck:"}),(0,N.jsxs)("span",{className:"value",children:[c.min_price," \u20ba"]})]}),(0,N.jsxs)("div",{className:"analysis-item",children:[(0,N.jsx)("span",{className:"label",children:"En Y\xfcksek:"}),(0,N.jsxs)("span",{className:"value",children:[c.max_price," \u20ba"]})]}),(0,N.jsxs)("div",{className:"analysis-item",children:[(0,N.jsx)("span",{className:"label",children:"Fark:"}),(0,N.jsxs)("span",{className:"value ".concat(c.price_difference>=0?"positive":"negative"),children:[c.price_difference>=0?"+":"",c.price_difference," \u20ba"]})]})]})]}),i&&i.length>0&&(0,N.jsxs)("div",{className:"similar-products-section",children:[(0,N.jsx)("h4",{children:"\ud83d\udd04 Benzer \xdcr\xfcnler"}),(0,N.jsx)("div",{className:"products-grid",children:i.map(function(e,n){return(0,N.jsxs)("div",{className:"product-card",onClick:function(){return null===t||void 0===t?void 0:t(e)},children:[(0,N.jsx)("div",{className:"product-image",children:(0,N.jsx)("img",{src:e.image||"/imgs/default-product.svg",alt:e.name,onError:function(e){e.currentTarget.src="/imgs/default-product.svg"}})}),(0,N.jsxs)("div",{className:"product-details",children:[(0,N.jsx)("h6",{children:e.name}),(0,N.jsxs)("div",{className:"product-price",children:[(0,N.jsx)("span",{className:"price",children:e.price}),(0,N.jsx)("span",{className:"currency",children:"\u20ba"})]}),(0,N.jsxs)("div",{className:"product-rating",children:["\u2b50 ",e.rating,"/5"]})]})]},n)})})]}),o&&(0,N.jsxs)("div",{className:"ai-analysis-section",children:[(0,N.jsx)("h4",{children:"\ud83e\udd16 AI Analizi"}),(0,N.jsxs)("div",{className:"ai-content",children:[(0,N.jsx)("div",{className:"ai-analysis",children:(0,N.jsx)("p",{children:o.analysis})}),(0,N.jsxs)("div",{className:"ai-recommendation",children:[(0,N.jsx)("strong",{children:"\ud83d\udca1 \xd6neri:"})," ",o.recommendation]})]})]}),l.best_value_product&&(0,N.jsxs)("div",{className:"best-value-section",children:[(0,N.jsx)("h4",{children:"\ud83c\udfc6 En \u0130yi De\u011fer"}),(0,N.jsx)("div",{className:"best-value-card",children:(0,N.jsxs)("div",{className:"product-info",children:[(0,N.jsx)("h5",{children:l.best_value_product.name}),(0,N.jsxs)("div",{className:"price-info",children:[(0,N.jsx)("span",{className:"price",children:l.best_value_product.price}),(0,N.jsx)("span",{className:"currency",children:"\u20ba"})]}),(0,N.jsx)("div",{className:"value-badge",children:"\ud83c\udfc6 En \u0130yi De\u011fer"})]})})]})]})})},E=function(e){var n=e.message,a=e.onFeedback,t=function(e){a({messageId:n.id,isHelpful:e,comment:""})};return(0,N.jsxs)("div",{className:"message agent-message",children:[(0,N.jsx)("div",{className:"message-content-wrapper",children:(0,N.jsx)("p",{children:n.content||n.message||"Feedback mesaj\u0131 bulunamad\u0131."})}),(0,N.jsxs)("div",{className:"feedback-container",children:[(0,N.jsx)("button",{className:"feedback-button",onClick:function(){return t(!0)},children:"\ud83d\udc4d Evet, yard\u0131mc\u0131 oldu"}),(0,N.jsx)("button",{className:"feedback-button negative",onClick:function(){return t(!1)},children:"\ud83d\udc4e Hay\u0131r, yard\u0131mc\u0131 olmad\u0131"})]})]})},C=function(e){var n=e.message,a=e.onFeedback,t=function(e){a({messageId:n.id,isHelpful:e,comment:""})};return(0,N.jsxs)("div",{className:"message agent-message",children:[(0,N.jsx)("div",{className:"message-content-wrapper",children:(0,N.jsx)("p",{children:n.content||n.message||"Mesaj i\xe7eri\u011fi bulunamad\u0131."})}),(0,N.jsxs)("div",{className:"feedback-container",children:[(0,N.jsx)("button",{className:"feedback-button",onClick:function(){return t(!0)},children:"\ud83d\udc4d Yararl\u0131"}),(0,N.jsx)("button",{className:"feedback-button negative",onClick:function(){return t(!1)},children:"\ud83d\udc4e Yarars\u0131z"})]})]})},T=function(e){var n=e.message,a=e.onFeedback,t=g((0,f.useState)(""),2),r=t[0],s=t[1],i=g((0,f.useState)(!1),2),c=i[0],o=i[1],d=g((0,f.useState)(!1),2),m=d[0],p=d[1],h=g((0,f.useState)(null),2),v=h[0],x=h[1],j=g((0,f.useState)(null),2),y=j[0],b=j[1],_=function(e){a({messageId:n.id,isHelpful:e,comment:""})},w=function(){var e=u(l().m(function e(){var n,a,t,s,i,c,d;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!r.trim()){e.n=8;break}if(e.p=1,a=window.widgetConfig,t=null===a||void 0===a||null===(n=a.apiEndpoints)||void 0===n?void 0:n.orderTracking,s=null===a||void 0===a?void 0:a.isOrderEnabled,t&&s){e.n=2;break}return x({order_id:r,status:"feature_disabled",order_date:(new Date).toISOString(),items:[],shipping:{courier:"N/A",tracking_number:"N/A",last_update:"N/A",location:"N/A",estimated_delivery:"N/A"},message:"Bu \xf6zellik yak\u0131nda a\xe7\u0131lacak"}),o(!0),e.a(2);case 2:return e.n=3,fetch(k("/api/cargo/track/".concat(encodeURIComponent(r))),{method:"GET",headers:{"Content-Type":"application/json"}});case 3:if(!(i=e.v).ok){e.n=5;break}return e.n=4,i.json();case 4:(d=e.v).success&&d.data?(b(d.data),p(!0)):null!==(c=d.data)&&void 0!==c&&c.feature_disabled?(x({order_id:r,status:"feature_disabled",order_date:(new Date).toISOString(),items:[],shipping:{courier:"N/A",tracking_number:"N/A",last_update:"N/A",location:"N/A",estimated_delivery:"N/A"},message:"Bu \xf6zellik yak\u0131nda a\xe7\u0131lacak"}),o(!0)):(x({order_id:r,status:"not_found",order_date:(new Date).toISOString(),items:[],shipping:{courier:"N/A",tracking_number:r,last_update:"N/A",location:"N/A",estimated_delivery:"N/A"},message:"Kargo numaras\u0131 ile kargo bulunamad\u0131"}),o(!0)),e.n=6;break;case 5:x({order_id:r,status:"error",order_date:(new Date).toISOString(),items:[],shipping:{courier:"N/A",tracking_number:r,last_update:"N/A",location:"N/A",estimated_delivery:"N/A"},message:"Kargo takip s\u0131ras\u0131nda hata olu\u015ftu"}),o(!0);case 6:e.n=8;break;case 7:e.p=7,e.v,x({order_id:r,status:"error",order_date:(new Date).toISOString(),items:[],shipping:{courier:"N/A",tracking_number:r,last_update:"N/A",location:"N/A",estimated_delivery:"N/A"},message:"Ba\u011flant\u0131 hatas\u0131 olu\u015ftu"}),o(!0);case 8:return e.a(2)}},e,null,[[1,7]])}));return function(){return e.apply(this,arguments)}}(),S=function(e){return new Date(e).toLocaleDateString("tr-TR")},E=function(e){return new Date(e).toLocaleString("tr-TR")};if("order_tracking"===n.intent&&!c&&!m)return(0,N.jsxs)("div",{className:"message agent-message",children:[(0,N.jsxs)("div",{className:"message-content-wrapper",children:[(0,N.jsx)("p",{children:"Kargo takip numaran\u0131z\u0131 veya sipari\u015f numaran\u0131z\u0131 girin:"}),(0,N.jsxs)("div",{className:"order-input-container",children:[(0,N.jsx)("input",{type:"text",placeholder:"Sipari\u015f/Kargo numaras\u0131 girin...",value:r,onChange:function(e){return s(e.target.value)},className:"order-number-input"}),(0,N.jsx)("button",{onClick:w,className:"track-order-button",disabled:!r.trim(),children:"Takip Et"})]})]}),(0,N.jsxs)("div",{className:"feedback-container",children:[(0,N.jsx)("button",{className:"feedback-button",onClick:function(){return _(!0)},children:"\ud83d\udc4d Yararl\u0131"}),(0,N.jsx)("button",{className:"feedback-button negative",onClick:function(){return _(!1)},children:"\ud83d\udc4e Yarars\u0131z"})]})]});if(m&&y){var C="in_transit"===y.status?"Yolda":"delivered"===y.status?"Teslim Edildi":"pending"===y.status?"Haz\u0131rlan\u0131yor":y.status;return(0,N.jsxs)("div",{className:"message agent-message",children:[(0,N.jsx)("div",{className:"message-content-wrapper",children:(0,N.jsxs)("div",{className:"cargo-tracking-simple",children:[(0,N.jsx)("h3",{children:"Kargo Takip Bilgileri"}),(0,N.jsxs)("div",{className:"cargo-info-grid",children:[(0,N.jsxs)("div",{className:"cargo-info-item",children:[(0,N.jsx)("strong",{children:"Sipari\u015f No:"}),(0,N.jsx)("span",{children:y.order_id})]}),(0,N.jsxs)("div",{className:"cargo-info-item",children:[(0,N.jsx)("strong",{children:"Durum:"}),(0,N.jsx)("span",{className:"status-badge ".concat(y.status),children:C})]}),(0,N.jsxs)("div",{className:"cargo-info-item",children:[(0,N.jsx)("strong",{children:"Kargo Firmas\u0131:"}),(0,N.jsx)("span",{children:y.courier})]}),(0,N.jsxs)("div",{className:"cargo-info-item",children:[(0,N.jsx)("strong",{children:"Takip Numaras\u0131:"}),(0,N.jsx)("span",{className:"tracking-number",children:y.tracking_number})]}),(0,N.jsxs)("div",{className:"cargo-info-item",children:[(0,N.jsx)("strong",{children:"Son G\xfcncelleme:"}),(0,N.jsx)("span",{children:E(y.last_update)})]}),(0,N.jsxs)("div",{className:"cargo-info-item",children:[(0,N.jsx)("strong",{children:"Tahmini Teslim:"}),(0,N.jsx)("span",{children:S(y.estimated_delivery)})]})]})]})}),(0,N.jsxs)("div",{className:"feedback-container",children:[(0,N.jsx)("button",{className:"feedback-button",onClick:function(){return _(!0)},children:"\ud83d\udc4d Yararl\u0131"}),(0,N.jsx)("button",{className:"feedback-button negative",onClick:function(){return _(!1)},children:"\ud83d\udc4e Yarars\u0131z"})]})]})}return c&&v?(0,N.jsxs)("div",{className:"message agent-message",children:[(0,N.jsx)("div",{className:"message-content-wrapper",children:(0,N.jsx)("div",{className:"order-tracking-details",children:"feature_disabled"===v.status?(0,N.jsxs)("div",{className:"feature-disabled-message",children:[(0,N.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px",textAlign:"center"},children:"\ud83d\udea7"}),(0,N.jsx)("h3",{style:{textAlign:"center",color:"#92400E",marginBottom:"16px"},children:"Bu \xf6zellik yak\u0131nda a\xe7\u0131lacak"}),(0,N.jsx)("p",{style:{textAlign:"center",color:"#92400E",fontSize:"14px",margin:0},children:"Sipari\u015f takip \xf6zelli\u011fi geli\u015ftirme a\u015famas\u0131nda"})]}):"not_found"===v.status?(0,N.jsxs)("div",{className:"cargo-not-found-message",children:[(0,N.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px",textAlign:"center"},children:"\ud83d\udce6"}),(0,N.jsx)("h3",{style:{textAlign:"center",color:"#DC2626",marginBottom:"16px"},children:"Kargo bulunamad\u0131"}),(0,N.jsx)("p",{style:{textAlign:"center",color:"#DC2626",fontSize:"14px",margin:0},children:v.message}),(0,N.jsx)("div",{style:{textAlign:"center",marginTop:"16px"},children:(0,N.jsx)("button",{onClick:function(){o(!1),s("")},style:{padding:"8px 16px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Tekrar Dene"})})]}):"error"===v.status?(0,N.jsxs)("div",{className:"cargo-error-message",children:[(0,N.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px",textAlign:"center"},children:"\u26a0\ufe0f"}),(0,N.jsx)("h3",{style:{textAlign:"center",color:"#DC2626",marginBottom:"16px"},children:"Hata olu\u015ftu"}),(0,N.jsx)("p",{style:{textAlign:"center",color:"#DC2626",fontSize:"14px",margin:0},children:v.message}),(0,N.jsx)("div",{style:{textAlign:"center",marginTop:"16px"},children:(0,N.jsx)("button",{onClick:function(){o(!1),s("")},style:{padding:"8px 16px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Tekrar Dene"})})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("h3",{children:"Sipari\u015f Takip Bilgileri"}),(0,N.jsxs)("div",{className:"order-header",children:[(0,N.jsxs)("div",{className:"order-id",children:["Sipari\u015f No: ",v.order_id]}),(0,N.jsxs)("div",{className:"order-status",children:["Durum: ","shipped"===v.status?"Kargoya Verildi":v.status]}),(0,N.jsxs)("div",{className:"order-date",children:["Sipari\u015f Tarihi: ",S(v.order_date)]})]}),(0,N.jsxs)("div",{className:"order-items",children:[(0,N.jsx)("h4",{children:"Sipari\u015f Edilen \xdcr\xfcnler:"}),v.items.map(function(e,n){return(0,N.jsxs)("div",{className:"order-item",children:[(0,N.jsx)("span",{className:"item-name",children:e.name}),(0,N.jsxs)("span",{className:"item-quantity",children:["x",e.quantity]}),(0,N.jsx)("span",{className:"item-price",children:e.price})]},n)})]}),(0,N.jsxs)("div",{className:"shipping-info",children:[(0,N.jsx)("h4",{children:"Kargo Bilgileri:"}),(0,N.jsxs)("div",{className:"shipping-detail",children:[(0,N.jsx)("strong",{children:"Kargo Firmas\u0131:"})," ",v.shipping.courier]}),(0,N.jsxs)("div",{className:"shipping-detail",children:[(0,N.jsx)("strong",{children:"Takip Numaras\u0131:"})," ",v.shipping.tracking_number]}),(0,N.jsxs)("div",{className:"shipping-detail",children:[(0,N.jsx)("strong",{children:"Son G\xfcncelleme:"})," ",E(v.shipping.last_update)]}),(0,N.jsxs)("div",{className:"shipping-detail",children:[(0,N.jsx)("strong",{children:"Konum:"})," ",v.shipping.location]}),(0,N.jsxs)("div",{className:"shipping-detail",children:[(0,N.jsx)("strong",{children:"Tahmini Teslim:"})," ",S(v.shipping.estimated_delivery)]})]}),(0,N.jsx)("div",{className:"order-message",children:(0,N.jsx)("p",{children:v.message})})]})})}),(0,N.jsxs)("div",{className:"feedback-container",children:[(0,N.jsx)("button",{className:"feedback-button",onClick:function(){return _(!0)},children:"\ud83d\udc4d Yararl\u0131"}),(0,N.jsx)("button",{className:"feedback-button negative",onClick:function(){return _(!1)},children:"\ud83d\udc4e Yarars\u0131z"})]})]}):(0,N.jsxs)("div",{className:"message agent-message",children:[(0,N.jsx)("div",{className:"message-content-wrapper",children:(0,N.jsx)("p",{children:n.content||n.message||"Sipari\u015f mesaj\u0131 bulunamad\u0131."})}),(0,N.jsxs)("div",{className:"feedback-container",children:[(0,N.jsx)("button",{className:"feedback-button",onClick:function(){return _(!0)},children:"\ud83d\udc4d Yararl\u0131"}),(0,N.jsx)("button",{className:"feedback-button negative",onClick:function(){return _(!1)},children:"\ud83d\udc4e Yarars\u0131z"})]})]})},A=function(e){var n=e.message,a=e.onFeedback,t=g((0,f.useState)(""),2),r=t[0],s=t[1],i=g((0,f.useState)(!1),2),c=i[0],o=i[1],d=g((0,f.useState)(null),2),m=d[0],p=d[1],h=g((0,f.useState)(!1),2),v=h[0],x=h[1];f.useEffect(function(){var e="feedback_".concat(n.id);localStorage.getItem(e)&&x(!0)},[n.id]);var j=function(e){var t="feedback_".concat(n.id);localStorage.setItem(t,JSON.stringify({isHelpful:e,timestamp:(new Date).toISOString()})),x(!0),a({messageId:n.id,isHelpful:e,comment:""})},y=function(){var e=u(l().m(function e(){var n,a,t,s,i,c;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r.trim()){e.n=1;break}return e.a(2);case 1:if(o(!0),e.p=2,a=window.widgetConfig,t=null===a||void 0===a||null===(n=a.apiEndpoints)||void 0===n?void 0:n.cargoTracking,s=null===a||void 0===a?void 0:a.isCargoEnabled,t&&s){e.n=3;break}return p({error:"Bu \xf6zellik yak\u0131nda a\xe7\u0131lacak",feature_disabled:!0}),o(!1),e.a(2);case 3:return e.n=4,fetch("".concat(t,"?cargo_number=").concat(encodeURIComponent(r)),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});case 4:if(!(i=e.v).ok){e.n=6;break}return e.n=5,i.json();case 5:c=e.v,p(c.data),e.n=7;break;case 6:p({error:"Kargo takip bilgisi al\u0131namad\u0131"});case 7:e.n=9;break;case 8:e.p=8,e.v,p({error:"Ba\u011flant\u0131 hatas\u0131"});case 9:return e.p=9,o(!1),e.f(9);case 10:return e.a(2)}},e,null,[[2,8,9,10]])}));return function(){return e.apply(this,arguments)}}();return(0,N.jsxs)("div",{className:"message agent-message",children:[(0,N.jsxs)("div",{className:"message-content-wrapper",children:[(0,N.jsx)("p",{style:{marginBottom:"16px"},children:n.message||"Kargo takip numaran\u0131z\u0131 girerek kargo durumunuzu \xf6\u011frenebilirsiniz."}),(0,N.jsxs)("div",{className:"cargo-tracking-input",style:{marginBottom:"16px"},children:[(0,N.jsx)("input",{id:"cargo-number",type:"text",value:r,onChange:function(e){return s(e.target.value)},placeholder:"Kargo takip numaras\u0131 giriniz...",style:{width:"100%",padding:"8px 12px",border:"1px solid #D1D5DB",borderRadius:"6px",fontSize:"14px",outline:"none",marginBottom:"8px"},onKeyPress:function(e){return"Enter"===e.key&&y()}}),(0,N.jsxs)("button",{onClick:y,disabled:c||!r.trim(),style:{width:"100%",padding:"8px 10px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontSize:"14px",fontWeight:"500",opacity:c||!r.trim()?.6:1},children:[c?"Takip Ediliyor...":"Takip Et",(0,N.jsx)("span",{style:{fontSize:"14px"},children:"\u2192"})]})]}),m&&(0,N.jsx)("div",{className:"cargo-tracking-result",style:{backgroundColor:m.feature_disabled?"#FEF3C7":"#F9FAFB",padding:"16px",borderRadius:"8px",border:"1px solid ".concat(m.feature_disabled?"#F59E0B":"#E5E7EB"),marginBottom:"16px"},children:m.error?(0,N.jsx)("div",{style:{textAlign:"center"},children:m.feature_disabled?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{style:{fontSize:"48px",marginBottom:"8px"},children:"\ud83d\udea7"}),(0,N.jsx)("p",{style:{color:"#92400E",margin:"0 0 8px 0",fontWeight:"600"},children:"Bu \xf6zellik yak\u0131nda a\xe7\u0131lacak"}),(0,N.jsx)("p",{style:{color:"#92400E",margin:0,fontSize:"14px"},children:"Kargo takip \xf6zelli\u011fi geli\u015ftirme a\u015famas\u0131nda"})]}):(0,N.jsx)("p",{style:{color:"#DC2626",margin:0},children:m.error})}):(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{style:{fontSize:"16px",fontWeight:"600",margin:"0 0 12px 0",color:"#111827"},children:"\ud83d\udce6 Kargo Takip Bilgisi"}),(0,N.jsxs)("div",{style:{display:"grid",gap:"8px"},children:[(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("span",{style:{fontSize:"14px",color:"#6B7280"},children:"Takip No:"}),(0,N.jsx)("span",{style:{fontSize:"14px",fontWeight:"500"},children:m.cargo_number})]}),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("span",{style:{fontSize:"14px",color:"#6B7280"},children:"Durum:"}),(0,N.jsx)("span",{style:{fontSize:"14px",fontWeight:"500",color:"#059669"},children:m.status})]}),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("span",{style:{fontSize:"14px",color:"#6B7280"},children:"Konum:"}),(0,N.jsx)("span",{style:{fontSize:"14px",fontWeight:"500"},children:m.current_location})]}),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("span",{style:{fontSize:"14px",color:"#6B7280"},children:"Tahmini Teslimat:"}),(0,N.jsx)("span",{style:{fontSize:"14px",fontWeight:"500"},children:m.estimated_delivery})]}),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("span",{style:{fontSize:"14px",color:"#6B7280"},children:"Son G\xfcncelleme:"}),(0,N.jsx)("span",{style:{fontSize:"14px",fontWeight:"500"},children:m.last_update})]})]}),m.tracking_url&&(0,N.jsx)("div",{style:{marginTop:"12px",textAlign:"center"},children:(0,N.jsx)("a",{href:m.tracking_url,target:"_blank",rel:"noopener noreferrer",style:{color:"#3B82F6",textDecoration:"none",fontSize:"14px",fontWeight:"500"},children:"\ud83d\udccd Detayl\u0131 Takip Sayfas\u0131"})})]})})]}),!v&&(0,N.jsxs)("div",{className:"feedback-container",children:[(0,N.jsx)("button",{className:"feedback-button",onClick:function(){return j(!0)},children:"\ud83d\udc4d Yararl\u0131"}),(0,N.jsx)("button",{className:"feedback-button negative",onClick:function(){return j(!1)},children:"\ud83d\udc4e Yarars\u0131z"})]}),v&&(0,N.jsx)("div",{className:"feedback-thanks",children:(0,N.jsx)("span",{style:{fontSize:"12px",color:"#10B981",fontStyle:"italic"},children:"\u2713 Feedback'iniz i\xe7in te\u015fekk\xfcrler!"})})]})},I=function(e){var n=e.type,a=void 0===n?"general":n;return(0,N.jsxs)("div",{className:"message agent-message shimmer-message",children:[(0,N.jsx)("div",{className:"message-content-wrapper",children:function(){switch(a){case"product":return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:"shimmer shimmer-title",style:{width:"60%",height:"16px",marginBottom:"12px"}}),(0,N.jsx)("div",{className:"products-scroll-container",children:(0,N.jsx)("div",{className:"products-wrapper",children:[1,2,3].map(function(e){return(0,N.jsxs)("div",{className:"product-card shimmer-card",children:[(0,N.jsx)("div",{className:"shimmer shimmer-image",style:{width:"100%",height:"80px"}}),(0,N.jsxs)("div",{className:"product-info",children:[(0,N.jsx)("div",{className:"shimmer shimmer-text",style:{width:"80%",height:"14px",marginBottom:"8px"}}),(0,N.jsx)("div",{className:"shimmer shimmer-text",style:{width:"60%",height:"12px",marginBottom:"4px"}}),(0,N.jsx)("div",{className:"shimmer shimmer-price",style:{width:"40%",height:"16px",marginBottom:"8px"}}),(0,N.jsx)("div",{className:"shimmer shimmer-button",style:{width:"100%",height:"24px"}})]})]},e)})})})]});case"cargo":return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:"shimmer shimmer-text",style:{width:"90%",height:"16px",marginBottom:"16px"}}),(0,N.jsx)("div",{className:"shimmer shimmer-input",style:{width:"100%",height:"36px",marginBottom:"8px"}}),(0,N.jsx)("div",{className:"shimmer shimmer-button",style:{width:"100%",height:"36px"}})]});case"order":return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:"shimmer shimmer-text",style:{width:"85%",height:"16px",marginBottom:"16px"}}),(0,N.jsx)("div",{className:"shimmer shimmer-input",style:{width:"100%",height:"36px",marginBottom:"8px"}}),(0,N.jsx)("div",{className:"shimmer shimmer-button",style:{width:"100%",height:"36px"}})]});case"feedback":return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:"shimmer shimmer-text",style:{width:"80%",height:"16px",marginBottom:"16px"}}),(0,N.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,N.jsx)("div",{className:"shimmer shimmer-button",style:{width:"80px",height:"32px"}}),(0,N.jsx)("div",{className:"shimmer shimmer-button",style:{width:"80px",height:"32px"}})]})]});default:return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:"shimmer shimmer-text",style:{width:"90%",height:"16px",marginBottom:"12px"}}),Math.random()>.5&&(0,N.jsx)("div",{className:"action-buttons",children:(0,N.jsx)("div",{className:"action-buttons-scroll-container",children:(0,N.jsx)("div",{className:"action-buttons-wrapper",children:[1,2,3].map(function(e){return(0,N.jsx)("div",{className:"shimmer shimmer-suggestion",style:{width:"80px",height:"28px"}},e)})})})})]})}}()}),(0,N.jsxs)("div",{className:"feedback-container",children:[(0,N.jsx)("div",{className:"shimmer shimmer-feedback",style:{width:"70px",height:"28px"}}),(0,N.jsx)("div",{className:"shimmer shimmer-feedback",style:{width:"70px",height:"28px"}})]})]})},D=function(e){var n,a=e.message,t=e.onFeedback,r=g(f.useState(!1),2),s=r[0],i=r[1],c=function(e){var n,r;if(!s){var c={messageId:a.id,isHelpful:e,comment:"Search: ".concat((null===(n=a.data)||void 0===n?void 0:n.search_query)||"",", Intent: ").concat(a.intent||"product_search",", Results: ").concat((null===(r=a.data)||void 0===r?void 0:r.total_found)||0)};t(c),i(!0),localStorage.setItem("feedback_".concat(a.id),JSON.stringify(c))}};return(0,N.jsx)("div",{className:"message bot-message",children:(0,N.jsxs)("div",{className:"message-content",children:[(0,N.jsx)("div",{className:"",children:(0,N.jsxs)("div",{className:"no-data-content",children:[(0,N.jsx)("h4",{className:"no-data-title",children:a.message||"\u015eu anda bilgi taban\u0131nda bilgi olmad\u0131\u011f\u0131 i\xe7in g\xf6r\xfcnt\xfcleyemiyoruz"}),(0,N.jsx)("p",{className:"no-data-description",children:"L\xfctfen bilgi taban\u0131n\u0131z\u0131 g\xfcncelleyiniz"}),(null===(n=a.data)||void 0===n?void 0:n.search_query)&&(0,N.jsxs)("div",{className:"search-details",children:[(0,N.jsx)("span",{className:"search-label",children:"Arama:"}),(0,N.jsxs)("span",{className:"search-query",children:['"',a.data.search_query,'"']}),(0,N.jsxs)("span",{className:"search-results",children:["(",a.data.total_found||0," sonu\xe7)"]})]})]})}),(0,N.jsxs)("div",{className:"feedback-section",children:[(0,N.jsx)("p",{className:"feedback-question",children:"Bu bilgi faydal\u0131 m\u0131yd\u0131?"}),(0,N.jsxs)("div",{className:"feedback-buttons",children:[(0,N.jsx)("button",{onClick:function(){return c(!0)},disabled:s,className:"feedback-btn helpful ".concat(s?"disabled":"hover:bg-green-600"),children:"\ud83d\udc4d Faydal\u0131"}),(0,N.jsx)("button",{onClick:function(){return c(!1)},disabled:s,className:"feedback-btn not-helpful ".concat(s?"disabled":"hover:bg-red-600"),children:"\ud83d\udc4e Faydal\u0131 De\u011fil"})]}),s&&(0,N.jsx)("p",{className:"feedback-thanks",children:"Te\u015fekk\xfcrler! Geri bildiriminiz kaydedildi."})]})]})})},O=function(e){var n=e.message,a=n.data||{},t=a.error||"UNKNOWN_ERROR",r="Bir hata olu\u015ftu";!1===a.success&&n.message?r=n.message:a.message?r=a.message:n.message&&(r=n.message);var s=a.redirect;return(0,N.jsxs)("div",{className:"error-message",children:[(0,N.jsxs)("div",{className:"error-header",children:[(0,N.jsx)("div",{className:"error-icon",children:function(){switch(t){case"NO_USAGE_TOKENS":return"\ud83d\udd11";case"USAGE_TOKENS_EXPIRED":return"\u23f0";case"INSUFFICIENT_TOKENS":return"\ud83d\udcb3";case"INVALID_PROJECT":return"\ud83d\udeab";default:return"\u26a0\ufe0f"}}()}),(0,N.jsxs)("div",{className:"error-content",children:[(0,N.jsx)("h3",{className:"error-title",children:function(){switch(t){case"NO_USAGE_TOKENS":return"Token Bulunamad\u0131";case"USAGE_TOKENS_EXPIRED":return"Token S\xfcresi Dolmu\u015f";case"INSUFFICIENT_TOKENS":return"Yetersiz Token";case"INVALID_PROJECT":return"Ge\xe7ersiz Proje";default:return"Hata"}}()}),(0,N.jsx)("p",{className:"error-description",children:function(){switch(t){case"NO_USAGE_TOKENS":return"Kullan\u0131m token'\u0131n\u0131z bulunmuyor. \xdcr\xfcn\xfc kullanmak i\xe7in sat\u0131n alman\u0131z gerekiyor.";case"USAGE_TOKENS_EXPIRED":return"Abonelik s\xfcreniz dolmu\u015f. \xdcr\xfcn\xfc kullanmak i\xe7in sat\u0131n alman\u0131z gerekiyor.";case"INSUFFICIENT_TOKENS":return"Yetersiz kullan\u0131m token'\u0131. L\xfctfen \xfcr\xfcn kullan\u0131m\u0131 i\xe7in token sat\u0131n alman\u0131z gerekiyor.";default:return r}}()})]})]}),"INSUFFICIENT_TOKENS"===t&&void 0!==a.tokens_remaining?(0,N.jsxs)("div",{className:"token-info",children:[(0,N.jsxs)("div",{className:"token-stats",children:[(0,N.jsxs)("div",{className:"token-stat",children:[(0,N.jsx)("span",{className:"label",children:"Kalan Token:"}),(0,N.jsx)("span",{className:"value",children:a.tokens_remaining})]}),(0,N.jsxs)("div",{className:"token-stat",children:[(0,N.jsx)("span",{className:"label",children:"Kullan\u0131lan:"}),(0,N.jsx)("span",{className:"value",children:a.tokens_used})]}),(0,N.jsxs)("div",{className:"token-stat",children:[(0,N.jsx)("span",{className:"label",children:"Toplam:"}),(0,N.jsx)("span",{className:"value",children:a.tokens_total})]})]}),(0,N.jsx)("div",{className:"usage-bar",children:(0,N.jsx)("div",{className:"usage-fill",style:{width:"".concat(a.usage_percentage||0,"%")}})})]}):null,s&&(0,N.jsx)("div",{className:"error-actions",children:(0,N.jsx)("button",{className:"upgrade-button",onClick:function(){s&&window.open(s,"_blank")},children:"Plan\u0131 G\xfcncelle"})})]})},P=function(e){var n=e.message,a=e.onProductClick,t=e.onFeedback,r=e.onAddMessage,s=e.onSendMessage,i="user"===n.role;if(i)return(0,N.jsx)("div",{className:"message-group user",children:(0,N.jsx)("div",{className:"message user-message",children:(0,N.jsx)("div",{className:"message-content-wrapper",children:n.content})})});var c=j();return(0,N.jsxs)("div",{className:"message-group",children:[(0,N.jsx)("div",{className:"agent-avatar",children:(0,N.jsx)("img",{src:c.small,alt:"AI Conversion Agent"})}),function(){if(i)return null;switch(n.type||n.intent||"general"){case"product_recommendation":case"product_inquiry":case"category_browse":case"order_inquiry":case"smart_recommendation":case"trend_products":case"contextual_recommendation":case"category_recommendation":return(0,N.jsx)(_,{message:n,onProductClick:a,onFeedback:t,onAddMessage:r,onSendMessage:s});case"product_detail":return(0,N.jsx)(w,{message:n,onProductClick:a,onAddMessage:r});case"price_comparison_result":return(0,N.jsx)(S,{message:n,onProductClick:a});case"product_link":return(0,N.jsx)("div",{className:"message agent-message",children:(0,N.jsx)("div",{className:"message-content-wrapper",children:(0,N.jsx)("div",{className:"product-link-message",style:{padding:"12px 16px",backgroundColor:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",margin:"8px 0"},children:(0,N.jsx)("div",{style:{fontSize:"14px",lineHeight:"1.5",color:"#E5E7EB"},dangerouslySetInnerHTML:{__html:n.content.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" style="color: #60A5FA; text-decoration: underline; font-weight: 500;">$1</a>').replace(/\*\*([^*]+)\*\*/g,'<strong style="color: #F3F4F6;">$1</strong>')}})})})});case"product_search":var e;return 0===(n.products||(null===(e=n.data)||void 0===e?void 0:e.products)||[]).length?(0,N.jsx)(D,{message:n,onFeedback:t}):(0,N.jsx)(_,{message:n,onProductClick:a,onFeedback:t,onAddMessage:r,onSendMessage:s});case"feedback":return(0,N.jsx)(E,{message:n,onFeedback:t});case"order_tracking":return(0,N.jsx)(T,{message:n,onFeedback:t});case"cargo_tracking":return(0,N.jsx)(A,{message:n,onFeedback:t});case"campaign_inquiry":default:return(0,N.jsx)(C,{message:n,onFeedback:t});case"shimmer":return(0,N.jsx)(I,{type:n.shimmerType});case"greeting":case"help_request":case"price_inquiry":case"general":case"capabilities_inquiry":case"contact_request":case"project_info":case"conversion_guidance":case"pricing_guidance":case"demo_request":case"product_recommendations":break;case"error":case"token_error":if(n.data&&n.data.error)return(0,N.jsx)(O,{message:n})}}()]})},R=function(e){var n=e.text,a=e.isUser,t=void 0!==a&&a,r=e.className,s=void 0===r?"":r,i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=g((0,f.useState)(!1),2),a=n[0],t=n[1],r=g((0,f.useState)(""),2),s=r[0],i=r[1],o=(0,f.useRef)(null),l=(0,f.useMemo)(function(){return c({lang:"tr-TR",rate:.9,pitch:1,volume:1},e)},[e]),d=(0,f.useCallback)(function(e){if(o.current&&(speechSynthesis.cancel(),o.current=null),"speechSynthesis"in window){var n=new SpeechSynthesisUtterance(e);n.lang=l.lang,n.rate=l.rate,n.pitch=l.pitch,n.volume=l.volume,i(e),t(!0),n.onstart=function(){},n.onend=function(){t(!1),i(""),o.current=null},n.onerror=function(e){t(!1),i(""),o.current=null},o.current=n,speechSynthesis.speak(n)}else alert("Bu taray\u0131c\u0131da text-to-speech desteklenmiyor.")},[l]),u=(0,f.useCallback)(function(){o.current&&(speechSynthesis.cancel(),o.current=null,t(!1),i(""))},[]),m=(0,f.useCallback)(function(e){return a&&s===e},[a,s]);return{speak:d,stop:u,isPlaying:a,currentText:s,isCurrentlyPlaying:m}}(),o=i.speak,l=i.stop,d=i.isCurrentlyPlaying,u=d(n);return(0,N.jsx)("button",{className:"tts-button ".concat(t?"user":""," ").concat(u?"playing":""," ").concat(s),onClick:function(e){e.stopPropagation(),d(n)?l():o(n)},title:u?"Sesi Durdur":"Metni Seslendir",children:(0,N.jsx)("span",{className:"tts-icon"})})},B=function(e){var n=e.welcomeText,a=e.agentName,t=e.logoUrl||j().small;return(0,N.jsxs)("div",{className:"welcome-message-container",children:[(0,N.jsx)("div",{className:"welcome-logo",children:(0,N.jsx)("img",{src:t,alt:a})}),(0,N.jsx)("div",{className:"welcome-agent-name",children:a}),(0,N.jsx)("div",{className:"welcome-text",children:n}),(0,N.jsx)("div",{className:"welcome-tts",children:(0,N.jsx)(R,{text:n})})]})};function z(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function F(e,n){for(var a=0;a<n.length;a++){var t=n[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,r(t.key),t)}}function L(e,n,a){return n&&F(e.prototype,n),a&&F(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}var U=function(){function e(){z(this,e),this.config={prefix:"browser_",storageKey:"convstateai_browser_uuid",expiryHours:72}}return L(e,[{key:"getBrowserUuid",value:function(){try{var e=this.getStoredUuid();if(e&&this.isUuidValid(e))return e.uuid;var n=this.generateUuid();return this.storeUuid(n),n}catch(a){return this.generateUuid()}}},{key:"generateUuid",value:function(){var e=Date.now(),n=Math.random().toString(36).substr(2,9),a=this.getBrowserFingerprint();return"".concat(this.config.prefix).concat(e,"_").concat(n,"_").concat(a)}},{key:"getBrowserFingerprint",value:function(){try{var e=document.createElement("canvas"),n=e.getContext("2d");n&&(n.textBaseline="top",n.font="14px Arial",n.fillText("Browser fingerprint",2,2));for(var a=[navigator.userAgent,navigator.language,window.screen.width+"x"+window.screen.height,(new Date).getTimezoneOffset(),e.toDataURL().slice(-10)].join("|"),t=0,r=0;r<a.length;r++){t=(t<<5)-t+a.charCodeAt(r),t&=t}return Math.abs(t).toString(36).substr(0,8)}catch(s){return Math.random().toString(36).substr(2,8)}}},{key:"getStoredUuid",value:function(){try{var e=localStorage.getItem(this.config.storageKey);if(!e)return null;var n=JSON.parse(e);return{uuid:n.uuid,timestamp:n.timestamp}}catch(a){return null}}},{key:"storeUuid",value:function(e){try{var n={uuid:e,timestamp:Date.now()};localStorage.setItem(this.config.storageKey,JSON.stringify(n))}catch(a){}}},{key:"isUuidValid",value:function(e){var n=Date.now(),a=60*this.config.expiryHours*60*1e3,t=n-e.timestamp<a;return t}},{key:"refreshUuid",value:function(){var e=this.generateUuid();return this.storeUuid(e),e}},{key:"clearUuid",value:function(){try{localStorage.removeItem(this.config.storageKey)}catch(e){}}},{key:"getUuidInfo",value:function(){var e=this.getStoredUuid();if(!e)return null;var n=new Date(e.timestamp),a=new Date(e.timestamp+60*this.config.expiryHours*60*1e3),t=this.isUuidValid(e);return{uuid:e.uuid,created:n,expires:a,isValid:t}}},{key:"getDebugInfo",value:function(){return null}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}])}();U.instance=void 0;var M=U.getInstance(),K=function(){function e(){z(this,e),this.token=null,this.userId=null,this.projectId=null,this.config=null,this.usageToken=null}return L(e,[{key:"setConfig",value:function(e){this.config=e,this.projectId=e.projectId,e.auth&&(this.token=e.auth.token||null,this.userId=e.auth.userId||null),e.customizationToken&&(this.token=e.customizationToken)}},{key:"setCredentials",value:function(e,n){this.token=e,this.userId=n}},{key:"getAuthHeaders",value:function(){var e={"Content-Type":"application/json",Accept:"application/json"};return this.projectId&&(e["X-Project-ID"]=this.projectId),this.token&&(e.Authorization="Bearer ".concat(this.token)),this.userId&&(e["X-User-ID"]=this.userId),e}},{key:"isAuthenticated",value:function(){return!(!this.token||!this.userId)}},{key:"getProjectId",value:function(){return this.projectId}},{key:"getUserId",value:function(){return this.userId}},{key:"getToken",value:function(){return this.token}},{key:"getConfig",value:function(){return this.config}},{key:"clearAuth",value:function(){this.token=null,this.userId=null,this.usageToken=null}},{key:"setUsageToken",value:function(e){this.usageToken=e}},{key:"getUsageToken",value:function(){return this.usageToken}},{key:"canUseToken",value:function(){return!!this.usageToken&&(this.usageToken.can_use_token&&!this.usageToken.is_expired)}},{key:"isTokenExpired",value:function(){return!this.usageToken||this.usageToken.is_expired}},{key:"getRemainingTokens",value:function(){var e;return(null===(e=this.usageToken)||void 0===e?void 0:e.tokens_remaining)||0}},{key:"getUsagePercentage",value:function(){var e;return(null===(e=this.usageToken)||void 0===e?void 0:e.usage_percentage)||0}},{key:"getTokenResetDate",value:function(){var e;return(null===(e=this.usageToken)||void 0===e?void 0:e.reset_date)||null}},{key:"getDaysUntilReset",value:function(){var e;return(null===(e=this.usageToken)||void 0===e?void 0:e.days_until_reset)||0}},{key:"getTokenStatus",value:function(){var e,n;return{canUse:this.canUseToken(),isExpired:this.isTokenExpired(),remaining:this.getRemainingTokens(),used:(null===(e=this.usageToken)||void 0===e?void 0:e.tokens_used)||0,total:(null===(n=this.usageToken)||void 0===n?void 0:n.tokens_total)||0,percentage:this.getUsagePercentage(),resetDate:this.getTokenResetDate(),daysUntilReset:this.getDaysUntilReset()}}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}])}();K.instance=void 0;var H=function(){function e(){z(this,e),this.errorHandlers=[]}return L(e,[{key:"onError",value:function(e){var n=this;return this.errorHandlers.push(e),function(){var a=n.errorHandlers.indexOf(e);a>-1&&n.errorHandlers.splice(a,1)}}},{key:"handleAPIError",value:function(e,n){var a=this.parseError(e,n);return this.notifyError(a),a}},{key:"parseError",value:function(e,n){var a,t=Date.now();if(e instanceof TypeError&&e.message.includes("fetch"))return{type:"network",message:"Ba\u011flant\u0131 hatas\u0131. \u0130nternet ba\u011flant\u0131n\u0131z\u0131 kontrol edin.",details:{originalError:e.message,context:n},timestamp:t};if(e.status||e.response&&e.response.status){var r=e.status||e.response.status;return{type:"server",status:r,message:this.getStatusMessage(r),details:{originalError:e,context:n},timestamp:t}}return"AbortError"===e.name||null!==(a=e.message)&&void 0!==a&&a.includes("timeout")?{type:"timeout",message:"\u0130stek zaman a\u015f\u0131m\u0131na u\u011frad\u0131. L\xfctfen tekrar deneyin.",details:{originalError:e,context:n},timestamp:t}:e.status>=400&&e.status<500?{type:"client",status:e.status,message:this.getClientErrorMessage(e),details:{originalError:e,context:n},timestamp:t}:{type:"unknown",message:e.message||"Bilinmeyen bir hata olu\u015ftu.",details:{originalError:e,context:n},timestamp:t}}},{key:"getStatusMessage",value:function(e){switch(e){case 400:return"Ge\xe7ersiz istek. L\xfctfen verilerinizi kontrol edin.";case 401:return"Yetkilendirme hatas\u0131. L\xfctfen giri\u015f yap\u0131n.";case 403:return"Bu i\u015flem i\xe7in yetkiniz bulunmuyor.";case 404:return"\u0130stenen kaynak bulunamad\u0131.";case 408:return"\u0130stek zaman a\u015f\u0131m\u0131na u\u011frad\u0131.";case 429:return"\xc7ok fazla istek g\xf6nderildi. L\xfctfen bekleyin.";case 500:return"Sunucu hatas\u0131. L\xfctfen daha sonra tekrar deneyin.";case 502:return"Sunucu ge\xe7ici olarak kullan\u0131lam\u0131yor.";case 503:return"Hizmet ge\xe7ici olarak kullan\u0131lam\u0131yor.";case 504:return"Sunucu yan\u0131t vermiyor.";default:return"Sunucu hatas\u0131 (".concat(e,"). L\xfctfen daha sonra tekrar deneyin.")}}},{key:"getClientErrorMessage",value:function(e){var n;return null!==(n=e.data)&&void 0!==n&&n.message?e.data.message:e.message?e.message:this.getStatusMessage(e.status)}},{key:"notifyError",value:function(e){this.errorHandlers.forEach(function(n){try{n(e)}catch(a){console.error("Error handler failed:",a)}})}},{key:"getErrorWidgetConfig",value:function(e){switch(e.type){case"network":case"timeout":return{showRetry:!0,showDetails:!1,autoHide:!1,hideDelay:0};case"client":return 401===e.status||403===e.status?{showRetry:!1,showDetails:!1,autoHide:!1,hideDelay:0,redirectUrl:"/login"}:{showRetry:!0,showDetails:!0,autoHide:!0,hideDelay:5e3};case"server":return{showRetry:!0,showDetails:!0,autoHide:!0,hideDelay:8e3};default:return{showRetry:!0,showDetails:!1,autoHide:!0,hideDelay:5e3}}}},{key:"createErrorMessage",value:function(e){return{id:"error_".concat(e.timestamp),role:"agent",content:e.message,type:"error",message:e.message,timestamp:new Date(e.timestamp),data:{error:e.type.toUpperCase(),status:e.status,details:e.details,config:this.getErrorWidgetConfig(e)}}}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}])}();H.instance=void 0;var W=H.getInstance(),G=function(){function e(){z(this,e),this.authService=K.getInstance(),this.baseUrl=""}return L(e,[{key:"setBaseUrl",value:function(e){this.baseUrl=e}},{key:"makeRequest",value:function(){var e=u(l().m(function e(n){var a,t,r,s,i,o,d,u=arguments;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return a=u.length>1&&void 0!==u[1]?u[1]:{},e.p=1,t="".concat(this.baseUrl).concat(n),r=c(c({},this.authService.getAuthHeaders()),a.headers),e.n=2,fetch(t,c(c({},a),{},{headers:r}));case 2:if((s=e.v).ok){e.n=3;break}throw i={status:s.status,statusText:s.statusText,url:t,endpoint:n},W.handleAPIError(i,"API Request: ".concat(n)),new Error("HTTP error! status: ".concat(s.status));case 3:return e.n=4,s.json();case 4:return o=e.v,e.a(2,o);case 5:return e.p=5,d=e.v,W.handleAPIError(d,"API Request: ".concat(n)),e.a(2,{success:!1,error:d instanceof Error?d.message:"Unknown error"})}},e,this,[[1,5]])}));return function(n){return e.apply(this,arguments)}}()},{key:"sendMessage",value:function(){var e=u(l().m(function e(n){var a,t,r=arguments;return l().w(function(e){for(;;)if(0===e.n)return a=r.length>1&&void 0!==r[1]?r[1]:1,t=M.getBrowserUuid(),e.a(2,this.makeRequest("/chat",{method:"POST",headers:{"X-Browser-UUID":t},body:JSON.stringify({message:n,project_id:a,browser_uuid:t})}))},e,this)}));return function(n){return e.apply(this,arguments)}}()},{key:"trackCargo",value:function(){var e=u(l().m(function e(n){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/cargo/track",{method:"POST",body:JSON.stringify({tracking_number:n})}))},e,this)}));return function(n){return e.apply(this,arguments)}}()},{key:"getWidgetCustomization",value:function(){var e=u(l().m(function e(){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/widget-customization",{method:"GET"}))},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"testEndpoint",value:function(){var e=u(l().m(function e(n){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/test-endpoint",{method:"POST",body:JSON.stringify({endpoint:n})}))},e,this)}));return function(n){return e.apply(this,arguments)}}()},{key:"getBrowserUuid",value:function(){return M.getBrowserUuid()}},{key:"refreshBrowserUuid",value:function(){return M.refreshUuid()}},{key:"getUuidDebugInfo",value:function(){return null}},{key:"addTokens",value:function(){var e=u(l().m(function e(n,a){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/add-token",{method:"POST",body:JSON.stringify({user_id:n,tokens:a})}))},e,this)}));return function(n,a){return e.apply(this,arguments)}}()},{key:"exhaustTokens",value:function(){var e=u(l().m(function e(n){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/exhaust-token",{method:"POST",body:JSON.stringify({user_id:n})}))},e,this)}));return function(n){return e.apply(this,arguments)}}()},{key:"getUsage",value:function(){var e=u(l().m(function e(){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/subscription/usage",{method:"GET"}))},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getPlans",value:function(){var e=u(l().m(function e(){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/subscription/plans",{method:"GET"}))},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getBillingHistory",value:function(){var e=u(l().m(function e(){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,this.makeRequest("/subscription/billing-history",{method:"GET"}))},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleAPIError",value:function(e){if(null!==e&&void 0!==e&&e.error)switch(e.error){case"NO_ACTIVE_PLAN":return"Aktif plan\u0131n\u0131z bulunmuyor. L\xfctfen bir plan sat\u0131n al\u0131n.";case"USAGE_TOKENS_EXPIRED":return"Kullan\u0131m token'lar\u0131n\u0131z\u0131n s\xfcresi dolmu\u015f. L\xfctfen plan\u0131n\u0131z\u0131 yenileyin.";case"INSUFFICIENT_TOKENS":return"Yetersiz kullan\u0131m token'\u0131. L\xfctfen daha fazla token sat\u0131n al\u0131n.";case"TOKEN_VALIDATION_ERROR":return"Token do\u011frulama hatas\u0131. L\xfctfen tekrar deneyin.";case"MISSING_PROJECT_ID":return"Proje ID eksik. L\xfctfen proje ayarlar\u0131n\u0131z\u0131 kontrol edin.";case"PROJECT_NOT_FOUND":return"Proje bulunamad\u0131. L\xfctfen proje ayarlar\u0131n\u0131z\u0131 kontrol edin.";case"USER_NOT_FOUND":return"Kullan\u0131c\u0131 bulunamad\u0131. L\xfctfen giri\u015f yap\u0131n.";default:return e.message||"Bilinmeyen bir hata olu\u015ftu."}return(null===e||void 0===e?void 0:e.message)||"Bilinmeyen bir hata olu\u015ftu."}},{key:"checkTokenStatus",value:function(){var e=u(l().m(function e(){var n,a;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.getUsage();case 1:if((n=e.v).success){e.n=2;break}return e.a(2,{canUse:!1,error:this.handleAPIError(n)});case 2:return a=n.data,e.a(2,{canUse:a.can_use_token&&!a.is_expired,usage:a,error:a.can_use_token?void 0:"Yetersiz token veya s\xfcresi dolmu\u015f"});case 3:return e.p=3,e.v,e.a(2,{canUse:!1,error:"Token durumu kontrol edilemedi"})}},e,this,[[0,3]])}));return function(){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}])}();G.instance=void 0;var q=function(e,n){var a=g((0,f.useState)([]),2),t=a[0],r=a[1],s=g((0,f.useState)(!1),2),i=s[0],o=s[1],d=g((0,f.useState)(!1),2),m=d[0],p=d[1],v=g((0,f.useState)(""),2),x=v[0],j=v[1],y=g((0,f.useState)(null),2),N=y[0],_=y[1],w=(0,f.useRef)(null),S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=g((0,f.useState)(!1),2),a=n[0],t=n[1],r=g((0,f.useState)(null),2),s=r[0],i=r[1],c=G.getInstance(),o=(0,f.useCallback)(function(){return M.getBrowserUuid()},[]),d=(0,f.useCallback)(function(e,n){return{type:"error",message:"API ba\u011flant\u0131s\u0131 kurulamad\u0131. L\xfctfen daha sonra tekrar deneyin.",products:[],intent:"error",confidence:0,suggestions:["Tekrar dene","Yard\u0131m al"]}},[]),m=(0,f.useCallback)(function(){var n=u(l().m(function n(a,r){var s,u,m,p,h,g,f,v,x,j,y,N,_,w;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,t(!0),i(null),p=o(),h=k(b("CHAT")),n.n=1,fetch(h,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Browser-UUID":p,"X-Project-ID":(null===(s=e.projectId)||void 0===s?void 0:s.toString())||"1401"},body:JSON.stringify({message:a,project_id:e.projectId||"1401",browser_uuid:p,context:r})});case 1:return g=n.v,n.n=2,g.json();case 2:if(f=n.v,console.log("API Response:",f),g.ok&&!1!==f.success){n.n=4;break}if(!f.error||!["NO_ACTIVE_PLAN","USAGE_TOKENS_EXPIRED","INSUFFICIENT_TOKENS","TOKEN_VALIDATION_ERROR"].includes(f.error)){n.n=3;break}return x=c.handleAPIError(f),j={type:"token_error",message:x,products:[],intent:"error",confidence:0,suggestions:["Plan sat\u0131n al","Token sat\u0131n al","Yard\u0131m al"],session_id:f.session_id||p,data:{error:f.error,redirect:f.redirect,tokens_remaining:f.tokens_remaining,tokens_used:f.tokens_used,tokens_total:f.tokens_total,usage_percentage:f.usage_percentage,reset_date:f.reset_date}},n.a(2,j);case 3:return y={type:f.type||"error",message:f.message||"Bir hata olu\u015ftu",products:(null===(v=f.data)||void 0===v?void 0:v.products)||f.products||[],intent:f.intent||f.type||"error",confidence:f.confidence||0,suggestions:[],session_id:f.session_id||p,data:f.data||f},n.a(2,y);case 4:return(N={type:f.type||"general",message:f.message||(null===(u=f.data)||void 0===u?void 0:u.message)||"\xdczg\xfcn\xfcm, \u015fu anda yan\u0131t veremiyorum.",products:(null===(m=f.data)||void 0===m?void 0:m.products)||f.products||[],intent:f.intent||f.type||"general",confidence:f.confidence||.8,suggestions:[],session_id:f.session_id||p,data:f.data||{}}).message&&""!==N.message.trim()||(N.message="\xdczg\xfcn\xfcm, \u015fu anda yan\u0131t veremiyorum."),N.products&&N.products.length>0&&("product_search"!==N.type&&"category_browse"!==N.type||(N.type="product_recommendation")),N.products&&N.products.length>0&&("product_search"===N.type||"category_browse"===N.type)&&(N.type="product_recommendation"),n.a(2,N);case 5:return n.p=5,w=n.v,_=W.handleAPIError(w,"AI Service"),i(_.message),n.a(2,d(a,r));case 6:return n.p=6,t(!1),n.f(6);case 7:return n.a(2)}},n,null,[[0,5,6,7]])}));return function(e,a){return n.apply(this,arguments)}}(),[o,d,e.projectId,c]),p=(0,f.useCallback)(function(){var e=u(l().m(function e(n,a){return l().w(function(e){for(;;)if(0===e.n)return e.a(2,m(n,{sessionId:a}))},e)}));return function(n,a){return e.apply(this,arguments)}}(),[m]),h=(0,f.useCallback)(function(){var e=u(l().m(function e(n){var a,t;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch(k(b("FEEDBACK")),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)});case 1:if((a=e.v).ok){e.n=2;break}throw new Error("Feedback API Error: ".concat(a.status));case 2:return e.n=3,a.json();case 3:return e.a(2,e.v);case 4:e.p=4,t=e.v,W.handleAPIError(t,"Feedback Service"),i("Feedback g\xf6nderilemedi");case 5:return e.a(2)}},e,null,[[0,4]])}));return function(n){return e.apply(this,arguments)}}(),[]),v=(0,f.useCallback)(function(){var e=u(l().m(function e(n){var a,t;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch(k(b("PRODUCT_CLICK")),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)});case 1:if((a=e.v).ok){e.n=2;break}throw new Error("Product Click API Error: ".concat(a.status));case 2:return e.n=3,a.json();case 3:return e.a(2,e.v);case 4:e.p=4,t=e.v,W.handleAPIError(t,"Product Click Service"),i("\xdcr\xfcn t\u0131klama kaydedilemedi");case 5:return e.a(2)}},e,null,[[0,4]])}));return function(n){return e.apply(this,arguments)}}(),[]),x=(0,f.useCallback)(function(){var e=u(l().m(function e(n){var a,t;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch(k(b("CARGO_TRACKING")),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)});case 1:if((a=e.v).ok){e.n=2;break}throw new Error("Cargo Tracking API Error: ".concat(a.status));case 2:return e.n=3,a.json();case 3:return e.a(2,e.v);case 4:e.p=4,t=e.v,W.handleAPIError(t,"Cargo Tracking Service"),i("Kargo takip bilgisi al\u0131namad\u0131");case 5:return e.a(2)}},e,null,[[0,4]])}));return function(n){return e.apply(this,arguments)}}(),[]),j=(0,f.useCallback)(u(l().m(function e(){var n;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,c.checkTokenStatus();case 1:return e.a(2,e.v);case 2:return e.p=2,n=e.v,W.handleAPIError(n,"Token Status Check"),i("Token durumu kontrol edilemedi"),e.a(2,{canUse:!1,error:"Token durumu kontrol edilemedi"})}},e,null,[[0,2]])})),[c]),y=(0,f.useCallback)(u(l().m(function e(){var n;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,c.getUsage();case 1:return e.a(2,e.v);case 2:return e.p=2,n=e.v,W.handleAPIError(n,"Usage Information"),i("Kullan\u0131m bilgileri al\u0131namad\u0131"),e.a(2,{success:!1,error:"Kullan\u0131m bilgileri al\u0131namad\u0131"})}},e,null,[[0,2]])})),[c]),N=(0,f.useCallback)(u(l().m(function e(){var n;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,c.getPlans();case 1:return e.a(2,e.v);case 2:return e.p=2,n=e.v,W.handleAPIError(n,"Plans List"),i("Plan listesi al\u0131namad\u0131"),e.a(2,{success:!1,error:"Plan listesi al\u0131namad\u0131"})}},e,null,[[0,2]])})),[c]);return{generateResponse:p,generateAIResponse:m,sendFeedback:h,sendProductClick:v,sendCargoTracking:x,checkTokenStatus:j,getUsage:y,getPlans:N,isLoading:a,error:s,clearError:function(){return i(null)}}}({apiKey:e,projectId:n}),E=S.generateAIResponse,C=S.sendFeedback,T=S.isLoading,A=(0,f.useCallback)(function(){var e=M.refreshUuid();j(e);var n=M.getUuidInfo();n&&_(n.expires)},[]);(0,f.useEffect)(function(){var e=M.getBrowserUuid();j(e);var n=M.getUuidInfo();n&&_(n.expires)},[]),(0,f.useEffect)(function(){if(N){var e=setInterval(function(){new Date>=N&&A()},6e4);return function(){return clearInterval(e)}}},[N,A]);var I=(0,f.useCallback)(function(){var e=M.getUuidInfo();e&&e.isValid?_(e.expires):A()},[A]),D=(0,f.useCallback)(function(){M.clearUuid(),j(""),_(null)},[]),O=(0,f.useCallback)(function(e){var n=e.toLowerCase();return n.includes("\xfcr\xfcn")||n.includes("product")||n.includes("sat\u0131n al")?"product":n.includes("kargo")||n.includes("cargo")||n.includes("kargom")||n.includes("takip")||n.includes("tracking")?"cargo":n.includes("sipari\u015f")||n.includes("order")||n.includes("sipari\u015fim")?"order":n.includes("feedback")||n.includes("geri bildirim")?"feedback":"general"},[]),P=(0,f.useCallback)(function(e,n,a,s){if(console.log("addMessage called with:",{text:e,role:n,products:a,additionalData:s}),"agent"===n){var i=Date.now();if(t.slice(-3).some(function(a){return i-a.timestamp.getTime()<1e3&&a.content===e&&a.role===n}))return void console.log("Duplicate message prevented")}var o=c({id:"".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),content:e,role:n,timestamp:new Date,products:a||[]},s);"user"===n&&(o.protected=!0,o.protectionExpiry=new Date(Date.now()+1e4)),console.log("Setting messages, current count:",t.length,"new message:",o),r(function(e){var n=[].concat(h(e),[o]);return console.log("Updated messages count:",n.length),n}),p(!0)},[]),R=(0,f.useCallback)(function(){var e=u(l().m(function e(n){var a,t,s,i,c,d,u,m;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return o(!0),I(),a=O(n),t={id:"shimmer_".concat(Date.now()),role:"agent",content:"",type:"shimmer",shimmerType:a,timestamp:new Date},r(function(e){return[].concat(h(e),[t])}),e.p=1,i=1e3*Math.random()+1500,e.n=2,new Promise(function(e){return setTimeout(e,i)});case 2:return e.n=3,E(n);case 3:return c=e.v,console.log("AI Response:",c),c.products&&0!==c.products.length||c.data&&c.data.products&&c.data.products.length>0&&(c.products=c.data.products),d={type:c.type||"general",intent:c.intent||c.type||"general",suggestions:c.suggestions||[],data:c.data||{},session_id:x},u=c.products||(null===(s=c.data)||void 0===s?void 0:s.products)||[],e.n=4,new Promise(function(e){return setTimeout(e,300)});case 4:r(function(e){return e.filter(function(e){return"shimmer"!==e.type&&(e.protected&&e.protectionExpiry&&(e.protectionExpiry,new Date),!0)})}),m=c.message||c.type||"\xdczg\xfcn\xfcm, \u015fu anda yan\u0131t veremiyorum.",console.log("Adding message:",m,"Role: agent"),P(m,"agent",u,d),e.n=6;break;case 5:e.p=5,e.v,r(function(e){return e.filter(function(e){return"shimmer"!==e.type&&(e.protected&&e.protectionExpiry&&(e.protectionExpiry,new Date),!0)})}),P("\xdczg\xfcn\xfcm, \u015fu anda yan\u0131t \xfcretemiyorum. L\xfctfen daha sonra tekrar deneyin.","agent");case 6:return e.p=6,o(!1),e.f(6);case 7:return e.a(2)}},e,null,[[1,5,6,7]])}));return function(n){return e.apply(this,arguments)}}(),[E,P,x,I,O]),B=(0,f.useCallback)(function(){var e=u(l().m(function e(n){return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n.trim()){e.n=1;break}return e.a(2);case 1:return P(n,"user"),e.n=2,new Promise(function(e){return setTimeout(e,100)});case 2:return e.p=2,e.n=3,R(n);case 3:e.n=5;break;case 4:e.p=4,e.v;case 5:return e.a(2)}},e,null,[[2,4]])}));return function(n){return e.apply(this,arguments)}}(),[P,R]),z=(0,f.useCallback)(function(e){e.url?P("\ud83d\udd17 \xdcr\xfcn detay sayfas\u0131na y\xf6nlendiriliyorsunuz:\n\n[".concat(e.url,"](").concat(e.url,")"),"agent"):P('"'.concat(e.name,'" \xfcr\xfcn\xfcn\xfc se\xe7tiniz. Bu \xfcr\xfcn hakk\u0131nda daha fazla bilgi almak ister misiniz?'),"agent")},[P]),F=(0,f.useCallback)(function(e){C(e)},[C]),L=(0,f.useCallback)(function(e){},[]);return(0,f.useEffect)(function(){m&&w.current&&(w.current.scrollTop=w.current.scrollHeight,p(!1))},[m,t]),(0,f.useEffect)(function(){w.current&&(w.current.scrollTop=w.current.scrollHeight)},[t]),(0,f.useEffect)(function(){L(i)},[i,L]),{messages:t,isTyping:i,aiLoading:T,chatContentRef:w,sendMessage:B,handleProductClick:z,handleFeedback:F,addMessage:P,generateAIResponse:R,browserUuid:x,sessionExpiry:N,refreshBrowserUuid:A,refreshSession:I,clearSession:D}},V=function(e){var n=e.messages,a=e.onProductClick,t=e.onFeedback,r=e.welcomeMessage,s=e.widgetCustomization,i=e.onAddMessage,c=e.onSendMessage,o=q().chatContentRef,l=(null===s||void 0===s?void 0:s.ai_name)||"ConvState AI",d="Merhaba ben ".concat(l,", sizin tercihlerinize g\xf6re \xfcr\xfcn \xf6nerileri sunuyorum. Size nas\u0131l yard\u0131mc\u0131 olabilirim?"),u=r||d;return(0,N.jsxs)("div",{className:"chat-content",ref:o,children:[(0,N.jsx)(B,{welcomeText:u,agentName:l,logoUrl:j().small}),n.map(function(e){return(0,N.jsx)(P,{message:e,onProductClick:a,onFeedback:t,onAddMessage:i,onSendMessage:c},e.id)})]})},Y=function(e){var n=e.onSendMessage,a=e.disabled,t=void 0!==a&&a,r=e.placeholder,s=void 0===r?"Message...":r,i=e.setMessage,o=g((0,f.useState)(""),2),l=o[0],d=o[1],u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=g((0,f.useState)(!1),2),a=n[0],t=n[1],r=g((0,f.useState)(""),2),s=r[0],i=r[1],o=g((0,f.useState)(null),2),l=o[0],d=o[1],u=(0,f.useRef)(null);return{isListening:a,transcript:s,error:l,startListening:(0,f.useCallback)(function(n){var a=c({lang:"tr-TR",continuous:!1,interimResults:!1},e);if("webkitSpeechRecognition"in window||"SpeechRecognition"in window)try{var r=new(window.SpeechRecognition||window.webkitSpeechRecognition);r.lang=a.lang,r.continuous=a.continuous,r.interimResults=a.interimResults,u.current=r,r.onstart=function(){t(!0),d(null),i("")},r.onresult=function(e){for(var a="",t="",r=e.resultIndex;r<e.results.length;r++){var s=e.results[r][0].transcript;e.results[r].isFinal?a+=s:t+=s}i(a||t),n&&a&&n(a)},r.onend=function(){t(!1),u.current=null},r.onerror=function(e){d("Ses tan\u0131ma hatas\u0131: ".concat(e.error)),t(!1),u.current=null},r.start()}catch(s){d("Ses tan\u0131ma ba\u015flat\u0131lamad\u0131.")}else d("Bu taray\u0131c\u0131da speech-to-text desteklenmiyor.")},[e]),stopListening:(0,f.useCallback)(function(){u.current&&(u.current.stop(),u.current=null),t(!1)},[]),reset:(0,f.useCallback)(function(){i(""),d(null),t(!1),u.current&&(u.current.stop(),u.current=null)},[])}}(),m=u.isListening,p=u.startListening,h=u.stopListening,v=u.error,x=function(e){d(e),i&&i(e)},j=function(){l.trim()&&!t&&(n(l.trim()),d(""))};return(0,N.jsxs)("div",{className:"input-area",children:[(0,N.jsxs)("div",{className:"input-wrapper",children:[(0,N.jsx)("input",{type:"text",value:l,onChange:function(e){return x(e.target.value)},onKeyPress:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),j())},placeholder:s,disabled:t,id:"messageInput"}),(0,N.jsx)("button",{onClick:j,disabled:t||!l.trim(),className:"send-button",title:"Mesaj G\xf6nder",children:(0,N.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[(0,N.jsx)("path",{d:"M22 2L11 13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,N.jsx)("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})]}),v&&(0,N.jsx)("div",{className:"voice-error",style:{color:"#ef4444",fontSize:"0.75rem",marginBottom:"4px"},children:v}),(0,N.jsx)("button",{className:"voice-button ".concat(m?"recording":""),onClick:function(){m?h():p(function(e){var n=l.trim(),a=n?"".concat(n," ").concat(e):e;x(a)})},title:m?"Ses Kayd\u0131n\u0131 Durdur":"Sesli Mesaj Kaydet",children:m?(0,N.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,N.jsxs)("rect",{x:"2",y:"12",width:"2",height:"2",fill:"currentColor",className:"voice-wave wave-1",children:[(0,N.jsx)("animate",{attributeName:"height",values:"2;8;2",dur:"0.6s",repeatCount:"indefinite"}),(0,N.jsx)("animate",{attributeName:"y",values:"12;8;12",dur:"0.6s",repeatCount:"indefinite"})]}),(0,N.jsxs)("rect",{x:"6",y:"10",width:"2",height:"6",fill:"currentColor",className:"voice-wave wave-2",children:[(0,N.jsx)("animate",{attributeName:"height",values:"6;12;6",dur:"0.8s",repeatCount:"indefinite"}),(0,N.jsx)("animate",{attributeName:"y",values:"10;6;10",dur:"0.8s",repeatCount:"indefinite"})]}),(0,N.jsxs)("rect",{x:"10",y:"8",width:"2",height:"8",fill:"currentColor",className:"voice-wave wave-3",children:[(0,N.jsx)("animate",{attributeName:"height",values:"8;16;8",dur:"0.7s",repeatCount:"indefinite"}),(0,N.jsx)("animate",{attributeName:"y",values:"8;4;8",dur:"0.7s",repeatCount:"indefinite"})]}),(0,N.jsxs)("rect",{x:"14",y:"10",width:"2",height:"6",fill:"currentColor",className:"voice-wave wave-4",children:[(0,N.jsx)("animate",{attributeName:"height",values:"6;12;6",dur:"0.9s",repeatCount:"indefinite"}),(0,N.jsx)("animate",{attributeName:"y",values:"10;6;10",dur:"0.9s",repeatCount:"indefinite"})]}),(0,N.jsxs)("rect",{x:"18",y:"12",width:"2",height:"2",fill:"currentColor",className:"voice-wave wave-5",children:[(0,N.jsx)("animate",{attributeName:"height",values:"2;8;2",dur:"0.65s",repeatCount:"indefinite"}),(0,N.jsx)("animate",{attributeName:"y",values:"12;8;12",dur:"0.65s",repeatCount:"indefinite"})]})]}):(0,N.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,N.jsx)("path",{d:"M12 1C11.2044 1 10.4413 1.31607 9.87868 1.87868C9.31607 2.44129 9 3.20435 9 4V12C9 12.7956 9.31607 13.5587 9.87868 14.1213C10.4413 14.6839 11.2044 15 12 15C12.7956 15 13.5587 14.6839 14.1213 14.1213C14.6839 13.5587 15 12.7956 15 12V4C15 3.20435 14.6839 2.44129 14.1213 1.87868C13.5587 1.31607 12.7956 1 12 1Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,N.jsx)("path",{d:"M19 10V12C19 13.8565 18.2625 15.637 16.9497 16.9497C15.637 18.2625 13.8565 19 12 19C10.1435 19 8.36301 18.2625 7.05025 16.9497C5.7375 15.637 5 13.8565 5 12V10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,N.jsx)("path",{d:"M12 19V23",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,N.jsx)("path",{d:"M8 23H16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})]})},J=function(e){var n=e.onAction,a=(0,f.useRef)(null),t=g((0,f.useState)(!1),2),r=t[0],s=t[1],i=g((0,f.useState)(0),2),c=i[0],o=i[1],l=g((0,f.useState)(0),2),d=l[0],u=l[1];return(0,f.useEffect)(function(){var e=function(){s(!1)};return document.addEventListener("mouseup",e),function(){document.removeEventListener("mouseup",e)}},[]),(0,N.jsx)("div",{className:"action-buttons",children:(0,N.jsx)("div",{className:"action-buttons-scroll-container",ref:a,onMouseDown:function(e){a.current&&(s(!0),o(e.pageX-a.current.offsetLeft),u(a.current.scrollLeft),e.preventDefault())},onMouseMove:function(e){if(r&&a.current){var n=2*(e.pageX-a.current.offsetLeft-c);a.current.scrollLeft=d-n}},onMouseUp:function(){s(!1)},onMouseLeave:function(){s(!1)},style:{cursor:r?"grabbing":"grab"},children:(0,N.jsx)("div",{className:"action-buttons-wrapper",children:["Rastgele bir \xfcr\xfcn \xf6ner.","Kargom nerede?","Sipari\u015fim nerede?"].map(function(e,a){return(0,N.jsx)("button",{className:"secondary-button",onClick:function(){return n(e)},children:e},a)})})})})},Z=function(){return(0,N.jsxs)("div",{className:"chat-footer",children:[(0,N.jsx)("a",{href:"https://convstateai.com",target:"_blank",rel:"noopener noreferrer",className:"privacy-link",children:"ConvState AI"}),(0,N.jsx)("span",{className:"separator",children:"\u2022"}),(0,N.jsx)("span",{className:"footer-text",children:"Sizin dijital asistan\u0131n\u0131z"})]})},X=function(e){var n=e.isVisible,a=e.onClose,t=g((0,f.useState)([]),2),r=t[0],s=t[1],i=g((0,f.useState)(!0),2),c=i[0],o=i[1],d=g((0,f.useState)(null),2),m=d[0],p=d[1];(0,f.useEffect)(function(){n&&h()},[n]);var h=function(){var e=u(l().m(function e(){var n,a,t,r,i,c;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,o(!0),p(null),n=k("/api"),a="undefined"!==typeof window&&window.WIDGET_PROJECT_ID||"1",e.n=1,fetch("".concat(n,"/campaigns?project_id=").concat(a),{headers:{Accept:"application/json","Content-Type":"application/json"}});case 1:if((t=e.v).ok){e.n=3;break}if(404!==t.status){e.n=2;break}return s([]),p(null),e.a(2);case 2:throw new Error("Kampanyalar y\xfcklenirken hata olu\u015ftu: ".concat(t.status));case 3:return e.n=4,t.text();case 4:r=e.v,e.p=5,i=JSON.parse(r),e.n=7;break;case 6:throw e.p=6,e.v,new Error("API response JSON format\u0131nda de\u011fil");case 7:i.success?s(i.data||[]):p(i.message||"Kampanyalar y\xfcklenemedi"),e.n=9;break;case 8:e.p=8,c=e.v,p(c instanceof Error?c.message:"Bilinmeyen hata olu\u015ftu");case 9:return e.p=9,o(!1),e.f(9);case 10:return e.a(2)}},e,null,[[5,6],[0,8,9,10]])}));return function(){return e.apply(this,arguments)}}(),v=function(e){if(!e)return"S\xfcrekli";try{return new Date(e).toLocaleDateString("tr-TR")}catch(n){return"Ge\xe7ersiz tarih"}},x=function(e){switch(e.discount_type){case"percentage":return"%".concat(e.discount_value," \u0130ndirim");case"fixed":return"".concat(e.discount_value," TL \u0130ndirim");case"free_shipping":return"\xdccretsiz Kargo";default:return e.discount}};return c?(0,N.jsx)("div",{className:"campaign-tab-content",children:(0,N.jsxs)("div",{className:"campaign-content",children:[(0,N.jsxs)("div",{className:"campaign-item shimmer",children:[(0,N.jsxs)("div",{className:"campaign-item-header",children:[(0,N.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,N.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]}),(0,N.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full mb-2"}),(0,N.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]}),(0,N.jsxs)("div",{className:"campaign-item shimmer",children:[(0,N.jsxs)("div",{className:"campaign-item-header",children:[(0,N.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-2"}),(0,N.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/3"})]}),(0,N.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full mb-2"}),(0,N.jsx)("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]})}):m?(0,N.jsxs)("div",{className:"campaign-tab-content",children:[(0,N.jsx)("div",{className:"campaign-content",children:(0,N.jsxs)("div",{className:"campaign-item error-state",children:[(0,N.jsxs)("div",{className:"campaign-item-header",children:[(0,N.jsx)("h4",{className:"text-red-600",children:"\u26a0\ufe0f Hata Olu\u015ftu"}),(0,N.jsx)("span",{className:"campaign-category error-category",children:"Sistem Hatas\u0131"})]}),(0,N.jsx)("p",{className:"campaign-description text-red-500",children:m}),(0,N.jsxs)("div",{className:"campaign-item-footer",children:[(0,N.jsx)("span",{className:"campaign-discount error-discount",children:"Y\xfcklenemedi"}),(0,N.jsx)("span",{className:"campaign-validity",children:"\u015eimdi"})]}),(0,N.jsx)("div",{className:"campaign-details",children:(0,N.jsx)("button",{onClick:h,className:"campaign-retry-btn",children:"\ud83d\udd04 Tekrar Dene"})})]})}),(0,N.jsx)("div",{className:"campaign-footer",children:(0,N.jsx)("button",{className:"campaign-action-btn",onClick:a,children:"\ud83d\udcac Chat'e D\xf6n"})})]}):r&&0!==r.length?(0,N.jsxs)("div",{className:"campaign-tab-content",children:[(0,N.jsx)("div",{className:"campaign-content",children:r.map(function(e){return(0,N.jsxs)("div",{className:"campaign-item",children:[(0,N.jsxs)("div",{className:"campaign-item-header",children:[(0,N.jsx)("h4",{children:e.title}),(0,N.jsx)("span",{className:"campaign-category",children:e.category})]}),(0,N.jsx)("p",{className:"campaign-description",children:e.description}),(0,N.jsxs)("div",{className:"campaign-item-footer",children:[(0,N.jsx)("span",{className:"campaign-discount",children:x(e)}),(0,N.jsxs)("span",{className:"campaign-validity",children:["Ge\xe7erli: ",v(e.end_date)]})]}),e.minimum_order_amount&&(0,N.jsx)("div",{className:"campaign-details",children:(0,N.jsxs)("small",{className:"text-gray-500",children:["Min. Sipari\u015f: ",e.minimum_order_amount," TL"]})})]},e.id)})}),(0,N.jsx)("div",{className:"campaign-footer",children:(0,N.jsx)("button",{className:"campaign-action-btn",onClick:a,children:"\ud83d\udcac Chat'e D\xf6n"})})]}):(0,N.jsxs)("div",{className:"campaign-tab-content",children:[(0,N.jsx)("div",{className:"campaign-content",children:(0,N.jsx)("div",{className:"campaign-item empty-state",children:(0,N.jsxs)("div",{className:"text-center py-8",children:[(0,N.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:"\ud83d\udce2"}),(0,N.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Hen\xfcz Kampanya Yok"}),(0,N.jsx)("p",{className:"text-gray-500",children:"Bu site i\xe7in hen\xfcz aktif kampanya bulunmuyor. Y\xf6netici panelinden kampanya eklenebilir."})]})})}),(0,N.jsx)("div",{className:"campaign-footer",children:(0,N.jsx)("button",{className:"campaign-action-btn",onClick:a,children:"\ud83d\udcac Chat'e D\xf6n"})})]})},$=function(e){var n=e.isVisible,a=e.onClose,t=g((0,f.useState)(null),2),r=t[0],s=t[1],i=g((0,f.useState)([]),2),o=i[0],d=i[1],m=g((0,f.useState)(!0),2),p=m[0],h=m[1],v=g((0,f.useState)(null),2),x=v[0],j=v[1];(0,f.useEffect)(function(){n&&y()},[n]);var y=function(){var e=u(l().m(function e(){var n,a,t,r,s,i;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,h(!0),j(null),n=k("/api"),a="undefined"!==typeof window&&window.WIDGET_PROJECT_ID||"1",e.n=1,fetch("".concat(n,"/faqs?project_id=").concat(a),{headers:{Accept:"application/json","Content-Type":"application/json"}});case 1:if((t=e.v).ok){e.n=3;break}if(404!==t.status){e.n=2;break}return d([]),j(null),e.a(2);case 2:throw new Error("SSS y\xfcklenirken hata olu\u015ftu: ".concat(t.status));case 3:return e.n=4,t.text();case 4:r=e.v,e.p=5,s=JSON.parse(r),e.n=7;break;case 6:throw e.p=6,e.v,new Error("API response JSON format\u0131nda de\u011fil");case 7:s.success?d(s.data||[]):j(s.message||"SSS y\xfcklenemedi"),e.n=9;break;case 8:e.p=8,i=e.v,j(i instanceof Error?i.message:"Bilinmeyen hata olu\u015ftu");case 9:return e.p=9,h(!1),e.f(9);case 10:return e.a(2)}},e,null,[[5,6],[0,8,9,10]])}));return function(){return e.apply(this,arguments)}}(),b=function(){var e=u(l().m(function e(n){var a;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,a=k("/api"),e.n=1,fetch("".concat(a,"/faqs/").concat(n,"/helpful"),{method:"POST",headers:{"Content-Type":"application/json"}});case 1:d(function(e){return e.map(function(e){return e.id===n?c(c({},e),{},{helpful_count:e.helpful_count+1}):e})}),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(n){return e.apply(this,arguments)}}(),_=function(){var e=u(l().m(function e(n){var a;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,a=k("/api"),e.n=1,fetch("".concat(a,"/faqs/").concat(n,"/not-helpful"),{method:"POST",headers:{"Content-Type":"application/json"}});case 1:d(function(e){return e.map(function(e){return e.id===n?c(c({},e),{},{not_helpful_count:e.not_helpful_count+1}):e})}),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(n){return e.apply(this,arguments)}}();return p?(0,N.jsx)("div",{className:"campaign-tab-content",children:(0,N.jsxs)("div",{className:"campaign-content",children:[(0,N.jsxs)("div",{className:"campaign-item shimmer",children:[(0,N.jsxs)("div",{className:"campaign-item-header",children:[(0,N.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,N.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]}),(0,N.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full mb-2"}),(0,N.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]}),(0,N.jsxs)("div",{className:"campaign-item shimmer",children:[(0,N.jsxs)("div",{className:"campaign-item-header",children:[(0,N.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-2"}),(0,N.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/3"})]}),(0,N.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full mb-2"}),(0,N.jsx)("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]})}):x?(0,N.jsxs)("div",{className:"campaign-tab-content",children:[(0,N.jsx)("div",{className:"campaign-content",children:(0,N.jsxs)("div",{className:"campaign-item error-state",children:[(0,N.jsxs)("div",{className:"campaign-item-header",children:[(0,N.jsx)("h4",{className:"text-red-600",children:"\u26a0\ufe0f Hata Olu\u015ftu"}),(0,N.jsx)("span",{className:"campaign-category error-category",children:"Sistem Hatas\u0131"})]}),(0,N.jsx)("p",{className:"campaign-description text-red-500",children:x}),(0,N.jsxs)("div",{className:"campaign-item-footer",children:[(0,N.jsx)("span",{className:"campaign-discount error-discount",children:"Y\xfcklenemedi"}),(0,N.jsx)("span",{className:"campaign-validity",children:"\u015eimdi"})]}),(0,N.jsx)("div",{className:"campaign-details",children:(0,N.jsx)("button",{onClick:y,className:"campaign-retry-btn",children:"\ud83d\udd04 Tekrar Dene"})})]})}),(0,N.jsx)("div",{className:"campaign-footer",children:(0,N.jsx)("button",{className:"campaign-action-btn",onClick:a,children:"\ud83d\udcac Chat'e D\xf6n"})})]}):o&&0!==o.length?(0,N.jsxs)("div",{className:"campaign-tab-content",children:[(0,N.jsx)("div",{className:"campaign-content",children:o.map(function(e){return(0,N.jsxs)("div",{className:"campaign-item",onClick:function(){return n=e.id,void s(r===n?null:n);var n},children:[(0,N.jsxs)("div",{className:"campaign-item-header",children:[(0,N.jsx)("h4",{children:e.title}),(0,N.jsx)("span",{className:"campaign-category",children:e.category})]}),(0,N.jsx)("p",{className:"campaign-description",children:e.description}),(0,N.jsxs)("div",{className:"campaign-item-footer",children:[(0,N.jsx)("span",{className:"campaign-discount",children:e.short_answer}),(0,N.jsx)("span",{className:"campaign-validity",children:r===e.id?"Detaylar A\xe7\u0131k":"Detaylar i\xe7in t\u0131klay\u0131n"})]}),r===e.id&&(0,N.jsx)("div",{className:"faq-answer-expanded",children:(0,N.jsxs)("div",{className:"faq-answer-content",children:[(0,N.jsx)("p",{children:e.answer}),(0,N.jsx)("div",{className:"faq-feedback mt-4 pt-4 border-t border-gray-200",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("div",{className:"text-sm text-gray-500",children:"Bu bilgi faydal\u0131 m\u0131yd\u0131?"}),(0,N.jsxs)("div",{className:"flex space-x-2",children:[(0,N.jsxs)("button",{onClick:function(n){n.stopPropagation(),b(e.id)},className:"flex items-center px-3 py-1 text-sm text-green-600 hover:text-green-700 border border-green-300 rounded-md hover:bg-green-50",children:["\ud83d\udc4d Faydal\u0131 (",e.helpful_count,")"]}),(0,N.jsxs)("button",{onClick:function(n){n.stopPropagation(),_(e.id)},className:"flex items-center px-3 py-1 text-sm text-red-600 hover:text-red-700 border border-red-300 rounded-md hover:bg-red-50",children:["\ud83d\udc4e Faydal\u0131 De\u011fil (",e.not_helpful_count,")"]})]})]})})]})})]},e.id)})}),(0,N.jsx)("div",{className:"campaign-footer",children:(0,N.jsx)("button",{className:"campaign-action-btn",onClick:a,children:"\ud83d\udcac Chat'e D\xf6n"})})]}):(0,N.jsxs)("div",{className:"campaign-tab-content",children:[(0,N.jsx)("div",{className:"campaign-content",children:(0,N.jsx)("div",{className:"campaign-item empty-state",children:(0,N.jsxs)("div",{className:"text-center py-8",children:[(0,N.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:"\u2753"}),(0,N.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Hen\xfcz SSS Yok"}),(0,N.jsx)("p",{className:"text-gray-500",children:"Bu site i\xe7in hen\xfcz s\u0131k sorulan soru eklenmemi\u015f. Y\xf6netici panelinden SSS eklenebilir."})]})})}),(0,N.jsx)("div",{className:"campaign-footer",children:(0,N.jsx)("button",{className:"campaign-action-btn",onClick:a,children:"\ud83d\udcac Chat'e D\xf6n"})})]})},Q=function(e){var n=e.isVisible,a=e.onClose,t=e.onOpenChat,r=e.settings,s=g((0,f.useState)(!1),2),i=s[0],c=s[1],o=g((0,f.useState)(!1),2),l=o[0],d=o[1],u=(0,f.useCallback)(function(){d(!0),setTimeout(function(){a(),d(!1),c(!1)},300)},[a]);(0,f.useEffect)(function(){n&&r&&c(!0)},[n,r,u]);if(!n||!r)return null;return(0,N.jsx)("div",{className:"notification-widget ".concat(l?"notification-widget-closing":i?"notification-widget-".concat(r.animation_type):""),onClick:function(){t&&t(),u()},children:(0,N.jsxs)("div",{className:"notification-speech-bubble",children:[(0,N.jsxs)("div",{className:"notification-content",children:[(0,N.jsx)("div",{className:"notification-header",children:(0,N.jsx)("span",{className:"notification-sender",children:(null===r||void 0===r?void 0:r.ai_name)||"ConvState AI"})}),(0,N.jsx)("div",{className:"notification-message",children:r.message_text})]}),r.show_close_button&&(0,N.jsx)("button",{className:"notification-close-btn",onClick:function(e){e.stopPropagation(),u()},title:"Kapat",children:"\xd7"})]})})},ee=function(e){var n,a=e.message,t=e.onRetry,r=e.onDismiss,s=g((0,f.useState)(!0),2),i=s[0],c=s[1],o=g((0,f.useState)(!1),2),l=o[0],d=o[1],u=a.data||{},m={type:(null===(n=u.error)||void 0===n?void 0:n.toLowerCase())||"unknown",status:u.status,message:a.message||a.content||"Unknown error",details:u.details,timestamp:new Date(a.timestamp).getTime()},p=u.config||{showRetry:!0,showDetails:!1,autoHide:!0,hideDelay:5e3};(0,f.useEffect)(function(){if(p.autoHide&&p.hideDelay>0){var e=setTimeout(function(){c(!1),null===r||void 0===r||r()},p.hideDelay);return function(){return clearTimeout(e)}}},[p.autoHide,p.hideDelay,r]);var h=function(){switch(m.type){case"network":return"#3B82F6";case"server":return"#EF4444";case"client":return"#F59E0B";case"timeout":return"#8B5CF6";default:return"#6B7280"}};return i?(0,N.jsxs)("div",{className:"api-error-message",style:{borderLeftColor:h()},children:[(0,N.jsxs)("div",{className:"api-error-header",children:[(0,N.jsx)("div",{className:"api-error-icon",style:{color:h()},children:function(){switch(m.type){case"network":return"\ud83c\udf10";case"server":return"\ud83d\udd27";case"client":return"\u26a0\ufe0f";case"timeout":return"\u23f0";default:return"\u274c"}}()}),(0,N.jsxs)("div",{className:"api-error-content",children:[(0,N.jsx)("h3",{className:"api-error-title",children:function(){switch(m.type){case"network":return"Ba\u011flant\u0131 Hatas\u0131";case"server":return"Sunucu Hatas\u0131";case"client":return"\u0130stek Hatas\u0131";case"timeout":return"Zaman A\u015f\u0131m\u0131";default:return"Hata"}}()}),(0,N.jsx)("p",{className:"api-error-description",children:m.message}),m.status&&(0,N.jsxs)("div",{className:"api-error-status",children:[(0,N.jsx)("span",{className:"status-label",children:"Durum Kodu:"}),(0,N.jsx)("span",{className:"status-code",children:m.status})]})]}),(0,N.jsxs)("div",{className:"api-error-actions",children:[p.showDetails&&m.details&&(0,N.jsx)("button",{className:"api-error-details-btn",onClick:function(){return d(!l)},title:"Detaylar\u0131 g\xf6ster/gizle",children:l?"\ud83d\udc41\ufe0f\u200d\ud83d\udde8\ufe0f":"\ud83d\udc41\ufe0f"}),(0,N.jsx)("button",{className:"api-error-close-btn",onClick:function(){c(!1),null===r||void 0===r||r()},title:"Kapat",children:"\u2715"})]})]}),l&&m.details&&(0,N.jsxs)("div",{className:"api-error-details",children:[(0,N.jsx)("h4",{children:"Hata Detaylar\u0131:"}),(0,N.jsx)("pre",{className:"api-error-details-content",children:JSON.stringify(m.details,null,2)})]}),(0,N.jsxs)("div",{className:"api-error-footer",children:[p.showRetry&&(0,N.jsx)("button",{className:"api-error-retry-btn",onClick:function(){null===t||void 0===t||t(),c(!1)},children:"\ud83d\udd04 Tekrar Dene"}),p.redirectUrl&&(0,N.jsxs)("button",{className:"api-error-redirect-btn",onClick:function(){p.redirectUrl&&(window.location.href=p.redirectUrl)},children:["\ud83d\udd17 ",p.redirectUrl.includes("login")?"Giri\u015f Yap":"Y\xf6nlendir"]}),p.autoHide&&(0,N.jsx)("div",{className:"api-error-auto-hide",children:(0,N.jsxs)("span",{children:["Bu mesaj ",Math.ceil(p.hideDelay/1e3)," saniye sonra kapanacak"]})})]})]}):null},ne=function(e){var n,a=e.config,t=e.onEvent,r=(e.onFeedback,e.onToggleChat,g((0,f.useState)(!0),2)),s=r[0],i=r[1],o=g((0,f.useState)(!1),2),d=o[0],m=o[1],p=g((0,f.useState)(!1),2),v=p[0],x=p[1],y=g((0,f.useState)(!1),2),b=y[0],_=y[1],w=g((0,f.useState)(!1),2),S=w[0],E=w[1],C=g((0,f.useState)(!1),2),T=C[0],A=C[1],I=g((0,f.useState)(null),2),D=I[0],O=I[1],P=g((0,f.useState)({campaigns:!1,faqs:!1,loading:!0}),2),R=P[0],B=P[1],z=g((0,f.useState)([]),2),F=z[0],L=z[1],U=g((0,f.useState)({ai_name:"ConvState AI",welcome_message:"Merhaba ben Kadir, senin dijital asistan\u0131n\u0131m. Sana nas\u0131l yard\u0131mc\u0131 olabilirim?",ai_personality:"friendly",theme_color:"#3B82F6",font_family:"Inter",primary_color:"#3B82F6",secondary_color:"#6B7280",language:"tr",rate_limit_per_minute:10,api_timeout_seconds:10,max_retry_attempts:2,enable_typing_indicator:!0,enable_sound_notifications:!1}),2),M=U[0],K=U[1],H=q(void 0,null===a||void 0===a?void 0:a.projectId),G=H.messages,ne=H.sendMessage,ae=H.handleProductClick,te=H.handleFeedback,re=H.addMessage,se=(0,f.useCallback)(function(){if("undefined"!==typeof document){var e=document.documentElement;e.style.setProperty("--widget-primary-color",M.primary_color),e.style.setProperty("--widget-secondary-color",M.secondary_color),e.style.setProperty("--widget-theme-color",M.theme_color),e.style.setProperty("--widget-font-family",M.font_family),M.logo_url&&e.style.setProperty("--widget-logo-url","url(".concat(M.logo_url,")"))}},[M]);(0,f.useEffect)(function(){se()},[se]),(0,f.useEffect)(function(){return W.onError(function(e){var n=W.createErrorMessage(e);L(function(e){return[].concat(h(e),[n])})})},[]);var ie=(0,f.useCallback)(u(l().m(function e(){var n,t,r,s,i,c,o,d,u,m;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n=k("/api"),t=(null===a||void 0===a?void 0:a.projectId)||"1",e.n=1,Promise.allSettled([fetch("".concat(n,"/campaigns/check-availability?project_id=").concat(t),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}),fetch("".concat(n,"/faqs/check-availability?project_id=").concat(t),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}})]);case 1:if(r=e.v,s=g(r,2),i=s[0],c=s[1],o=!1,d=!1,"fulfilled"!==i.status||!i.value.ok){e.n=3;break}return e.n=2,i.value.json();case 2:u=e.v,o=u.success&&u.has_campaigns;case 3:if("fulfilled"!==c.status||!c.value.ok){e.n=5;break}return e.n=4,c.value.json();case 4:m=e.v,d=m.success&&m.has_faqs;case 5:B({campaigns:o,faqs:d,loading:!1}),e.n=7;break;case 6:e.p=6,e.v,B({campaigns:!1,faqs:!1,loading:!1});case 7:return e.a(2)}},e,null,[[0,6]])})),[]),ce=function(){var e=u(l().m(function e(){var n,a,t,r,s,i,o,d,u,m,p,h,g,f,v;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n="undefined"!==typeof window&&window.WIDGET_CONFIG?window.WIDGET_CONFIG:{DEFAULT_AI_NAME:"ConvState AI",DEFAULT_WELCOME_MESSAGE:"Merhaba! Size nas\u0131l yard\u0131mc\u0131 olabilirim?"},e.p=1,r=(null===(a=window.convstateaiConfig)||void 0===a?void 0:a.projectId)||(null===n||void 0===n?void 0:n.projectId)||"2",s=(null===(t=window.convstateaiConfig)||void 0===t?void 0:t.customizationToken)||(null===n||void 0===n?void 0:n.customizationToken)){e.n=2;break}throw new Error("Customization token not found");case 2:return i=k("/api/widget-customization?projectId=".concat(r,"&customizationToken=").concat(s)),e.n=3,fetch(i,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});case 3:if(!(o=e.v).ok){e.n=6;break}return e.n=4,o.json();case 4:if(!(d=e.v).success||!d.data){e.n=5;break}return u=d.data.widgetCustomization||d.data,m=d.data.apiEndpoints||{},p=d.data.isCargoEnabled||!1,h=d.data.isOrderEnabled||!1,g=u.customization_data,f={ai_personality:"friendly",theme_color:"#3B82F6",font_family:"Inter",primary_color:"#3B82F6",secondary_color:"#6B7280",language:"tr",rate_limit_per_minute:10,api_timeout_seconds:10,max_retry_attempts:2,enable_typing_indicator:!0,enable_sound_notifications:!1},v=g&&"object"===typeof g?c(c({},f),g):f,console.log("Convstateai ba\u015flat\u0131l\u0131yor"),K({ai_name:u.ai_name||n.DEFAULT_AI_NAME,welcome_message:u.welcome_message||n.DEFAULT_WELCOME_MESSAGE,ai_personality:v.ai_personality,theme_color:u.theme_color||v.theme_color,font_family:u.font_family||v.font_family,primary_color:u.primary_color||v.primary_color,secondary_color:u.secondary_color||v.secondary_color,language:u.language||v.language,rate_limit_per_minute:v.rate_limit_per_minute,api_timeout_seconds:v.api_timeout_seconds,max_retry_attempts:v.max_retry_attempts,enable_typing_indicator:void 0!==u.enable_typing_indicator?u.enable_typing_indicator:v.enable_typing_indicator,enable_sound_notifications:void 0!==u.enable_sound_notifications?u.enable_sound_notifications:v.enable_sound_notifications,cargo_not_found_message:u.cargo_not_found_message,feature_disabled_message:u.feature_disabled_message,error_message_template:u.error_message_template,order_not_found_message:u.order_not_found_message,logo_url:u.logo_url,custom_messages:u.custom_messages}),"undefined"!==typeof window&&(window.widgetConfig=c(c({},window.widgetConfig),{},{apiEndpoints:{cargoTracking:m.cargoTracking||null,orderTracking:m.orderTracking||null},isCargoEnabled:p,isOrderEnabled:h})),e.a(2);case 5:e.n=6;break;case 6:e.n=8;break;case 7:e.p=7,e.v;case 8:K({ai_name:n.DEFAULT_AI_NAME,welcome_message:"Merhaba ben ".concat(n.DEFAULT_AI_NAME,", sizin tercihlerinize g\xf6re \xfcr\xfcn \xf6nerileri sunuyorum. Size nas\u0131l yard\u0131mc\u0131 olabilirim?"),ai_personality:"friendly",theme_color:"#3B82F6",font_family:"Inter",primary_color:"#3B82F6",secondary_color:"#6B7280",language:"tr",rate_limit_per_minute:10,api_timeout_seconds:10,max_retry_attempts:2,enable_typing_indicator:!0,enable_sound_notifications:!1}),e.n=10;break;case 9:e.p=9,e.v,K({ai_name:"ConvState AI",welcome_message:"Merhaba ben ConvState AI, sizin tercihlerinize g\xf6re \xfcr\xfcn \xf6nerileri sunuyorum. Size nas\u0131l yard\u0131mc\u0131 olabilirim?",ai_personality:"friendly",theme_color:"#3B82F6",font_family:"Inter",primary_color:"#3B82F6",secondary_color:"#6B7280",language:"tr",rate_limit_per_minute:10,api_timeout_seconds:10,max_retry_attempts:2,enable_typing_indicator:!0,enable_sound_notifications:!1});case 10:return e.a(2)}},e,null,[[1,7],[0,9]])}));return function(){return e.apply(this,arguments)}}(),oe=(0,f.useCallback)(u(l().m(function e(){var n,r,s,i;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n=k("/api/notification-widget"),r=(null===a||void 0===a?void 0:a.projectId)||"1",e.n=1,fetch("".concat(n,"/check-availability?project_id=").concat(r),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 1:if(!(s=e.v).ok){e.n=3;break}return e.n=2,s.json();case 2:(i=e.v).success&&i.has_notification?(O(i.data),A(!0),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:"notification_shown",message:i.data.message_text}})):(O({message_text:"Sizin i\xe7in \xfcr\xfcn se\xe7ebilirim",ai_name:"ConvState AI",color_theme:"blue",display_duration:5e3,animation_type:"slide-in",show_close_button:!0,color_theme_css:{primary:"#3B82F6",secondary:"#1D4ED8",gradient:"linear-gradient(135deg, #3B82F6 0%, #1D4ED8 100%)"}}),A(!0)),e.n=3;break;case 3:e.n=5;break;case 4:e.p=4,e.v;case 5:return e.a(2)}},e,null,[[0,4]])})),[null===a||void 0===a?void 0:a.projectId,t]);(0,f.useEffect)(function(){ce(),ie(),oe()},[]);(0,f.useEffect)(function(){var e=G[G.length-1];if(e&&"user"===e.role){var n=e.content.toLowerCase();if(n.includes("kampanyalarda neler var"))return void(null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:"campaign_inquiry",message:n}}));["kampanya","kampanyalar","kampanyalarda","indirim","f\u0131rsat","bedava","\xfccretsiz","taksit","promosyon","teklif","\xf6zel","avantaj"].some(function(e){return n.includes(e)})&&(m(!0),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:"campaign_tab_opened",message:n}}))}},[G,t]);var le=function(){T&&(A(!1),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:"notification_closed_via_avatar"}})),E(!S),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:"chat_toggle",visible:!S}})},de=function(e){("campaign"!==e||R.campaigns)&&("faq"!==e||R.faqs)&&(_(!0),setTimeout(function(){m(!1),x(!1),"campaign"===e&&R.campaigns?m(!0):"faq"===e&&R.faqs&&x(!0),setTimeout(function(){_(!1)},400)},100))};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:"convstateai-widget chat-container ".concat(S?"":"hidden"," ").concat("center"===(null===a||void 0===a||null===(n=a.customization)||void 0===n?void 0:n.position)?"center":""),children:[(0,N.jsxs)("div",{className:"main-header",children:[(0,N.jsxs)("div",{className:"chat-header",children:[(0,N.jsxs)("div",{className:"header-left",children:[(0,N.jsx)("div",{className:"agent-avatar",children:(0,N.jsx)("img",{src:j().small,alt:"AI Conversion Agent"})}),(0,N.jsx)("span",{className:"agent-name",children:M.ai_name||"ConvState AI"})]}),(0,N.jsx)("div",{className:"header-right",children:(0,N.jsx)("button",{className:"icon-button ".concat(s?"sound-enabled":""),onClick:function(){i(!s),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:"sound_toggle",enabled:!s}})},title:s?"Sound On":"Sound Off",children:(0,N.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,N.jsx)("path",{d:"M12 5L8 9H4V15H8L12 19V5Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,N.jsx)("path",{d:"M15.54 8.46C16.4774 9.39764 17.0039 10.6692 17.0039 12C17.0039 13.3308 16.4774 14.6024 15.54 15.54",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})})]}),(R.campaigns||R.faqs)&&(0,N.jsx)("div",{className:"tabs-section",children:(0,N.jsxs)("div",{className:"tab-navigation",children:[(0,N.jsx)("button",{className:"tab-button ".concat(d||v?"":"active"),onClick:function(){return de("chat")},title:"Chat",children:"\ud83d\udcac Chat"}),R.campaigns&&(0,N.jsx)("button",{className:"tab-button ".concat(d?"active":""),onClick:function(){return de("campaign")},title:"Kampanyalar",children:"\ud83c\udfaf Kampanyalar"}),R.faqs&&(0,N.jsx)("button",{className:"tab-button ".concat(v?"active":""),onClick:function(){return de("faq")},title:"S\u0131k Sorulan Sorular",children:"\u2753 SSS"})]})})]}),(0,N.jsxs)("div",{className:"tab-content ".concat(b?"transitioning":""),children:[(0,N.jsx)("div",{className:"tab-panel ".concat(d?"":"active"),children:(0,N.jsxs)("div",{className:"aiagent-container",children:[(0,N.jsxs)("div",{className:"chat-content",children:[F.map(function(e){return(0,N.jsx)(ee,{message:e,onRetry:function(){L(function(n){return n.filter(function(n){return n.id!==e.id})})},onDismiss:function(){L(function(n){return n.filter(function(n){return n.id!==e.id})})}},e.id)}),(0,N.jsx)(V,{messages:G,onProductClick:function(e){ae(e),null===t||void 0===t||t({type:"product_clicked",timestamp:new Date,sessionId:"session_id",data:{product:e}})},onFeedback:function(e){te(e),null===t||void 0===t||t({type:"feedback_received",timestamp:new Date,sessionId:"session_id",data:{feedback:e}})},welcomeMessage:M.welcome_message,widgetCustomization:M,onAddMessage:re,onSendMessage:ne})]}),(0,N.jsx)(J,{onAction:function(e){ne(e),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:e}})}}),(0,N.jsx)(Y,{onSendMessage:function(e){ne(e),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{message:e}})}}),(0,N.jsx)(Z,{})]})}),R.campaigns&&(0,N.jsx)("div",{className:"tab-panel ".concat(d?"active":""),children:(0,N.jsx)(X,{isVisible:!0,onClose:function(){m(!1)}})}),R.faqs&&(0,N.jsx)("div",{className:"tab-panel ".concat(v?"active":""),children:(0,N.jsx)($,{isVisible:!0,onClose:function(){return de("chat")}})})]})]}),(0,N.jsx)("div",{className:"bottom-avatar",onClick:le,children:(0,N.jsx)("img",{src:j().large,alt:"AI Conversion Assistant"})}),(0,N.jsx)(Q,{isVisible:T,onClose:function(){A(!1),null===t||void 0===t||t({type:"message_sent",timestamp:new Date,sessionId:"session_id",data:{action:"notification_closed"}})},onOpenChat:le,settings:D})]})}}}]);
//# sourceMappingURL=564.fdc9ebf2.chunk.js.map